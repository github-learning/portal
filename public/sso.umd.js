/*! For license information please see sso.umd.js.LICENSE.txt */
!function webpackUniversalModuleDefinition(c,p){"object"===typeof exports&&"object"===typeof module?module.exports=p():"function"===typeof define&&define.amd?define([],p):"object"===typeof exports?exports.TjSSo1=p():c.TjSSo1=p()}(self,(()=>(()=>{var c={353:function(c){c.exports=function(){"use strict";var c=1e3,p=6e4,v=36e5,x="millisecond",E="second",F="minute",C="hour",P="day",R="week",B="month",T="quarter",N="year",_="date",L="Invalid Date",V=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,W={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(c){var p=["th","st","nd","rd"],v=c%100;return"["+c+(p[(v-20)%10]||p[v]||p[0])+"]"}},m=function(c,p,v){var x=String(c);return!x||x.length>=p?c:""+Array(p+1-x.length).join(v)+c},G={s:m,z:function(c){var p=-c.utcOffset(),v=Math.abs(p),x=Math.floor(v/60),E=v%60;return(p<=0?"+":"-")+m(x,2,"0")+":"+m(E,2,"0")},m:function t(c,p){if(c.date()<p.date())return-t(p,c);var v=12*(p.year()-c.year())+(p.month()-c.month()),x=c.clone().add(v,B),E=p-x<0,F=c.clone().add(v+(E?-1:1),B);return+(-(v+(p-x)/(E?x-F:F-x))||0)},a:function(c){return c<0?Math.ceil(c)||0:Math.floor(c)},p:function(c){return{M:B,y:N,w:R,d:P,D:_,h:C,m:F,s:E,ms:x,Q:T}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(c){return void 0===c}},X="en",J={};J[X]=W;var Z="$isDayjsObject",S=function(c){return c instanceof tt||!(!c||!c[Z])},Y=function t(c,p,v){var x;if(!c)return X;if("string"==typeof c){var E=c.toLowerCase();J[E]&&(x=E),p&&(J[E]=p,x=E);var F=c.split("-");if(!x&&F.length>1)return t(F[0])}else{var C=c.name;J[C]=c,x=C}return!v&&x&&(X=x),x||!v&&X},O=function(c,p){if(S(c))return c.clone();var v="object"==typeof p?p:{};return v.date=c,v.args=arguments,new tt(v)},Q=G;Q.l=Y,Q.i=S,Q.w=function(c,p){return O(c,{locale:p.$L,utc:p.$u,x:p.$x,$offset:p.$offset})};var tt=function(){function M(c){this.$L=Y(c.locale,null,!0),this.parse(c),this.$x=this.$x||c.x||{},this[Z]=!0}var W=M.prototype;return W.parse=function(c){this.$d=function(c){var p=c.date,v=c.utc;if(null===p)return new Date(NaN);if(Q.u(p))return new Date;if(p instanceof Date)return new Date(p);if("string"==typeof p&&!/Z$/i.test(p)){var x=p.match(V);if(x){var E=x[2]-1||0,F=(x[7]||"0").substring(0,3);return v?new Date(Date.UTC(x[1],E,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)):new Date(x[1],E,x[3]||1,x[4]||0,x[5]||0,x[6]||0,F)}}return new Date(p)}(c),this.init()},W.init=function(){var c=this.$d;this.$y=c.getFullYear(),this.$M=c.getMonth(),this.$D=c.getDate(),this.$W=c.getDay(),this.$H=c.getHours(),this.$m=c.getMinutes(),this.$s=c.getSeconds(),this.$ms=c.getMilliseconds()},W.$utils=function(){return Q},W.isValid=function(){return!(this.$d.toString()===L)},W.isSame=function(c,p){var v=O(c);return this.startOf(p)<=v&&v<=this.endOf(p)},W.isAfter=function(c,p){return O(c)<this.startOf(p)},W.isBefore=function(c,p){return this.endOf(p)<O(c)},W.$g=function(c,p,v){return Q.u(c)?this[p]:this.set(v,c)},W.unix=function(){return Math.floor(this.valueOf()/1e3)},W.valueOf=function(){return this.$d.getTime()},W.startOf=function(c,p){var v=this,x=!!Q.u(p)||p,T=Q.p(c),l=function(c,p){var E=Q.w(v.$u?Date.UTC(v.$y,p,c):new Date(v.$y,p,c),v);return x?E:E.endOf(P)},$=function(c,p){return Q.w(v.toDate()[c].apply(v.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice(p)),v)},L=this.$W,V=this.$M,U=this.$D,W="set"+(this.$u?"UTC":"");switch(T){case N:return x?l(1,0):l(31,11);case B:return x?l(1,V):l(0,V+1);case R:var G=this.$locale().weekStart||0,X=(L<G?L+7:L)-G;return l(x?U-X:U+(6-X),V);case P:case _:return $(W+"Hours",0);case C:return $(W+"Minutes",1);case F:return $(W+"Seconds",2);case E:return $(W+"Milliseconds",3);default:return this.clone()}},W.endOf=function(c){return this.startOf(c,!1)},W.$set=function(c,p){var v,R=Q.p(c),T="set"+(this.$u?"UTC":""),L=(v={},v[P]=T+"Date",v[_]=T+"Date",v[B]=T+"Month",v[N]=T+"FullYear",v[C]=T+"Hours",v[F]=T+"Minutes",v[E]=T+"Seconds",v[x]=T+"Milliseconds",v)[R],V=R===P?this.$D+(p-this.$W):p;if(R===B||R===N){var U=this.clone().set(_,1);U.$d[L](V),U.init(),this.$d=U.set(_,Math.min(this.$D,U.daysInMonth())).$d}else L&&this.$d[L](V);return this.init(),this},W.set=function(c,p){return this.clone().$set(c,p)},W.get=function(c){return this[Q.p(c)]()},W.add=function(x,T){var _,L=this;x=Number(x);var V=Q.p(T),y=function(c){var p=O(L);return Q.w(p.date(p.date()+Math.round(c*x)),L)};if(V===B)return this.set(B,this.$M+x);if(V===N)return this.set(N,this.$y+x);if(V===P)return y(1);if(V===R)return y(7);var U=(_={},_[F]=p,_[C]=v,_[E]=c,_)[V]||1,W=this.$d.getTime()+x*U;return Q.w(W,this)},W.subtract=function(c,p){return this.add(-1*c,p)},W.format=function(c){var p=this,v=this.$locale();if(!this.isValid())return v.invalidDate||L;var x=c||"YYYY-MM-DDTHH:mm:ssZ",E=Q.z(this),F=this.$H,C=this.$m,P=this.$M,R=v.weekdays,B=v.months,T=v.meridiem,h=function(c,v,E,F){return c&&(c[v]||c(p,x))||E[v].slice(0,F)},d=function(c){return Q.s(F%12||12,c,"0")},N=T||function(c,p,v){var x=c<12?"AM":"PM";return v?x.toLowerCase():x};return x.replace(U,(function(c,x){return x||function(c){switch(c){case"YY":return String(p.$y).slice(-2);case"YYYY":return Q.s(p.$y,4,"0");case"M":return P+1;case"MM":return Q.s(P+1,2,"0");case"MMM":return h(v.monthsShort,P,B,3);case"MMMM":return h(B,P);case"D":return p.$D;case"DD":return Q.s(p.$D,2,"0");case"d":return String(p.$W);case"dd":return h(v.weekdaysMin,p.$W,R,2);case"ddd":return h(v.weekdaysShort,p.$W,R,3);case"dddd":return R[p.$W];case"H":return String(F);case"HH":return Q.s(F,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return N(F,C,!0);case"A":return N(F,C,!1);case"m":return String(C);case"mm":return Q.s(C,2,"0");case"s":return String(p.$s);case"ss":return Q.s(p.$s,2,"0");case"SSS":return Q.s(p.$ms,3,"0");case"Z":return E}return null}(c)||E.replace(":","")}))},W.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},W.diff=function(x,_,L){var V,U=this,W=Q.p(_),G=O(x),X=(G.utcOffset()-this.utcOffset())*p,J=this-G,D=function(){return Q.m(U,G)};switch(W){case N:V=D()/12;break;case B:V=D();break;case T:V=D()/3;break;case R:V=(J-X)/6048e5;break;case P:V=(J-X)/864e5;break;case C:V=J/v;break;case F:V=J/p;break;case E:V=J/c;break;default:V=J}return L?V:Q.a(V)},W.daysInMonth=function(){return this.endOf(B).$D},W.$locale=function(){return J[this.$L]},W.locale=function(c,p){if(!c)return this.$L;var v=this.clone(),x=Y(c,p,!0);return x&&(v.$L=x),v},W.clone=function(){return Q.w(this.$d,this)},W.toDate=function(){return new Date(this.valueOf())},W.toJSON=function(){return this.isValid()?this.toISOString():null},W.toISOString=function(){return this.$d.toISOString()},W.toString=function(){return this.$d.toUTCString()},M}(),et=tt.prototype;return O.prototype=et,[["$ms",x],["$s",E],["$m",F],["$H",C],["$W",P],["$M",B],["$y",N],["$D",_]].forEach((function(c){et[c[1]]=function(p){return this.$g(p,c[0],c[1])}})),O.extend=function(c,p){return c.$i||(c(p,tt,O),c.$i=!0),O},O.locale=Y,O.isDayjs=S,O.unix=function(c){return O(1e3*c)},O.en=J[X],O.Ls=J,O.p={},O}()},355:(c,p)=>{var v={userAgent:!1},x={},E=E||function(c,p){var v={},x=v.lib={},E=x.Base=function(){function n(){}return{extend:function(c){n.prototype=this;var p=new n;return c&&p.mixIn(c),p.hasOwnProperty("init")||(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var c=this.extend();return c.init.apply(c,arguments),c},init:function(){},mixIn:function(c){for(var p in c)c.hasOwnProperty(p)&&(this[p]=c[p]);c.hasOwnProperty("toString")&&(this.toString=c.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),F=x.WordArray=E.extend({init:function(c,p){c=this.words=c||[],this.sigBytes=undefined!=p?p:4*c.length},toString:function(c){return(c||P).stringify(this)},concat:function(c){var p=this.words,v=c.words,x=this.sigBytes,E=c.sigBytes;if(this.clamp(),x%4)for(var F=0;F<E;F++){var C=v[F>>>2]>>>24-F%4*8&255;p[x+F>>>2]|=C<<24-(x+F)%4*8}else for(F=0;F<E;F+=4)p[x+F>>>2]=v[F>>>2];return this.sigBytes+=E,this},clamp:function(){var p=this.words,v=this.sigBytes;p[v>>>2]&=4294967295<<32-v%4*8,p.length=c.ceil(v/4)},clone:function(){var c=E.clone.call(this);return c.words=this.words.slice(0),c},random:function(p){for(var v=[],x=0;x<p;x+=4)v.push(4294967296*c.random()|0);return new F.init(v,p)}}),C=v.enc={},P=C.Hex={stringify:function(c){for(var p=c.words,v=c.sigBytes,x=[],E=0;E<v;E++){var F=p[E>>>2]>>>24-E%4*8&255;x.push((F>>>4).toString(16)),x.push((15&F).toString(16))}return x.join("")},parse:function(c){for(var p=c.length,v=[],x=0;x<p;x+=2)v[x>>>3]|=parseInt(c.substr(x,2),16)<<24-x%8*4;return new F.init(v,p/2)}},R=C.Latin1={stringify:function(c){for(var p=c.words,v=c.sigBytes,x=[],E=0;E<v;E++){var F=p[E>>>2]>>>24-E%4*8&255;x.push(String.fromCharCode(F))}return x.join("")},parse:function(c){for(var p=c.length,v=[],x=0;x<p;x++)v[x>>>2]|=(255&c.charCodeAt(x))<<24-x%4*8;return new F.init(v,p)}},B=C.Utf8={stringify:function(c){try{return decodeURIComponent(escape(R.stringify(c)))}catch(p){throw new Error("Malformed UTF-8 data")}},parse:function(c){return R.parse(unescape(encodeURIComponent(c)))}},T=x.BufferedBlockAlgorithm=E.extend({reset:function(){this._data=new F.init,this._nDataBytes=0},_append:function(c){"string"==typeof c&&(c=B.parse(c)),this._data.concat(c),this._nDataBytes+=c.sigBytes},_process:function(p){var v=this._data,x=v.words,E=v.sigBytes,C=this.blockSize,P=E/(4*C),R=(P=p?c.ceil(P):c.max((0|P)-this._minBufferSize,0))*C,B=c.min(4*R,E);if(R){for(var T=0;T<R;T+=C)this._doProcessBlock(x,T);var N=x.splice(0,R);v.sigBytes-=B}return new F.init(N,B)},clone:function(){var c=E.clone.call(this);return c._data=this._data.clone(),c},_minBufferSize:0}),N=(x.Hasher=T.extend({cfg:E.extend(),init:function(c){this.cfg=this.cfg.extend(c),this.reset()},reset:function(){T.reset.call(this),this._doReset()},update:function(c){return this._append(c),this._process(),this},finalize:function(c){return c&&this._append(c),this._doFinalize()},blockSize:16,_createHelper:function(c){return function(p,v){return new c.init(v).finalize(p)}},_createHmacHelper:function(c){return function(p,v){return new N.HMAC.init(c,v).finalize(p)}}}),v.algo={});return v}(Math);!function(c){var p,v=(p=E).lib,x=v.Base,F=v.WordArray;(p=p.x64={}).Word=x.extend({init:function(c,p){this.high=c,this.low=p}}),p.WordArray=x.extend({init:function(c,p){c=this.words=c||[],this.sigBytes=undefined!=p?p:8*c.length},toX32:function(){for(var c=this.words,p=c.length,v=[],x=0;x<p;x++){var E=c[x];v.push(E.high),v.push(E.low)}return F.create(v,this.sigBytes)},clone:function(){for(var c=x.clone.call(this),p=c.words=this.words.slice(0),v=p.length,E=0;E<v;E++)p[E]=p[E].clone();return c}})}(),E.lib.Cipher||function(c){var p=(L=E).lib,v=p.Base,x=p.WordArray,F=p.BufferedBlockAlgorithm,C=L.enc.Base64,P=L.algo.EvpKDF,R=p.Cipher=F.extend({cfg:v.extend(),createEncryptor:function(c,p){return this.create(this._ENC_XFORM_MODE,c,p)},createDecryptor:function(c,p){return this.create(this._DEC_XFORM_MODE,c,p)},init:function(c,p,v){this.cfg=this.cfg.extend(v),this._xformMode=c,this._key=p,this.reset()},reset:function(){F.reset.call(this),this._doReset()},process:function(c){return this._append(c),this._process()},finalize:function(c){return c&&this._append(c),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(c){return{encrypt:function(p,v,x){return("string"==typeof v?V:_).encrypt(c,p,v,x)},decrypt:function(p,v,x){return("string"==typeof v?V:_).decrypt(c,p,v,x)}}}});p.StreamCipher=R.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var B=L.mode={},t=function(c,p,v){var x=this._iv;x?this._iv=undefined:x=this._prevBlock;for(var E=0;E<v;E++)c[p+E]^=x[E]},T=(p.BlockCipherMode=v.extend({createEncryptor:function(c,p){return this.Encryptor.create(c,p)},createDecryptor:function(c,p){return this.Decryptor.create(c,p)},init:function(c,p){this._cipher=c,this._iv=p}})).extend();T.Encryptor=T.extend({processBlock:function(c,p){var v=this._cipher,x=v.blockSize;t.call(this,c,p,x),v.encryptBlock(c,p),this._prevBlock=c.slice(p,p+x)}}),T.Decryptor=T.extend({processBlock:function(c,p){var v=this._cipher,x=v.blockSize,E=c.slice(p,p+x);v.decryptBlock(c,p),t.call(this,c,p,x),this._prevBlock=E}}),B=B.CBC=T,T=(L.pad={}).Pkcs7={pad:function(c,p){for(var v,E=(v=(v=4*p)-c.sigBytes%v)<<24|v<<16|v<<8|v,F=[],C=0;C<v;C+=4)F.push(E);v=x.create(F,v),c.concat(v)},unpad:function(c){c.sigBytes-=255&c.words[c.sigBytes-1>>>2]}},p.BlockCipher=R.extend({cfg:R.cfg.extend({mode:B,padding:T}),reset:function(){R.reset.call(this);var c=(p=this.cfg).iv,p=p.mode;if(this._xformMode==this._ENC_XFORM_MODE)var v=p.createEncryptor;else v=p.createDecryptor,this._minBufferSize=1;this._mode=v.call(p,this,c&&c.words)},_doProcessBlock:function(c,p){this._mode.processBlock(c,p)},_doFinalize:function(){var c=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){c.pad(this._data,this.blockSize);var p=this._process(!0)}else p=this._process(!0),c.unpad(p);return p},blockSize:4});var N=p.CipherParams=v.extend({init:function(c){this.mixIn(c)},toString:function(c){return(c||this.formatter).stringify(this)}}),_=(B=(L.format={}).OpenSSL={stringify:function(c){var p=c.ciphertext;return((c=c.salt)?x.create([1398893684,1701076831]).concat(c).concat(p):p).toString(C)},parse:function(c){var p=(c=C.parse(c)).words;if(1398893684==p[0]&&1701076831==p[1]){var v=x.create(p.slice(2,4));p.splice(0,4),c.sigBytes-=16}return N.create({ciphertext:c,salt:v})}},p.SerializableCipher=v.extend({cfg:v.extend({format:B}),encrypt:function(c,p,v,x){x=this.cfg.extend(x);var E=c.createEncryptor(v,x);return p=E.finalize(p),E=E.cfg,N.create({ciphertext:p,key:v,iv:E.iv,algorithm:c,mode:E.mode,padding:E.padding,blockSize:c.blockSize,formatter:x.format})},decrypt:function(c,p,v,x){return x=this.cfg.extend(x),p=this._parse(p,x.format),c.createDecryptor(v,x).finalize(p.ciphertext)},_parse:function(c,p){return"string"==typeof c?p.parse(c,this):c}})),L=(L.kdf={}).OpenSSL={execute:function(c,p,v,E){return E||(E=x.random(8)),c=P.create({keySize:p+v}).compute(c,E),v=x.create(c.words.slice(p),4*v),c.sigBytes=4*p,N.create({key:c,iv:v,salt:E})}},V=p.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:L}),encrypt:function(c,p,v,x){return v=(x=this.cfg.extend(x)).kdf.execute(v,c.keySize,c.ivSize),x.iv=v.iv,(c=_.encrypt.call(this,c,p,v.key,x)).mixIn(v),c},decrypt:function(c,p,v,x){return x=this.cfg.extend(x),p=this._parse(p,x.format),v=x.kdf.execute(v,c.keySize,c.ivSize,p.salt),x.iv=v.iv,_.decrypt.call(this,c,p,v.key,x)}})}(),function(){for(var c=E,p=c.lib.BlockCipher,v=c.algo,x=[],F=[],C=[],P=[],R=[],B=[],T=[],N=[],_=[],L=[],V=[],U=0;256>U;U++)V[U]=128>U?U<<1:U<<1^283;var W=0,G=0;for(U=0;256>U;U++){var X=(X=G^G<<1^G<<2^G<<3^G<<4)>>>8^255&X^99;x[W]=X,F[X]=W;var J=V[W],Z=V[J],Y=V[Z],Q=257*V[X]^16843008*X;C[W]=Q<<24|Q>>>8,P[W]=Q<<16|Q>>>16,R[W]=Q<<8|Q>>>24,B[W]=Q,Q=16843009*Y^65537*Z^257*J^16843008*W,T[X]=Q<<24|Q>>>8,N[X]=Q<<16|Q>>>16,_[X]=Q<<8|Q>>>24,L[X]=Q,W?(W=J^V[V[V[Y^J]]],G^=V[V[G]]):W=G=1}var tt=[0,1,2,4,8,16,32,64,128,27,54];v=v.AES=p.extend({_doReset:function(){for(var c=(v=this._key).words,p=v.sigBytes/4,v=4*((this._nRounds=p+6)+1),E=this._keySchedule=[],F=0;F<v;F++)if(F<p)E[F]=c[F];else{var C=E[F-1];F%p?6<p&&4==F%p&&(C=x[C>>>24]<<24|x[C>>>16&255]<<16|x[C>>>8&255]<<8|x[255&C]):(C=x[(C=C<<8|C>>>24)>>>24]<<24|x[C>>>16&255]<<16|x[C>>>8&255]<<8|x[255&C],C^=tt[F/p|0]<<24),E[F]=E[F-p]^C}for(c=this._invKeySchedule=[],p=0;p<v;p++)F=v-p,C=p%4?E[F]:E[F-4],c[p]=4>p||4>=F?C:T[x[C>>>24]]^N[x[C>>>16&255]]^_[x[C>>>8&255]]^L[x[255&C]]},encryptBlock:function(c,p){this._doCryptBlock(c,p,this._keySchedule,C,P,R,B,x)},decryptBlock:function(c,p){var v=c[p+1];c[p+1]=c[p+3],c[p+3]=v,this._doCryptBlock(c,p,this._invKeySchedule,T,N,_,L,F),v=c[p+1],c[p+1]=c[p+3],c[p+3]=v},_doCryptBlock:function(c,p,v,x,E,F,C,P){for(var R=this._nRounds,B=c[p]^v[0],T=c[p+1]^v[1],N=c[p+2]^v[2],_=c[p+3]^v[3],L=4,V=1;V<R;V++){var U=x[B>>>24]^E[T>>>16&255]^F[N>>>8&255]^C[255&_]^v[L++],W=x[T>>>24]^E[N>>>16&255]^F[_>>>8&255]^C[255&B]^v[L++],G=x[N>>>24]^E[_>>>16&255]^F[B>>>8&255]^C[255&T]^v[L++];_=x[_>>>24]^E[B>>>16&255]^F[T>>>8&255]^C[255&N]^v[L++],B=U,T=W,N=G}U=(P[B>>>24]<<24|P[T>>>16&255]<<16|P[N>>>8&255]<<8|P[255&_])^v[L++],W=(P[T>>>24]<<24|P[N>>>16&255]<<16|P[_>>>8&255]<<8|P[255&B])^v[L++],G=(P[N>>>24]<<24|P[_>>>16&255]<<16|P[B>>>8&255]<<8|P[255&T])^v[L++],_=(P[_>>>24]<<24|P[B>>>16&255]<<16|P[T>>>8&255]<<8|P[255&N])^v[L++],c[p]=U,c[p+1]=W,c[p+2]=G,c[p+3]=_},keySize:8});c.AES=p._createHelper(v)}(),function(){function j(c,p){var v=(this._lBlock>>>c^this._rBlock)&p;this._rBlock^=v,this._lBlock^=v<<c}function l(c,p){var v=(this._rBlock>>>c^this._lBlock)&p;this._lBlock^=v,this._rBlock^=v<<c}var c=E,p=(v=c.lib).WordArray,v=v.BlockCipher,x=c.algo,F=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],C=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],P=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],R=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],B=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],T=x.DES=v.extend({_doReset:function(){for(var c=this._key.words,p=[],v=0;56>v;v++){var x=F[v]-1;p[v]=c[x>>>5]>>>31-x%32&1}for(c=this._subKeys=[],x=0;16>x;x++){var E=c[x]=[],R=P[x];for(v=0;24>v;v++)E[v/6|0]|=p[(C[v]-1+R)%28]<<31-v%6,E[4+(v/6|0)]|=p[28+(C[v+24]-1+R)%28]<<31-v%6;for(E[0]=E[0]<<1|E[0]>>>31,v=1;7>v;v++)E[v]>>>=4*(v-1)+3;E[7]=E[7]<<5|E[7]>>>27}for(p=this._invSubKeys=[],v=0;16>v;v++)p[v]=c[15-v]},encryptBlock:function(c,p){this._doCryptBlock(c,p,this._subKeys)},decryptBlock:function(c,p){this._doCryptBlock(c,p,this._invSubKeys)},_doCryptBlock:function(c,p,v){this._lBlock=c[p],this._rBlock=c[p+1],j.call(this,4,252645135),j.call(this,16,65535),l.call(this,2,858993459),l.call(this,8,16711935),j.call(this,1,1431655765);for(var x=0;16>x;x++){for(var E=v[x],F=this._lBlock,C=this._rBlock,P=0,T=0;8>T;T++)P|=R[T][((C^E[T])&B[T])>>>0];this._lBlock=C,this._rBlock=F^P}v=this._lBlock,this._lBlock=this._rBlock,this._rBlock=v,j.call(this,1,1431655765),l.call(this,8,16711935),l.call(this,2,858993459),j.call(this,16,65535),j.call(this,4,252645135),c[p]=this._lBlock,c[p+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});c.DES=v._createHelper(T),x=x.TripleDES=v.extend({_doReset:function(){var c=this._key.words;this._des1=T.createEncryptor(p.create(c.slice(0,2))),this._des2=T.createEncryptor(p.create(c.slice(2,4))),this._des3=T.createEncryptor(p.create(c.slice(4,6)))},encryptBlock:function(c,p){this._des1.encryptBlock(c,p),this._des2.decryptBlock(c,p),this._des3.encryptBlock(c,p)},decryptBlock:function(c,p){this._des3.decryptBlock(c,p),this._des2.encryptBlock(c,p),this._des1.decryptBlock(c,p)},keySize:6,ivSize:2,blockSize:2}),c.TripleDES=v._createHelper(x)}(),function(){var c=E,p=c.lib.WordArray;c.enc.Base64={stringify:function(c){var p=c.words,v=c.sigBytes,x=this._map;c.clamp(),c=[];for(var E=0;E<v;E+=3)for(var F=(p[E>>>2]>>>24-E%4*8&255)<<16|(p[E+1>>>2]>>>24-(E+1)%4*8&255)<<8|p[E+2>>>2]>>>24-(E+2)%4*8&255,C=0;4>C&&E+.75*C<v;C++)c.push(x.charAt(F>>>6*(3-C)&63));if(p=x.charAt(64))for(;c.length%4;)c.push(p);return c.join("")},parse:function(c){var v=c.length,x=this._map;(E=x.charAt(64))&&(-1!=(E=c.indexOf(E))&&(v=E));for(var E=[],F=0,C=0;C<v;C++)if(C%4){var P=x.indexOf(c.charAt(C-1))<<C%4*2,R=x.indexOf(c.charAt(C))>>>6-C%4*2;E[F>>>2]|=(P|R)<<24-F%4*8,F++}return p.create(E,F)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(c){function h(c,p,v,x,E,F,C){return((c=c+(p&v|~p&x)+E+C)<<F|c>>>32-F)+p}function k(c,p,v,x,E,F,C){return((c=c+(p&x|v&~x)+E+C)<<F|c>>>32-F)+p}function l(c,p,v,x,E,F,C){return((c=c+(p^v^x)+E+C)<<F|c>>>32-F)+p}function n(c,p,v,x,E,F,C){return((c=c+(v^(p|~x))+E+C)<<F|c>>>32-F)+p}for(var p=E,v=(F=p.lib).WordArray,x=F.Hasher,F=p.algo,C=[],P=0;64>P;P++)C[P]=4294967296*c.abs(c.sin(P+1))|0;F=F.MD5=x.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(c,p){for(var v=0;16>v;v++){var x=c[E=p+v];c[E]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8)}v=this._hash.words;var E=c[p+0],F=(x=c[p+1],c[p+2]),P=c[p+3],R=c[p+4],B=c[p+5],T=c[p+6],N=c[p+7],_=c[p+8],L=c[p+9],V=c[p+10],U=c[p+11],W=c[p+12],G=c[p+13],X=c[p+14],J=c[p+15],Z=h(Z=v[0],tt=v[1],Q=v[2],Y=v[3],E,7,C[0]),Y=h(Y,Z,tt,Q,x,12,C[1]),Q=h(Q,Y,Z,tt,F,17,C[2]),tt=h(tt,Q,Y,Z,P,22,C[3]);Z=h(Z,tt,Q,Y,R,7,C[4]),Y=h(Y,Z,tt,Q,B,12,C[5]),Q=h(Q,Y,Z,tt,T,17,C[6]),tt=h(tt,Q,Y,Z,N,22,C[7]),Z=h(Z,tt,Q,Y,_,7,C[8]),Y=h(Y,Z,tt,Q,L,12,C[9]),Q=h(Q,Y,Z,tt,V,17,C[10]),tt=h(tt,Q,Y,Z,U,22,C[11]),Z=h(Z,tt,Q,Y,W,7,C[12]),Y=h(Y,Z,tt,Q,G,12,C[13]),Q=h(Q,Y,Z,tt,X,17,C[14]),Z=k(Z,tt=h(tt,Q,Y,Z,J,22,C[15]),Q,Y,x,5,C[16]),Y=k(Y,Z,tt,Q,T,9,C[17]),Q=k(Q,Y,Z,tt,U,14,C[18]),tt=k(tt,Q,Y,Z,E,20,C[19]),Z=k(Z,tt,Q,Y,B,5,C[20]),Y=k(Y,Z,tt,Q,V,9,C[21]),Q=k(Q,Y,Z,tt,J,14,C[22]),tt=k(tt,Q,Y,Z,R,20,C[23]),Z=k(Z,tt,Q,Y,L,5,C[24]),Y=k(Y,Z,tt,Q,X,9,C[25]),Q=k(Q,Y,Z,tt,P,14,C[26]),tt=k(tt,Q,Y,Z,_,20,C[27]),Z=k(Z,tt,Q,Y,G,5,C[28]),Y=k(Y,Z,tt,Q,F,9,C[29]),Q=k(Q,Y,Z,tt,N,14,C[30]),Z=l(Z,tt=k(tt,Q,Y,Z,W,20,C[31]),Q,Y,B,4,C[32]),Y=l(Y,Z,tt,Q,_,11,C[33]),Q=l(Q,Y,Z,tt,U,16,C[34]),tt=l(tt,Q,Y,Z,X,23,C[35]),Z=l(Z,tt,Q,Y,x,4,C[36]),Y=l(Y,Z,tt,Q,R,11,C[37]),Q=l(Q,Y,Z,tt,N,16,C[38]),tt=l(tt,Q,Y,Z,V,23,C[39]),Z=l(Z,tt,Q,Y,G,4,C[40]),Y=l(Y,Z,tt,Q,E,11,C[41]),Q=l(Q,Y,Z,tt,P,16,C[42]),tt=l(tt,Q,Y,Z,T,23,C[43]),Z=l(Z,tt,Q,Y,L,4,C[44]),Y=l(Y,Z,tt,Q,W,11,C[45]),Q=l(Q,Y,Z,tt,J,16,C[46]),Z=n(Z,tt=l(tt,Q,Y,Z,F,23,C[47]),Q,Y,E,6,C[48]),Y=n(Y,Z,tt,Q,N,10,C[49]),Q=n(Q,Y,Z,tt,X,15,C[50]),tt=n(tt,Q,Y,Z,B,21,C[51]),Z=n(Z,tt,Q,Y,W,6,C[52]),Y=n(Y,Z,tt,Q,P,10,C[53]),Q=n(Q,Y,Z,tt,V,15,C[54]),tt=n(tt,Q,Y,Z,x,21,C[55]),Z=n(Z,tt,Q,Y,_,6,C[56]),Y=n(Y,Z,tt,Q,J,10,C[57]),Q=n(Q,Y,Z,tt,T,15,C[58]),tt=n(tt,Q,Y,Z,G,21,C[59]),Z=n(Z,tt,Q,Y,R,6,C[60]),Y=n(Y,Z,tt,Q,U,10,C[61]),Q=n(Q,Y,Z,tt,F,15,C[62]),tt=n(tt,Q,Y,Z,L,21,C[63]);v[0]=v[0]+Z|0,v[1]=v[1]+tt|0,v[2]=v[2]+Q|0,v[3]=v[3]+Y|0},_doFinalize:function(){var p=this._data,v=p.words,x=8*this._nDataBytes,E=8*p.sigBytes;v[E>>>5]|=128<<24-E%32;var F=c.floor(x/4294967296);for(v[15+(E+64>>>9<<4)]=16711935&(F<<8|F>>>24)|4278255360&(F<<24|F>>>8),v[14+(E+64>>>9<<4)]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8),p.sigBytes=4*(v.length+1),this._process(),v=(p=this._hash).words,x=0;4>x;x++)E=v[x],v[x]=16711935&(E<<8|E>>>24)|4278255360&(E<<24|E>>>8);return p},clone:function(){var c=x.clone.call(this);return c._hash=this._hash.clone(),c}}),p.MD5=x._createHelper(F),p.HmacMD5=x._createHmacHelper(F)}(Math),function(){var c=E,p=(F=c.lib).WordArray,v=F.Hasher,x=[],F=c.algo.SHA1=v.extend({_doReset:function(){this._hash=new p.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,p){for(var v=this._hash.words,E=v[0],F=v[1],C=v[2],P=v[3],R=v[4],B=0;80>B;B++){if(16>B)x[B]=0|c[p+B];else{var T=x[B-3]^x[B-8]^x[B-14]^x[B-16];x[B]=T<<1|T>>>31}T=(E<<5|E>>>27)+R+x[B],T=20>B?T+(1518500249+(F&C|~F&P)):40>B?T+(1859775393+(F^C^P)):60>B?T+((F&C|F&P|C&P)-1894007588):T+((F^C^P)-899497514),R=P,P=C,C=F<<30|F>>>2,F=E,E=T}v[0]=v[0]+E|0,v[1]=v[1]+F|0,v[2]=v[2]+C|0,v[3]=v[3]+P|0,v[4]=v[4]+R|0},_doFinalize:function(){var c=this._data,p=c.words,v=8*this._nDataBytes,x=8*c.sigBytes;return p[x>>>5]|=128<<24-x%32,p[14+(x+64>>>9<<4)]=Math.floor(v/4294967296),p[15+(x+64>>>9<<4)]=v,c.sigBytes=4*p.length,this._process(),this._hash},clone:function(){var c=v.clone.call(this);return c._hash=this._hash.clone(),c}});c.SHA1=v._createHelper(F),c.HmacSHA1=v._createHmacHelper(F)}(),function(c){for(var p=E,v=(F=p.lib).WordArray,x=F.Hasher,F=p.algo,C=[],P=[],u=function(c){return 4294967296*(c-(0|c))|0},R=2,B=0;64>B;){var T;t:{T=R;for(var N=c.sqrt(T),_=2;_<=N;_++)if(!(T%_)){T=!1;break t}T=!0}T&&(8>B&&(C[B]=u(c.pow(R,.5))),P[B]=u(c.pow(R,1/3)),B++),R++}var L=[];F=F.SHA256=x.extend({_doReset:function(){this._hash=new v.init(C.slice(0))},_doProcessBlock:function(c,p){for(var v=this._hash.words,x=v[0],E=v[1],F=v[2],C=v[3],R=v[4],B=v[5],T=v[6],N=v[7],_=0;64>_;_++){if(16>_)L[_]=0|c[p+_];else{var V=L[_-15],U=L[_-2];L[_]=((V<<25|V>>>7)^(V<<14|V>>>18)^V>>>3)+L[_-7]+((U<<15|U>>>17)^(U<<13|U>>>19)^U>>>10)+L[_-16]}V=N+((R<<26|R>>>6)^(R<<21|R>>>11)^(R<<7|R>>>25))+(R&B^~R&T)+P[_]+L[_],U=((x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22))+(x&E^x&F^E&F),N=T,T=B,B=R,R=C+V|0,C=F,F=E,E=x,x=V+U|0}v[0]=v[0]+x|0,v[1]=v[1]+E|0,v[2]=v[2]+F|0,v[3]=v[3]+C|0,v[4]=v[4]+R|0,v[5]=v[5]+B|0,v[6]=v[6]+T|0,v[7]=v[7]+N|0},_doFinalize:function(){var p=this._data,v=p.words,x=8*this._nDataBytes,E=8*p.sigBytes;return v[E>>>5]|=128<<24-E%32,v[14+(E+64>>>9<<4)]=c.floor(x/4294967296),v[15+(E+64>>>9<<4)]=x,p.sigBytes=4*v.length,this._process(),this._hash},clone:function(){var c=x.clone.call(this);return c._hash=this._hash.clone(),c}});p.SHA256=x._createHelper(F),p.HmacSHA256=x._createHmacHelper(F)}(Math),function(){var c=E,p=c.lib.WordArray,v=(x=c.algo).SHA256,x=x.SHA224=v.extend({_doReset:function(){this._hash=new p.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=v._doFinalize.call(this);return c.sigBytes-=4,c}});c.SHA224=v._createHelper(x),c.HmacSHA224=v._createHmacHelper(x)}(),function(){function a(){return v.create.apply(v,arguments)}for(var c=E,p=c.lib.Hasher,v=(F=c.x64).Word,x=F.WordArray,F=c.algo,C=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],P=[],R=0;80>R;R++)P[R]=a();F=F.SHA512=p.extend({_doReset:function(){this._hash=new x.init([new v.init(1779033703,4089235720),new v.init(3144134277,2227873595),new v.init(1013904242,4271175723),new v.init(2773480762,1595750129),new v.init(1359893119,2917565137),new v.init(2600822924,725511199),new v.init(528734635,4215389547),new v.init(1541459225,327033209)])},_doProcessBlock:function(c,p){for(var v=(N=this._hash.words)[0],x=N[1],E=N[2],F=N[3],R=N[4],B=N[5],T=N[6],N=N[7],_=v.high,L=v.low,V=x.high,U=x.low,W=E.high,G=E.low,X=F.high,J=F.low,Z=R.high,Y=R.low,Q=B.high,tt=B.low,et=T.high,rt=T.low,nt=N.high,it=N.low,st=_,at=L,ot=V,ct=U,ht=W,ut=G,lt=X,ft=J,dt=Z,pt=Y,gt=Q,mt=tt,vt=et,yt=rt,xt=nt,St=it,bt=0;80>bt;bt++){var wt=P[bt];if(16>bt)var Et=wt.high=0|c[p+2*bt],Ft=wt.low=0|c[p+2*bt+1];else{Et=((Ft=(Et=P[bt-15]).high)>>>1|(At=Et.low)<<31)^(Ft>>>8|At<<24)^Ft>>>7;var At=(At>>>1|Ft<<31)^(At>>>8|Ft<<24)^(At>>>7|Ft<<25),Ct=((Ft=(Ct=P[bt-2]).high)>>>19|(It=Ct.low)<<13)^(Ft<<3|It>>>29)^Ft>>>6,It=(It>>>19|Ft<<13)^(It<<3|Ft>>>29)^(It>>>6|Ft<<26),Pt=(Ft=P[bt-7]).high,Rt=(Dt=P[bt-16]).high,Dt=Dt.low;Et=(Et=(Et=Et+Pt+((Ft=At+Ft.low)>>>0<At>>>0?1:0))+Ct+((Ft=Ft+It)>>>0<It>>>0?1:0))+Rt+((Ft=Ft+Dt)>>>0<Dt>>>0?1:0);wt.high=Et,wt.low=Ft}Pt=dt&gt^~dt&vt,Dt=pt&mt^~pt&yt,wt=st&ot^st&ht^ot&ht;var Bt=at&ct^at&ut^ct&ut,Tt=(At=(st>>>28|at<<4)^(st<<30|at>>>2)^(st<<25|at>>>7),Ct=(at>>>28|st<<4)^(at<<30|st>>>2)^(at<<25|st>>>7),(It=C[bt]).high),Nt=It.low;Rt=xt+((dt>>>14|pt<<18)^(dt>>>18|pt<<14)^(dt<<23|pt>>>9))+((It=St+((pt>>>14|dt<<18)^(pt>>>18|dt<<14)^(pt<<23|dt>>>9)))>>>0<St>>>0?1:0),xt=vt,St=yt,vt=gt,yt=mt,gt=dt,mt=pt,dt=lt+(Rt=(Rt=(Rt=Rt+Pt+((It=It+Dt)>>>0<Dt>>>0?1:0))+Tt+((It=It+Nt)>>>0<Nt>>>0?1:0))+Et+((It=It+Ft)>>>0<Ft>>>0?1:0))+((pt=ft+It|0)>>>0<ft>>>0?1:0)|0,lt=ht,ft=ut,ht=ot,ut=ct,ot=st,ct=at,st=Rt+(wt=At+wt+((Ft=Ct+Bt)>>>0<Ct>>>0?1:0))+((at=It+Ft|0)>>>0<It>>>0?1:0)|0}L=v.low=L+at,v.high=_+st+(L>>>0<at>>>0?1:0),U=x.low=U+ct,x.high=V+ot+(U>>>0<ct>>>0?1:0),G=E.low=G+ut,E.high=W+ht+(G>>>0<ut>>>0?1:0),J=F.low=J+ft,F.high=X+lt+(J>>>0<ft>>>0?1:0),Y=R.low=Y+pt,R.high=Z+dt+(Y>>>0<pt>>>0?1:0),tt=B.low=tt+mt,B.high=Q+gt+(tt>>>0<mt>>>0?1:0),rt=T.low=rt+yt,T.high=et+vt+(rt>>>0<yt>>>0?1:0),it=N.low=it+St,N.high=nt+xt+(it>>>0<St>>>0?1:0)},_doFinalize:function(){var c=this._data,p=c.words,v=8*this._nDataBytes,x=8*c.sigBytes;return p[x>>>5]|=128<<24-x%32,p[30+(x+128>>>10<<5)]=Math.floor(v/4294967296),p[31+(x+128>>>10<<5)]=v,c.sigBytes=4*p.length,this._process(),this._hash.toX32()},clone:function(){var c=p.clone.call(this);return c._hash=this._hash.clone(),c},blockSize:32}),c.SHA512=p._createHelper(F),c.HmacSHA512=p._createHmacHelper(F)}(),function(){var c=E,p=(F=c.x64).Word,v=F.WordArray,x=(F=c.algo).SHA512,F=F.SHA384=x.extend({_doReset:function(){this._hash=new v.init([new p.init(3418070365,3238371032),new p.init(1654270250,914150663),new p.init(2438529370,812702999),new p.init(355462360,4144912697),new p.init(1731405415,4290775857),new p.init(2394180231,1750603025),new p.init(3675008525,1694076839),new p.init(1203062813,3204075428)])},_doFinalize:function(){var c=x._doFinalize.call(this);return c.sigBytes-=16,c}});c.SHA384=x._createHelper(F),c.HmacSHA384=x._createHmacHelper(F)}(),function(){var c=E,p=(x=c.lib).WordArray,v=x.Hasher,x=c.algo,F=p.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),C=p.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),P=p.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=p.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),B=p.create([0,1518500249,1859775393,2400959708,2840853838]),T=p.create([1352829926,1548603684,1836072691,2053994217,0]);x=x.RIPEMD160=v.extend({_doReset:function(){this._hash=p.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,p){for(var v=0;16>v;v++){var x=c[Z=p+v];c[Z]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8)}var E,N,_,L,V,U,W,G,X,J,Z=this._hash.words,Y=(x=B.words,T.words),Q=F.words,tt=C.words,et=P.words,rt=R.words;U=E=Z[0],W=N=Z[1],G=_=Z[2],X=L=Z[3],J=V=Z[4];var nt;for(v=0;80>v;v+=1)nt=E+c[p+Q[v]]|0,nt=16>v?nt+((N^_^L)+x[0]):32>v?nt+((N&_|~N&L)+x[1]):48>v?nt+(((N|~_)^L)+x[2]):64>v?nt+((N&L|_&~L)+x[3]):nt+((N^(_|~L))+x[4]),nt=(nt=(nt|=0)<<et[v]|nt>>>32-et[v])+V|0,E=V,V=L,L=_<<10|_>>>22,_=N,N=nt,nt=U+c[p+tt[v]]|0,nt=16>v?nt+((W^(G|~X))+Y[0]):32>v?nt+((W&X|G&~X)+Y[1]):48>v?nt+(((W|~G)^X)+Y[2]):64>v?nt+((W&G|~W&X)+Y[3]):nt+((W^G^X)+Y[4]),nt=(nt=(nt|=0)<<rt[v]|nt>>>32-rt[v])+J|0,U=J,J=X,X=G<<10|G>>>22,G=W,W=nt;nt=Z[1]+_+X|0,Z[1]=Z[2]+L+J|0,Z[2]=Z[3]+V+U|0,Z[3]=Z[4]+E+W|0,Z[4]=Z[0]+N+G|0,Z[0]=nt},_doFinalize:function(){var c=this._data,p=c.words,v=8*this._nDataBytes,x=8*c.sigBytes;for(p[x>>>5]|=128<<24-x%32,p[14+(x+64>>>9<<4)]=16711935&(v<<8|v>>>24)|4278255360&(v<<24|v>>>8),c.sigBytes=4*(p.length+1),this._process(),p=(c=this._hash).words,v=0;5>v;v++)x=p[v],p[v]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8);return c},clone:function(){var c=v.clone.call(this);return c._hash=this._hash.clone(),c}});c.RIPEMD160=v._createHelper(x),c.HmacRIPEMD160=v._createHmacHelper(x)}(Math),function(){var c=E,p=c.enc.Utf8;c.algo.HMAC=c.lib.Base.extend({init:function(c,v){c=this._hasher=new c.init,"string"==typeof v&&(v=p.parse(v));var x=c.blockSize,E=4*x;v.sigBytes>E&&(v=c.finalize(v)),v.clamp();for(var F=this._oKey=v.clone(),C=this._iKey=v.clone(),P=F.words,R=C.words,B=0;B<x;B++)P[B]^=1549556828,R[B]^=909522486;F.sigBytes=C.sigBytes=E,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var p=this._hasher;return c=p.finalize(c),p.reset(),p.finalize(this._oKey.clone().concat(c))}})}(),function(){var c,p=E,v=(c=p.lib).Base,x=c.WordArray,F=(c=p.algo).HMAC,C=c.PBKDF2=v.extend({cfg:v.extend({keySize:4,hasher:c.SHA1,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,p){var v=this.cfg,E=F.create(v.hasher,c),C=x.create(),P=x.create([1]),R=C.words,B=P.words,T=v.keySize;for(v=v.iterations;R.length<T;){var N=E.update(p).finalize(P);E.reset();for(var _=N.words,L=_.length,V=N,U=1;U<v;U++){V=E.finalize(V),E.reset();for(var W=V.words,G=0;G<L;G++)_[G]^=W[G]}C.concat(N),B[0]++}return C.sigBytes=4*T,C}});p.PBKDF2=function(c,p,v){return C.create(v).compute(c,p)}}();var F,C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P="=";function hex2b64(c){var p,v,x="";for(p=0;p+3<=c.length;p+=3)v=parseInt(c.substring(p,p+3),16),x+=C.charAt(v>>6)+C.charAt(63&v);if(p+1==c.length?(v=parseInt(c.substring(p,p+1),16),x+=C.charAt(v<<2)):p+2==c.length&&(v=parseInt(c.substring(p,p+2),16),x+=C.charAt(v>>2)+C.charAt((3&v)<<4)),P)for(;(3&x.length)>0;)x+=P;return x}function b64tohex(c){var p,v,x,E="",F=0;for(p=0;p<c.length&&c.charAt(p)!=P;++p)(x=C.indexOf(c.charAt(p)))<0||(0==F?(E+=int2char(x>>2),v=3&x,F=1):1==F?(E+=int2char(v<<2|x>>4),v=15&x,F=2):2==F?(E+=int2char(v),E+=int2char(x>>2),v=3&x,F=3):(E+=int2char(v<<2|x>>4),E+=int2char(15&x),F=0));return 1==F&&(E+=int2char(v<<2)),E}function b64toBA(c){var p,v=b64tohex(c),x=new Array;for(0;2*p<v.length;++p)x[p]=parseInt(v.substring(2*p,2*p+2),16);return x}function BigInteger(c,p,v){null!=c&&("number"==typeof c?this.fromNumber(c,p,v):null==p&&"string"!=typeof c?this.fromString(c,256):this.fromString(c,p))}function nbi(){return new BigInteger(null)}"Microsoft Internet Explorer"==v.appName?(BigInteger.prototype.am=function am2(c,p,v,x,E,F){for(var C=32767&p,P=p>>15;--F>=0;){var R=32767&this[c],B=this[c++]>>15,T=P*R+B*C;E=((R=C*R+((32767&T)<<15)+v[x]+(1073741823&E))>>>30)+(T>>>15)+P*B+(E>>>30),v[x++]=1073741823&R}return E},F=30):"Netscape"!=v.appName?(BigInteger.prototype.am=function am1(c,p,v,x,E,F){for(;--F>=0;){var C=p*this[c++]+v[x]+E;E=Math.floor(C/67108864),v[x++]=67108863&C}return E},F=26):(BigInteger.prototype.am=function am3(c,p,v,x,E,F){for(var C=16383&p,P=p>>14;--F>=0;){var R=16383&this[c],B=this[c++]>>14,T=P*R+B*C;E=((R=C*R+((16383&T)<<14)+v[x]+E)>>28)+(T>>14)+P*B,v[x++]=268435455&R}return E},F=28),BigInteger.prototype.DB=F,BigInteger.prototype.DM=(1<<F)-1,BigInteger.prototype.DV=1<<F;BigInteger.prototype.FV=Math.pow(2,52),BigInteger.prototype.F1=52-F,BigInteger.prototype.F2=2*F-52;var R,B,T="0123456789abcdefghijklmnopqrstuvwxyz",N=new Array;for(R="0".charCodeAt(0),B=0;B<=9;++B)N[R++]=B;for(R="a".charCodeAt(0),B=10;B<36;++B)N[R++]=B;for(R="A".charCodeAt(0),B=10;B<36;++B)N[R++]=B;function int2char(c){return T.charAt(c)}function intAt(c,p){var v=N[c.charCodeAt(p)];return null==v?-1:v}function nbv(c){var p=nbi();return p.fromInt(c),p}function nbits(c){var p,v=1;return 0!=(p=c>>>16)&&(c=p,v+=16),0!=(p=c>>8)&&(c=p,v+=8),0!=(p=c>>4)&&(c=p,v+=4),0!=(p=c>>2)&&(c=p,v+=2),0!=(p=c>>1)&&(c=p,v+=1),v}function Classic(c){this.m=c}function Montgomery(c){this.m=c,this.mp=c.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<c.DB-15)-1,this.mt2=2*c.t}function op_and(c,p){return c&p}function op_or(c,p){return c|p}function op_xor(c,p){return c^p}function op_andnot(c,p){return c&~p}function lbit(c){if(0==c)return-1;var p=0;return 0==(65535&c)&&(c>>=16,p+=16),0==(255&c)&&(c>>=8,p+=8),0==(15&c)&&(c>>=4,p+=4),0==(3&c)&&(c>>=2,p+=2),0==(1&c)&&++p,p}function cbit(c){for(var p=0;0!=c;)c&=c-1,++p;return p}function NullExp(){}function nNop(c){return c}function Barrett(c){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*c.t,this.r2),this.mu=this.r2.divide(c),this.m=c}Classic.prototype.convert=function cConvert(c){return c.s<0||c.compareTo(this.m)>=0?c.mod(this.m):c},Classic.prototype.revert=function cRevert(c){return c},Classic.prototype.reduce=function cReduce(c){c.divRemTo(this.m,null,c)},Classic.prototype.mulTo=function cMulTo(c,p,v){c.multiplyTo(p,v),this.reduce(v)},Classic.prototype.sqrTo=function cSqrTo(c,p){c.squareTo(p),this.reduce(p)},Montgomery.prototype.convert=function montConvert(c){var p=nbi();return c.abs().dlShiftTo(this.m.t,p),p.divRemTo(this.m,null,p),c.s<0&&p.compareTo(BigInteger.ZERO)>0&&this.m.subTo(p,p),p},Montgomery.prototype.revert=function montRevert(c){var p=nbi();return c.copyTo(p),this.reduce(p),p},Montgomery.prototype.reduce=function montReduce(c){for(;c.t<=this.mt2;)c[c.t++]=0;for(var p=0;p<this.m.t;++p){var v=32767&c[p],x=v*this.mpl+((v*this.mph+(c[p]>>15)*this.mpl&this.um)<<15)&c.DM;for(c[v=p+this.m.t]+=this.m.am(0,x,c,p,0,this.m.t);c[v]>=c.DV;)c[v]-=c.DV,c[++v]++}c.clamp(),c.drShiftTo(this.m.t,c),c.compareTo(this.m)>=0&&c.subTo(this.m,c)},Montgomery.prototype.mulTo=function montMulTo(c,p,v){c.multiplyTo(p,v),this.reduce(v)},Montgomery.prototype.sqrTo=function montSqrTo(c,p){c.squareTo(p),this.reduce(p)},BigInteger.prototype.copyTo=function bnpCopyTo(c){for(var p=this.t-1;p>=0;--p)c[p]=this[p];c.t=this.t,c.s=this.s},BigInteger.prototype.fromInt=function bnpFromInt(c){this.t=1,this.s=c<0?-1:0,c>0?this[0]=c:c<-1?this[0]=c+this.DV:this.t=0},BigInteger.prototype.fromString=function bnpFromString(c,p){var v;if(16==p)v=4;else if(8==p)v=3;else if(256==p)v=8;else if(2==p)v=1;else if(32==p)v=5;else{if(4!=p)return void this.fromRadix(c,p);v=2}this.t=0,this.s=0;for(var x=c.length,E=!1,F=0;--x>=0;){var C=8==v?255&c[x]:intAt(c,x);C<0?"-"==c.charAt(x)&&(E=!0):(E=!1,0==F?this[this.t++]=C:F+v>this.DB?(this[this.t-1]|=(C&(1<<this.DB-F)-1)<<F,this[this.t++]=C>>this.DB-F):this[this.t-1]|=C<<F,(F+=v)>=this.DB&&(F-=this.DB))}8==v&&0!=(128&c[0])&&(this.s=-1,F>0&&(this[this.t-1]|=(1<<this.DB-F)-1<<F)),this.clamp(),E&&BigInteger.ZERO.subTo(this,this)},BigInteger.prototype.clamp=function bnpClamp(){for(var c=this.s&this.DM;this.t>0&&this[this.t-1]==c;)--this.t},BigInteger.prototype.dlShiftTo=function bnpDLShiftTo(c,p){var v;for(v=this.t-1;v>=0;--v)p[v+c]=this[v];for(v=c-1;v>=0;--v)p[v]=0;p.t=this.t+c,p.s=this.s},BigInteger.prototype.drShiftTo=function bnpDRShiftTo(c,p){for(var v=c;v<this.t;++v)p[v-c]=this[v];p.t=Math.max(this.t-c,0),p.s=this.s},BigInteger.prototype.lShiftTo=function bnpLShiftTo(c,p){var v,x=c%this.DB,E=this.DB-x,F=(1<<E)-1,C=Math.floor(c/this.DB),P=this.s<<x&this.DM;for(v=this.t-1;v>=0;--v)p[v+C+1]=this[v]>>E|P,P=(this[v]&F)<<x;for(v=C-1;v>=0;--v)p[v]=0;p[C]=P,p.t=this.t+C+1,p.s=this.s,p.clamp()},BigInteger.prototype.rShiftTo=function bnpRShiftTo(c,p){p.s=this.s;var v=Math.floor(c/this.DB);if(v>=this.t)p.t=0;else{var x=c%this.DB,E=this.DB-x,F=(1<<x)-1;p[0]=this[v]>>x;for(var C=v+1;C<this.t;++C)p[C-v-1]|=(this[C]&F)<<E,p[C-v]=this[C]>>x;x>0&&(p[this.t-v-1]|=(this.s&F)<<E),p.t=this.t-v,p.clamp()}},BigInteger.prototype.subTo=function bnpSubTo(c,p){for(var v=0,x=0,E=Math.min(c.t,this.t);v<E;)x+=this[v]-c[v],p[v++]=x&this.DM,x>>=this.DB;if(c.t<this.t){for(x-=c.s;v<this.t;)x+=this[v],p[v++]=x&this.DM,x>>=this.DB;x+=this.s}else{for(x+=this.s;v<c.t;)x-=c[v],p[v++]=x&this.DM,x>>=this.DB;x-=c.s}p.s=x<0?-1:0,x<-1?p[v++]=this.DV+x:x>0&&(p[v++]=x),p.t=v,p.clamp()},BigInteger.prototype.multiplyTo=function bnpMultiplyTo(c,p){var v=this.abs(),x=c.abs(),E=v.t;for(p.t=E+x.t;--E>=0;)p[E]=0;for(E=0;E<x.t;++E)p[E+v.t]=v.am(0,x[E],p,E,0,v.t);p.s=0,p.clamp(),this.s!=c.s&&BigInteger.ZERO.subTo(p,p)},BigInteger.prototype.squareTo=function bnpSquareTo(c){for(var p=this.abs(),v=c.t=2*p.t;--v>=0;)c[v]=0;for(v=0;v<p.t-1;++v){var x=p.am(v,p[v],c,2*v,0,1);(c[v+p.t]+=p.am(v+1,2*p[v],c,2*v+1,x,p.t-v-1))>=p.DV&&(c[v+p.t]-=p.DV,c[v+p.t+1]=1)}c.t>0&&(c[c.t-1]+=p.am(v,p[v],c,2*v,0,1)),c.s=0,c.clamp()},BigInteger.prototype.divRemTo=function bnpDivRemTo(c,p,v){var x=c.abs();if(!(x.t<=0)){var E=this.abs();if(E.t<x.t)return null!=p&&p.fromInt(0),void(null!=v&&this.copyTo(v));null==v&&(v=nbi());var F=nbi(),C=this.s,P=c.s,R=this.DB-nbits(x[x.t-1]);R>0?(x.lShiftTo(R,F),E.lShiftTo(R,v)):(x.copyTo(F),E.copyTo(v));var B=F.t,T=F[B-1];if(0!=T){var N=T*(1<<this.F1)+(B>1?F[B-2]>>this.F2:0),_=this.FV/N,L=(1<<this.F1)/N,V=1<<this.F2,U=v.t,W=U-B,G=null==p?nbi():p;for(F.dlShiftTo(W,G),v.compareTo(G)>=0&&(v[v.t++]=1,v.subTo(G,v)),BigInteger.ONE.dlShiftTo(B,G),G.subTo(F,F);F.t<B;)F[F.t++]=0;for(;--W>=0;){var X=v[--U]==T?this.DM:Math.floor(v[U]*_+(v[U-1]+V)*L);if((v[U]+=F.am(0,X,v,W,0,B))<X)for(F.dlShiftTo(W,G),v.subTo(G,v);v[U]<--X;)v.subTo(G,v)}null!=p&&(v.drShiftTo(B,p),C!=P&&BigInteger.ZERO.subTo(p,p)),v.t=B,v.clamp(),R>0&&v.rShiftTo(R,v),C<0&&BigInteger.ZERO.subTo(v,v)}}},BigInteger.prototype.invDigit=function bnpInvDigit(){if(this.t<1)return 0;var c=this[0];if(0==(1&c))return 0;var p=3&c;return(p=(p=(p=(p=p*(2-(15&c)*p)&15)*(2-(255&c)*p)&255)*(2-((65535&c)*p&65535))&65535)*(2-c*p%this.DV)%this.DV)>0?this.DV-p:-p},BigInteger.prototype.isEven=function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)},BigInteger.prototype.exp=function bnpExp(c,p){if(c>4294967295||c<1)return BigInteger.ONE;var v=nbi(),x=nbi(),E=p.convert(this),F=nbits(c)-1;for(E.copyTo(v);--F>=0;)if(p.sqrTo(v,x),(c&1<<F)>0)p.mulTo(x,E,v);else{var C=v;v=x,x=C}return p.revert(v)},BigInteger.prototype.toString=function bnToString(c){if(this.s<0)return"-"+this.negate().toString(c);var p;if(16==c)p=4;else if(8==c)p=3;else if(2==c)p=1;else if(32==c)p=5;else{if(4!=c)return this.toRadix(c);p=2}var v,x=(1<<p)-1,E=!1,F="",C=this.t,P=this.DB-C*this.DB%p;if(C-- >0)for(P<this.DB&&(v=this[C]>>P)>0&&(E=!0,F=int2char(v));C>=0;)P<p?(v=(this[C]&(1<<P)-1)<<p-P,v|=this[--C]>>(P+=this.DB-p)):(v=this[C]>>(P-=p)&x,P<=0&&(P+=this.DB,--C)),v>0&&(E=!0),E&&(F+=int2char(v));return E?F:"0"},BigInteger.prototype.negate=function bnNegate(){var c=nbi();return BigInteger.ZERO.subTo(this,c),c},BigInteger.prototype.abs=function bnAbs(){return this.s<0?this.negate():this},BigInteger.prototype.compareTo=function bnCompareTo(c){var p=this.s-c.s;if(0!=p)return p;var v=this.t;if(0!=(p=v-c.t))return this.s<0?-p:p;for(;--v>=0;)if(0!=(p=this[v]-c[v]))return p;return 0},BigInteger.prototype.bitLength=function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)},BigInteger.prototype.mod=function bnMod(c){var p=nbi();return this.abs().divRemTo(c,null,p),this.s<0&&p.compareTo(BigInteger.ZERO)>0&&c.subTo(p,p),p},BigInteger.prototype.modPowInt=function bnModPowInt(c,p){var v;return v=c<256||p.isEven()?new Classic(p):new Montgomery(p),this.exp(c,v)},BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=function nMulTo(c,p,v){c.multiplyTo(p,v)},NullExp.prototype.sqrTo=function nSqrTo(c,p){c.squareTo(p)},Barrett.prototype.convert=function barrettConvert(c){if(c.s<0||c.t>2*this.m.t)return c.mod(this.m);if(c.compareTo(this.m)<0)return c;var p=nbi();return c.copyTo(p),this.reduce(p),p},Barrett.prototype.revert=function barrettRevert(c){return c},Barrett.prototype.reduce=function barrettReduce(c){for(c.drShiftTo(this.m.t-1,this.r2),c.t>this.m.t+1&&(c.t=this.m.t+1,c.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);c.compareTo(this.r2)<0;)c.dAddOffset(1,this.m.t+1);for(c.subTo(this.r2,c);c.compareTo(this.m)>=0;)c.subTo(this.m,c)},Barrett.prototype.mulTo=function barrettMulTo(c,p,v){c.multiplyTo(p,v),this.reduce(v)},Barrett.prototype.sqrTo=function barrettSqrTo(c,p){c.squareTo(p),this.reduce(p)};var _=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],L=(1<<26)/_[_.length-1];function Arcfour(){this.i=0,this.j=0,this.S=new Array}BigInteger.prototype.chunkSize=function bnpChunkSize(c){return Math.floor(Math.LN2*this.DB/Math.log(c))},BigInteger.prototype.toRadix=function bnpToRadix(c){if(null==c&&(c=10),0==this.signum()||c<2||c>36)return"0";var p=this.chunkSize(c),v=Math.pow(c,p),x=nbv(v),E=nbi(),F=nbi(),C="";for(this.divRemTo(x,E,F);E.signum()>0;)C=(v+F.intValue()).toString(c).substr(1)+C,E.divRemTo(x,E,F);return F.intValue().toString(c)+C},BigInteger.prototype.fromRadix=function bnpFromRadix(c,p){this.fromInt(0),null==p&&(p=10);for(var v=this.chunkSize(p),x=Math.pow(p,v),E=!1,F=0,C=0,P=0;P<c.length;++P){var R=intAt(c,P);R<0?"-"==c.charAt(P)&&0==this.signum()&&(E=!0):(C=p*C+R,++F>=v&&(this.dMultiply(x),this.dAddOffset(C,0),F=0,C=0))}F>0&&(this.dMultiply(Math.pow(p,F)),this.dAddOffset(C,0)),E&&BigInteger.ZERO.subTo(this,this)},BigInteger.prototype.fromNumber=function bnpFromNumber(c,p,v){if("number"==typeof p)if(c<2)this.fromInt(1);else for(this.fromNumber(c,v),this.testBit(c-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(c-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(p);)this.dAddOffset(2,0),this.bitLength()>c&&this.subTo(BigInteger.ONE.shiftLeft(c-1),this);else{var x=new Array,E=7&c;x.length=1+(c>>3),p.nextBytes(x),E>0?x[0]&=(1<<E)-1:x[0]=0,this.fromString(x,256)}},BigInteger.prototype.bitwiseTo=function bnpBitwiseTo(c,p,v){var x,E,F=Math.min(c.t,this.t);for(x=0;x<F;++x)v[x]=p(this[x],c[x]);if(c.t<this.t){for(E=c.s&this.DM,x=F;x<this.t;++x)v[x]=p(this[x],E);v.t=this.t}else{for(E=this.s&this.DM,x=F;x<c.t;++x)v[x]=p(E,c[x]);v.t=c.t}v.s=p(this.s,c.s),v.clamp()},BigInteger.prototype.changeBit=function bnpChangeBit(c,p){var v=BigInteger.ONE.shiftLeft(c);return this.bitwiseTo(v,p,v),v},BigInteger.prototype.addTo=function bnpAddTo(c,p){for(var v=0,x=0,E=Math.min(c.t,this.t);v<E;)x+=this[v]+c[v],p[v++]=x&this.DM,x>>=this.DB;if(c.t<this.t){for(x+=c.s;v<this.t;)x+=this[v],p[v++]=x&this.DM,x>>=this.DB;x+=this.s}else{for(x+=this.s;v<c.t;)x+=c[v],p[v++]=x&this.DM,x>>=this.DB;x+=c.s}p.s=x<0?-1:0,x>0?p[v++]=x:x<-1&&(p[v++]=this.DV+x),p.t=v,p.clamp()},BigInteger.prototype.dMultiply=function bnpDMultiply(c){this[this.t]=this.am(0,c-1,this,0,0,this.t),++this.t,this.clamp()},BigInteger.prototype.dAddOffset=function bnpDAddOffset(c,p){if(0!=c){for(;this.t<=p;)this[this.t++]=0;for(this[p]+=c;this[p]>=this.DV;)this[p]-=this.DV,++p>=this.t&&(this[this.t++]=0),++this[p]}},BigInteger.prototype.multiplyLowerTo=function bnpMultiplyLowerTo(c,p,v){var x,E=Math.min(this.t+c.t,p);for(v.s=0,v.t=E;E>0;)v[--E]=0;for(x=v.t-this.t;E<x;++E)v[E+this.t]=this.am(0,c[E],v,E,0,this.t);for(x=Math.min(c.t,p);E<x;++E)this.am(0,c[E],v,E,0,p-E);v.clamp()},BigInteger.prototype.multiplyUpperTo=function bnpMultiplyUpperTo(c,p,v){--p;var x=v.t=this.t+c.t-p;for(v.s=0;--x>=0;)v[x]=0;for(x=Math.max(p-this.t,0);x<c.t;++x)v[this.t+x-p]=this.am(p-x,c[x],v,0,0,this.t+x-p);v.clamp(),v.drShiftTo(1,v)},BigInteger.prototype.modInt=function bnpModInt(c){if(c<=0)return 0;var p=this.DV%c,v=this.s<0?c-1:0;if(this.t>0)if(0==p)v=this[0]%c;else for(var x=this.t-1;x>=0;--x)v=(p*v+this[x])%c;return v},BigInteger.prototype.millerRabin=function bnpMillerRabin(c){var p=this.subtract(BigInteger.ONE),v=p.getLowestSetBit();if(v<=0)return!1;var x=p.shiftRight(v);(c=c+1>>1)>_.length&&(c=_.length);for(var E=nbi(),F=0;F<c;++F){E.fromInt(_[Math.floor(Math.random()*_.length)]);var C=E.modPow(x,this);if(0!=C.compareTo(BigInteger.ONE)&&0!=C.compareTo(p)){for(var P=1;P++<v&&0!=C.compareTo(p);)if(0==(C=C.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=C.compareTo(p))return!1}}return!0},BigInteger.prototype.clone=function bnClone(){var c=nbi();return this.copyTo(c),c},BigInteger.prototype.intValue=function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},BigInteger.prototype.byteValue=function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24},BigInteger.prototype.shortValue=function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16},BigInteger.prototype.signum=function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},BigInteger.prototype.toByteArray=function bnToByteArray(){var c=this.t,p=new Array;p[0]=this.s;var v,x=this.DB-c*this.DB%8,E=0;if(c-- >0)for(x<this.DB&&(v=this[c]>>x)!=(this.s&this.DM)>>x&&(p[E++]=v|this.s<<this.DB-x);c>=0;)x<8?(v=(this[c]&(1<<x)-1)<<8-x,v|=this[--c]>>(x+=this.DB-8)):(v=this[c]>>(x-=8)&255,x<=0&&(x+=this.DB,--c)),0!=(128&v)&&(v|=-256),0==E&&(128&this.s)!=(128&v)&&++E,(E>0||v!=this.s)&&(p[E++]=v);return p},BigInteger.prototype.equals=function bnEquals(c){return 0==this.compareTo(c)},BigInteger.prototype.min=function bnMin(c){return this.compareTo(c)<0?this:c},BigInteger.prototype.max=function bnMax(c){return this.compareTo(c)>0?this:c},BigInteger.prototype.and=function bnAnd(c){var p=nbi();return this.bitwiseTo(c,op_and,p),p},BigInteger.prototype.or=function bnOr(c){var p=nbi();return this.bitwiseTo(c,op_or,p),p},BigInteger.prototype.xor=function bnXor(c){var p=nbi();return this.bitwiseTo(c,op_xor,p),p},BigInteger.prototype.andNot=function bnAndNot(c){var p=nbi();return this.bitwiseTo(c,op_andnot,p),p},BigInteger.prototype.not=function bnNot(){for(var c=nbi(),p=0;p<this.t;++p)c[p]=this.DM&~this[p];return c.t=this.t,c.s=~this.s,c},BigInteger.prototype.shiftLeft=function bnShiftLeft(c){var p=nbi();return c<0?this.rShiftTo(-c,p):this.lShiftTo(c,p),p},BigInteger.prototype.shiftRight=function bnShiftRight(c){var p=nbi();return c<0?this.lShiftTo(-c,p):this.rShiftTo(c,p),p},BigInteger.prototype.getLowestSetBit=function bnGetLowestSetBit(){for(var c=0;c<this.t;++c)if(0!=this[c])return c*this.DB+lbit(this[c]);return this.s<0?this.t*this.DB:-1},BigInteger.prototype.bitCount=function bnBitCount(){for(var c=0,p=this.s&this.DM,v=0;v<this.t;++v)c+=cbit(this[v]^p);return c},BigInteger.prototype.testBit=function bnTestBit(c){var p=Math.floor(c/this.DB);return p>=this.t?0!=this.s:0!=(this[p]&1<<c%this.DB)},BigInteger.prototype.setBit=function bnSetBit(c){return this.changeBit(c,op_or)},BigInteger.prototype.clearBit=function bnClearBit(c){return this.changeBit(c,op_andnot)},BigInteger.prototype.flipBit=function bnFlipBit(c){return this.changeBit(c,op_xor)},BigInteger.prototype.add=function bnAdd(c){var p=nbi();return this.addTo(c,p),p},BigInteger.prototype.subtract=function bnSubtract(c){var p=nbi();return this.subTo(c,p),p},BigInteger.prototype.multiply=function bnMultiply(c){var p=nbi();return this.multiplyTo(c,p),p},BigInteger.prototype.divide=function bnDivide(c){var p=nbi();return this.divRemTo(c,p,null),p},BigInteger.prototype.remainder=function bnRemainder(c){var p=nbi();return this.divRemTo(c,null,p),p},BigInteger.prototype.divideAndRemainder=function bnDivideAndRemainder(c){var p=nbi(),v=nbi();return this.divRemTo(c,p,v),new Array(p,v)},BigInteger.prototype.modPow=function bnModPow(c,p){var v,x,E=c.bitLength(),F=nbv(1);if(E<=0)return F;v=E<18?1:E<48?3:E<144?4:E<768?5:6,x=E<8?new Classic(p):p.isEven()?new Barrett(p):new Montgomery(p);var C=new Array,P=3,R=v-1,B=(1<<v)-1;if(C[1]=x.convert(this),v>1){var T=nbi();for(x.sqrTo(C[1],T);P<=B;)C[P]=nbi(),x.mulTo(T,C[P-2],C[P]),P+=2}var N,_,L=c.t-1,V=!0,U=nbi();for(E=nbits(c[L])-1;L>=0;){for(E>=R?N=c[L]>>E-R&B:(N=(c[L]&(1<<E+1)-1)<<R-E,L>0&&(N|=c[L-1]>>this.DB+E-R)),P=v;0==(1&N);)N>>=1,--P;if((E-=P)<0&&(E+=this.DB,--L),V)C[N].copyTo(F),V=!1;else{for(;P>1;)x.sqrTo(F,U),x.sqrTo(U,F),P-=2;P>0?x.sqrTo(F,U):(_=F,F=U,U=_),x.mulTo(U,C[N],F)}for(;L>=0&&0==(c[L]&1<<E);)x.sqrTo(F,U),_=F,F=U,U=_,--E<0&&(E=this.DB-1,--L)}return x.revert(F)},BigInteger.prototype.modInverse=function bnModInverse(c){var p=c.isEven();if(this.isEven()&&p||0==c.signum())return BigInteger.ZERO;for(var v=c.clone(),x=this.clone(),E=nbv(1),F=nbv(0),C=nbv(0),P=nbv(1);0!=v.signum();){for(;v.isEven();)v.rShiftTo(1,v),p?(E.isEven()&&F.isEven()||(E.addTo(this,E),F.subTo(c,F)),E.rShiftTo(1,E)):F.isEven()||F.subTo(c,F),F.rShiftTo(1,F);for(;x.isEven();)x.rShiftTo(1,x),p?(C.isEven()&&P.isEven()||(C.addTo(this,C),P.subTo(c,P)),C.rShiftTo(1,C)):P.isEven()||P.subTo(c,P),P.rShiftTo(1,P);v.compareTo(x)>=0?(v.subTo(x,v),p&&E.subTo(C,E),F.subTo(P,F)):(x.subTo(v,x),p&&C.subTo(E,C),P.subTo(F,P))}return 0!=x.compareTo(BigInteger.ONE)?BigInteger.ZERO:P.compareTo(c)>=0?P.subtract(c):P.signum()<0?(P.addTo(c,P),P.signum()<0?P.add(c):P):P},BigInteger.prototype.pow=function bnPow(c){return this.exp(c,new NullExp)},BigInteger.prototype.gcd=function bnGCD(c){var p=this.s<0?this.negate():this.clone(),v=c.s<0?c.negate():c.clone();if(p.compareTo(v)<0){var x=p;p=v,v=x}var E=p.getLowestSetBit(),F=v.getLowestSetBit();if(F<0)return p;for(E<F&&(F=E),F>0&&(p.rShiftTo(F,p),v.rShiftTo(F,v));p.signum()>0;)(E=p.getLowestSetBit())>0&&p.rShiftTo(E,p),(E=v.getLowestSetBit())>0&&v.rShiftTo(E,v),p.compareTo(v)>=0?(p.subTo(v,p),p.rShiftTo(1,p)):(v.subTo(p,v),v.rShiftTo(1,v));return F>0&&v.lShiftTo(F,v),v},BigInteger.prototype.isProbablePrime=function bnIsProbablePrime(c){var p,v=this.abs();if(1==v.t&&v[0]<=_[_.length-1]){for(p=0;p<_.length;++p)if(v[0]==_[p])return!0;return!1}if(v.isEven())return!1;for(p=1;p<_.length;){for(var x=_[p],E=p+1;E<_.length&&x<L;)x*=_[E++];for(x=v.modInt(x);p<E;)if(x%_[p++]==0)return!1}return v.millerRabin(c)},BigInteger.prototype.square=function bnSquare(){var c=nbi();return this.squareTo(c),c},Arcfour.prototype.init=function ARC4init(c){var p,v,x;for(p=0;p<256;++p)this.S[p]=p;for(v=0,p=0;p<256;++p)v=v+this.S[p]+c[p%c.length]&255,x=this.S[p],this.S[p]=this.S[v],this.S[v]=x;this.i=0,this.j=0},Arcfour.prototype.next=function ARC4next(){var c;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,c=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=c,this.S[c+this.S[this.i]&255]};var V,U,W,G=256;function rng_seed_time(){!function rng_seed_int(c){U[W++]^=255&c,U[W++]^=c>>8&255,U[W++]^=c>>16&255,U[W++]^=c>>24&255,W>=G&&(W-=G)}((new Date).getTime())}if(null==U){var X;if(U=new Array,W=0,void 0!==x&&(void 0!==x.crypto||void 0!==x.msCrypto)){var J=x.crypto||x.msCrypto;if(J.getRandomValues){var Z=new Uint8Array(32);for(J.getRandomValues(Z),X=0;X<32;++X)U[W++]=Z[X]}else if("Netscape"==v.appName&&v.appVersion<"5"){var Y=x.crypto.random(32);for(X=0;X<Y.length;++X)U[W++]=255&Y.charCodeAt(X)}}for(;W<G;)X=Math.floor(65536*Math.random()),U[W++]=X>>>8,U[W++]=255&X;W=0,rng_seed_time()}function rng_get_byte(){if(null==V){for(rng_seed_time(),(V=function prng_newstate(){return new Arcfour}()).init(U),W=0;W<U.length;++W)U[W]=0;W=0}return V.next()}function SecureRandom(){}function parseBigInt(c,p){return new BigInteger(c,p)}function oaep_mgf1_arr(c,p,v){for(var x="",E=0;x.length<p;)x+=v(String.fromCharCode.apply(String,c.concat([(4278190080&E)>>24,(16711680&E)>>16,(65280&E)>>8,255&E]))),E+=1;return x}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function oaep_mgf1_str(c,p,v){for(var x="",E=0;x.length<p;)x+=v(c+String.fromCharCode.apply(String,[(4278190080&E)>>24,(16711680&E)>>16,(65280&E)>>8,255&E])),E+=1;return x}function ECFieldElementFp(c,p){this.x=p,this.q=c}function ECPointFp(c,p,v,x){this.curve=c,this.x=p,this.y=v,this.z=null==x?BigInteger.ONE:x,this.zinv=null}function ECCurveFp(c,p,v){this.q=c,this.a=this.fromBigInteger(p),this.b=this.fromBigInteger(v),this.infinity=new ECPointFp(this,null,null)}SecureRandom.prototype.nextBytes=function rng_get_bytes(c){var p;for(p=0;p<c.length;++p)c[p]=rng_get_byte()},RSAKey.prototype.doPublic=function RSADoPublic(c){return c.modPowInt(this.e,this.n)},RSAKey.prototype.setPublic=function RSASetPublic(c,p){if(this.isPublic=!0,this.isPrivate=!1,"string"!==typeof c)this.n=c,this.e=p;else{if(!(null!=c&&null!=p&&c.length>0&&p.length>0))throw"Invalid RSA public key";this.n=parseBigInt(c,16),this.e=parseInt(p,16)}},RSAKey.prototype.encrypt=function RSAEncrypt(c){var p=function pkcs1pad2(c,p){if(p<c.length+11)throw"Message too long for RSA";for(var v=new Array,x=c.length-1;x>=0&&p>0;){var E=c.charCodeAt(x--);E<128?v[--p]=E:E>127&&E<2048?(v[--p]=63&E|128,v[--p]=E>>6|192):(v[--p]=63&E|128,v[--p]=E>>6&63|128,v[--p]=E>>12|224)}v[--p]=0;for(var F=new SecureRandom,C=new Array;p>2;){for(C[0]=0;0==C[0];)F.nextBytes(C);v[--p]=C[0]}return v[--p]=2,v[--p]=0,new BigInteger(v)}(c,this.n.bitLength()+7>>3);if(null==p)return null;var v=this.doPublic(p);if(null==v)return null;var x=v.toString(16);return 0==(1&x.length)?x:"0"+x},RSAKey.prototype.encryptOAEP=function RSAEncryptOAEP(c,p,v){var x=this.n.bitLength()+7>>3,E=function oaep_pad(c,p,v,x){var E=tt.crypto.MessageDigest,F=tt.crypto.Util,C=null;if(v||(v="sha1"),"string"===typeof v&&(C=E.getCanonicalAlgName(v),x=E.getHashLength(C),v=function(c){return hextorstr(F.hashHex(rstrtohex(c),C))}),c.length+2*x+2>p)throw"Message too long for RSA";var P,R="";for(P=0;P<p-c.length-2*x-2;P+=1)R+="\0";var B=v("")+R+"\x01"+c,T=new Array(x);(new SecureRandom).nextBytes(T);var N=oaep_mgf1_arr(T,B.length,v),_=[];for(P=0;P<B.length;P+=1)_[P]=B.charCodeAt(P)^N.charCodeAt(P);var L=oaep_mgf1_arr(_,T.length,v),V=[0];for(P=0;P<T.length;P+=1)V[P+1]=T[P]^L.charCodeAt(P);return new BigInteger(V.concat(_))}(c,x,p,v);if(null==E)return null;var F=this.doPublic(E);if(null==F)return null;for(var C=F.toString(16);C.length<2*x;)C="0"+C;return C},RSAKey.prototype.type="RSA",RSAKey.prototype.doPrivate=function RSADoPrivate(c){if(null==this.p||null==this.q)return c.modPow(this.d,this.n);for(var p=c.mod(this.p).modPow(this.dmp1,this.p),v=c.mod(this.q).modPow(this.dmq1,this.q);p.compareTo(v)<0;)p=p.add(this.p);return p.subtract(v).multiply(this.coeff).mod(this.p).multiply(this.q).add(v)},RSAKey.prototype.setPrivate=function RSASetPrivate(c,p,v){if(this.isPrivate=!0,"string"!==typeof c)this.n=c,this.e=p,this.d=v;else{if(!(null!=c&&null!=p&&c.length>0&&p.length>0))throw"Invalid RSA private key";this.n=parseBigInt(c,16),this.e=parseInt(p,16),this.d=parseBigInt(v,16)}},RSAKey.prototype.setPrivateEx=function RSASetPrivateEx(c,p,v,x,E,F,C,P){if(this.isPrivate=!0,this.isPublic=!1,null==c)throw"RSASetPrivateEx N == null";if(null==p)throw"RSASetPrivateEx E == null";if(0==c.length)throw"RSASetPrivateEx N.length == 0";if(0==p.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=c&&null!=p&&c.length>0&&p.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=parseBigInt(c,16),this.e=parseInt(p,16),this.d=parseBigInt(v,16),this.p=parseBigInt(x,16),this.q=parseBigInt(E,16),this.dmp1=parseBigInt(F,16),this.dmq1=parseBigInt(C,16),this.coeff=parseBigInt(P,16)},RSAKey.prototype.generate=function RSAGenerate(c,p){var v=new SecureRandom,x=c>>1;this.e=parseInt(p,16);for(var E=new BigInteger(p,16),F=c/2-100,C=BigInteger.ONE.shiftLeft(F);;){for(;this.p=new BigInteger(c-x,1,v),0!=this.p.subtract(BigInteger.ONE).gcd(E).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(x,1,v),0!=this.q.subtract(BigInteger.ONE).gcd(E).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var P=this.p;this.p=this.q,this.q=P}var R=this.q.subtract(this.p).abs();if(!(R.bitLength()<F||R.compareTo(C)<=0)){var B=this.p.subtract(BigInteger.ONE),T=this.q.subtract(BigInteger.ONE),N=B.multiply(T);if(0==N.gcd(E).compareTo(BigInteger.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==c)){this.d=E.modInverse(N),this.dmp1=this.d.mod(B),this.dmq1=this.d.mod(T),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},RSAKey.prototype.decrypt=function RSADecrypt(c){if(c.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var p=parseBigInt(c,16),v=this.doPrivate(p);return null==v?null:function pkcs1unpad2(c,p){for(var v=c.toByteArray(),x=0;x<v.length&&0==v[x];)++x;if(v.length-x!=p-1||2!=v[x])return null;for(++x;0!=v[x];)if(++x>=v.length)return null;for(var E="";++x<v.length;){var F=255&v[x];F<128?E+=String.fromCharCode(F):F>191&&F<224?(E+=String.fromCharCode((31&F)<<6|63&v[x+1]),++x):(E+=String.fromCharCode((15&F)<<12|(63&v[x+1])<<6|63&v[x+2]),x+=2)}return E}(v,this.n.bitLength()+7>>3)},RSAKey.prototype.decryptOAEP=function RSADecryptOAEP(c,p,v){if(c.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var x=parseBigInt(c,16),E=this.doPrivate(x);return null==E?null:function oaep_unpad(c,p,v,x){var E=tt.crypto.MessageDigest,F=tt.crypto.Util,C=null;for(v||(v="sha1"),"string"===typeof v&&(C=E.getCanonicalAlgName(v),x=E.getHashLength(C),v=function(c){return hextorstr(F.hashHex(rstrtohex(c),C))}),c=c.toByteArray(),P=0;P<c.length;P+=1)c[P]&=255;for(;c.length<p;)c.unshift(0);if((c=String.fromCharCode.apply(String,c)).length<2*x+2)throw"Cipher too short";var P,R=c.substr(1,x),B=c.substr(x+1),T=oaep_mgf1_str(B,x,v),N=[];for(P=0;P<R.length;P+=1)N[P]=R.charCodeAt(P)^T.charCodeAt(P);var _=oaep_mgf1_str(String.fromCharCode.apply(String,N),c.length-x,v),L=[];for(P=0;P<B.length;P+=1)L[P]=B.charCodeAt(P)^_.charCodeAt(P);if((L=String.fromCharCode.apply(String,L)).substr(0,x)!==v(""))throw"Hash mismatch";var V=(L=L.substr(x)).indexOf("\x01");if((-1!=V?L.substr(0,V).lastIndexOf("\0"):-1)+1!=V)throw"Malformed data";return L.substr(V+1)}(E,this.n.bitLength()+7>>3,p,v)},ECFieldElementFp.prototype.equals=function feFpEquals(c){return c==this||this.q.equals(c.q)&&this.x.equals(c.x)},ECFieldElementFp.prototype.toBigInteger=function feFpToBigInteger(){return this.x},ECFieldElementFp.prototype.negate=function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))},ECFieldElementFp.prototype.add=function feFpAdd(c){return new ECFieldElementFp(this.q,this.x.add(c.toBigInteger()).mod(this.q))},ECFieldElementFp.prototype.subtract=function feFpSubtract(c){return new ECFieldElementFp(this.q,this.x.subtract(c.toBigInteger()).mod(this.q))},ECFieldElementFp.prototype.multiply=function feFpMultiply(c){return new ECFieldElementFp(this.q,this.x.multiply(c.toBigInteger()).mod(this.q))},ECFieldElementFp.prototype.square=function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))},ECFieldElementFp.prototype.divide=function feFpDivide(c){return new ECFieldElementFp(this.q,this.x.multiply(c.toBigInteger().modInverse(this.q)).mod(this.q))},ECFieldElementFp.prototype.sqrt=function(){return new ECFieldElementFp(this.q,this.x.sqrt().mod(this.q))},ECPointFp.prototype.getX=function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ECPointFp.prototype.getY=function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ECPointFp.prototype.equals=function pointFpEquals(c){return c==this||(this.isInfinity()?c.isInfinity():c.isInfinity()?this.isInfinity():!!c.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(c.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&c.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(c.z)).mod(this.curve.q).equals(BigInteger.ZERO))},ECPointFp.prototype.isInfinity=function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)},ECPointFp.prototype.negate=function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)},ECPointFp.prototype.add=function pointFpAdd(c){if(this.isInfinity())return c;if(c.isInfinity())return this;var p=c.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(c.z)).mod(this.curve.q),v=c.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(c.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(v))return BigInteger.ZERO.equals(p)?this.twice():this.curve.getInfinity();var x=new BigInteger("3"),E=this.x.toBigInteger(),F=this.y.toBigInteger(),C=(c.x.toBigInteger(),c.y.toBigInteger(),v.square()),P=C.multiply(v),R=E.multiply(C),B=p.square().multiply(this.z),T=B.subtract(R.shiftLeft(1)).multiply(c.z).subtract(P).multiply(v).mod(this.curve.q),N=R.multiply(x).multiply(p).subtract(F.multiply(P)).subtract(B.multiply(p)).multiply(c.z).add(p.multiply(P)).mod(this.curve.q),_=P.multiply(this.z).multiply(c.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(T),this.curve.fromBigInteger(N),_)},ECPointFp.prototype.twice=function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var c=new BigInteger("3"),p=this.x.toBigInteger(),v=this.y.toBigInteger(),x=v.multiply(this.z),E=x.multiply(v).mod(this.curve.q),F=this.curve.a.toBigInteger(),C=p.square().multiply(c);BigInteger.ZERO.equals(F)||(C=C.add(this.z.square().multiply(F)));var P=(C=C.mod(this.curve.q)).square().subtract(p.shiftLeft(3).multiply(E)).shiftLeft(1).multiply(x).mod(this.curve.q),R=C.multiply(c).multiply(p).subtract(E.shiftLeft(1)).shiftLeft(2).multiply(E).subtract(C.square().multiply(C)).mod(this.curve.q),B=x.square().multiply(x).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(P),this.curve.fromBigInteger(R),B)},ECPointFp.prototype.multiply=function pointFpMultiply(c){if(this.isInfinity())return this;if(0==c.signum())return this.curve.getInfinity();var p,v=c,x=v.multiply(new BigInteger("3")),E=this.negate(),F=this,C=this.curve.q.subtract(c),P=C.multiply(new BigInteger("3")),R=new ECPointFp(this.curve,this.x,this.y),B=R.negate();for(p=x.bitLength()-2;p>0;--p){F=F.twice();var T=x.testBit(p);T!=v.testBit(p)&&(F=F.add(T?this:E))}for(p=P.bitLength()-2;p>0;--p){R=R.twice();var N=P.testBit(p);N!=C.testBit(p)&&(R=R.add(N?R:B))}return F},ECPointFp.prototype.multiplyTwo=function pointFpMultiplyTwo(c,p,v){var x;x=c.bitLength()>v.bitLength()?c.bitLength()-1:v.bitLength()-1;for(var E=this.curve.getInfinity(),F=this.add(p);x>=0;)E=E.twice(),c.testBit(x)?E=v.testBit(x)?E.add(F):E.add(this):v.testBit(x)&&(E=E.add(p)),--x;return E},ECCurveFp.prototype.getQ=function curveFpGetQ(){return this.q},ECCurveFp.prototype.getA=function curveFpGetA(){return this.a},ECCurveFp.prototype.getB=function curveFpGetB(){return this.b},ECCurveFp.prototype.equals=function curveFpEquals(c){return c==this||this.q.equals(c.q)&&this.a.equals(c.a)&&this.b.equals(c.b)},ECCurveFp.prototype.getInfinity=function curveFpGetInfinity(){return this.infinity},ECCurveFp.prototype.fromBigInteger=function curveFpFromBigInteger(c){return new ECFieldElementFp(this.q,c)},ECCurveFp.prototype.decodePointHex=function curveFpDecodePointHex(c){switch(parseInt(c.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var p=c.substr(0,2),v=(c.substr(2),this.fromBigInteger(new BigInteger(P,16))),x=this.getA(),E=this.getB(),F=v.square().add(x).multiply(v).add(E).sqrt();return"03"==p&&(F=F.negate()),new ECPointFp(this,v,F);case 4:case 6:case 7:var C=(c.length-2)/2,P=c.substr(2,C),R=c.substr(C+2,C);return new ECPointFp(this,this.fromBigInteger(new BigInteger(P,16)),this.fromBigInteger(new BigInteger(R,16)));default:return null}},ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(c){var d=function(c,p){var v=c.toByteArrayUnsigned();if(p<v.length)v=v.slice(v.length-p);else for(;p>v.length;)v.unshift(0);return v},p=this.getX().toBigInteger(),v=this.getY().toBigInteger(),x=d(p,32);return c?v.isEven()?x.unshift(2):x.unshift(3):(x.unshift(4),x=x.concat(d(v,32))),x},ECPointFp.decodeFrom=function(c,p){p[0];var v=p.length-1,x=p.slice(1,1+v/2),E=p.slice(1+v/2,1+v);x.unshift(0),E.unshift(0);var F=new BigInteger(x),C=new BigInteger(E);return new ECPointFp(c,c.fromBigInteger(F),c.fromBigInteger(C))},ECPointFp.decodeFromHex=function(c,p){p.substr(0,2);var v=p.length-2,x=p.substr(2,v/2),E=p.substr(2+v/2,v/2),F=new BigInteger(x,16),C=new BigInteger(E,16);return new ECPointFp(c,c.fromBigInteger(F),c.fromBigInteger(C))},ECPointFp.prototype.add2D=function(c){if(this.isInfinity())return c;if(c.isInfinity())return this;if(this.x.equals(c.x))return this.y.equals(c.y)?this.twice():this.curve.getInfinity();var p=c.x.subtract(this.x),v=c.y.subtract(this.y).divide(p),x=v.square().subtract(this.x).subtract(c.x),E=v.multiply(this.x.subtract(x)).subtract(this.y);return new ECPointFp(this.curve,x,E)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var c=this.curve.fromBigInteger(BigInteger.valueOf(2)),p=this.curve.fromBigInteger(BigInteger.valueOf(3)),v=this.x.square().multiply(p).add(this.curve.a).divide(this.y.multiply(c)),x=v.square().subtract(this.x.multiply(c)),E=v.multiply(this.x.subtract(x)).subtract(this.y);return new ECPointFp(this.curve,x,E)},ECPointFp.prototype.multiply2D=function(c){if(this.isInfinity())return this;if(0==c.signum())return this.curve.getInfinity();var p,v=c,x=v.multiply(new BigInteger("3")),E=this.negate(),F=this;for(p=x.bitLength()-2;p>0;--p){F=F.twice();var C=x.testBit(p);C!=v.testBit(p)&&(F=F.add2D(C?this:E))}return F},ECPointFp.prototype.isOnCurve=function(){var c=this.getX().toBigInteger(),p=this.getY().toBigInteger(),v=this.curve.getA().toBigInteger(),x=this.curve.getB().toBigInteger(),E=this.curve.getQ(),F=p.multiply(p).mod(E),C=c.multiply(c).multiply(c).add(v.multiply(c)).add(x).mod(E);return F.equals(C)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var c=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var p=this.getX().toBigInteger(),v=this.getY().toBigInteger();if(p.compareTo(BigInteger.ONE)<0||p.compareTo(c.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(v.compareTo(BigInteger.ONE)<0||v.compareTo(c.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(c).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Q=function(){var c=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),p=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),v={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function h(c,p,x){return p?v[p]:String.fromCharCode(parseInt(x,16))}var x=new String(""),E=Object.hasOwnProperty;return function(v,F){var C,P,R=v.match(c),B=R[0],T=!1;"{"===B?C={}:"["===B?C=[]:(C=[],T=!0);for(var N=[C],_=1-T,L=R.length;_<L;++_){var V;switch((B=R[_]).charCodeAt(0)){default:(V=N[0])[P||V.length]=+B,P=void 0;break;case 34:if(-1!==(B=B.substring(1,B.length-1)).indexOf("\\")&&(B=B.replace(p,h)),V=N[0],!P){if(!(V instanceof Array)){P=B||x;break}P=V.length}V[P]=B,P=void 0;break;case 91:V=N[0],N.unshift(V[P||V.length]=[]),P=void 0;break;case 93:case 125:N.shift();break;case 102:(V=N[0])[P||V.length]=!1,P=void 0;break;case 110:(V=N[0])[P||V.length]=null,P=void 0;break;case 116:(V=N[0])[P||V.length]=!0,P=void 0;break;case 123:V=N[0],N.unshift(V[P||V.length]={}),P=void 0}}if(T){if(1!==N.length)throw new Error;C=C[0]}else if(N.length)throw new Error;if(F){var s=function(c,p){var v=c[p];if(v&&"object"===typeof v){var x=null;for(var C in v)if(E.call(v,C)&&v!==c){var P=s(v,C);void 0!==P?v[C]=P:(x||(x=[]),x.push(C))}if(x)for(var R=x.length;--R>=0;)delete v[x[R]]}return F.call(c,p,v)};C=s({"":C},"")}return C}}();"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),tt.asn1.ASN1Util=new function(){this.integerToByteHex=function(c){var p=c.toString(16);return p.length%2==1&&(p="0"+p),p},this.bigIntToMinTwosComplementsHex=function(c){return twoscompl(c)},this.getPEMStringFromHex=function(c,p){return hextopem(c,p)},this.newObject=function(c){var p=tt.asn1,v=p.ASN1Object,x=p.DERBoolean,E=p.DERInteger,F=p.DERBitString,C=p.DEROctetString,P=p.DERNull,R=p.DERObjectIdentifier,B=p.DEREnumerated,T=p.DERUTF8String,N=p.DERNumericString,_=p.DERPrintableString,L=p.DERTeletexString,V=p.DERIA5String,U=p.DERUTCTime,W=p.DERGeneralizedTime,G=p.DERVisibleString,X=p.DERBMPString,J=p.DERSequence,Z=p.DERSet,Y=p.DERTaggedObject,Q=p.ASN1Util.newObject;if(c instanceof p.ASN1Object)return c;var et=Object.keys(c);if(1!=et.length)throw new Error("key of param shall be only one.");var rt=et[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+rt+":"))throw new Error("undefined key: "+rt);if("bool"==rt)return new x(c[rt]);if("int"==rt)return new E(c[rt]);if("bitstr"==rt)return new F(c[rt]);if("octstr"==rt)return new C(c[rt]);if("null"==rt)return new P(c[rt]);if("oid"==rt)return new R(c[rt]);if("enum"==rt)return new B(c[rt]);if("utf8str"==rt)return new T(c[rt]);if("numstr"==rt)return new N(c[rt]);if("prnstr"==rt)return new _(c[rt]);if("telstr"==rt)return new L(c[rt]);if("ia5str"==rt)return new V(c[rt]);if("utctime"==rt)return new U(c[rt]);if("gentime"==rt)return new W(c[rt]);if("visstr"==rt)return new G(c[rt]);if("bmpstr"==rt)return new X(c[rt]);if("asn1"==rt)return new v(c[rt]);if("seq"==rt){for(var nt=c[rt],it=[],st=0;st<nt.length;st++){var at=Q(nt[st]);it.push(at)}return new J({array:it})}if("set"==rt){for(nt=c[rt],it=[],st=0;st<nt.length;st++){at=Q(nt[st]);it.push(at)}return new Z({array:it})}if("tag"==rt){var ot=c[rt];if("[object Array]"===Object.prototype.toString.call(ot)&&3==ot.length){var ct=Q(ot[2]);return new Y({tag:ot[0],explicit:ot[1],obj:ct})}return new Y(ot)}},this.jsonToASN1HEX=function(c){return this.newObject(c).tohex()}},tt.asn1.ASN1Util.oidHexToInt=function(c){for(var p="",v=parseInt(c.substr(0,2),16),x=(p=Math.floor(v/40)+"."+v%40,""),E=2;E<c.length;E+=2){var F=("00000000"+parseInt(c.substr(E,2),16).toString(2)).slice(-8);if(x+=F.substr(1,7),"0"==F.substr(0,1))p=p+"."+new BigInteger(x,2).toString(10),x=""}return p},tt.asn1.ASN1Util.oidIntToHex=function(c){var e=function(c){var p=c.toString(16);return 1==p.length&&(p="0"+p),p},d=function(c){var p="",v=new BigInteger(c,10).toString(2),x=7-v.length%7;7==x&&(x=0);for(var E="",F=0;F<x;F++)E+="0";v=E+v;for(F=0;F<v.length-1;F+=7){var C=v.substr(F,7);F!=v.length-7&&(C="1"+C),p+=e(parseInt(C,2))}return p};if(!c.match(/^[0-9.]+$/))throw"malformed oid string: "+c;var p="",v=c.split("."),x=40*parseInt(v[0])+parseInt(v[1]);p+=e(x),v.splice(0,2);for(var E=0;E<v.length;E++)p+=d(v[E]);return p},tt.asn1.ASN1Object=function(c){this.params=null,this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n=0,v="+this.hV);var c=this.hV.length/2,p=c.toString(16);if(p.length%2==1&&(p="0"+p),c<128)return p;var v=p.length/2;if(v>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+c.toString(16));return(128+v).toString(16)+p},this.tohex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(c){this.params=c},void 0!=c&&void 0!=c.tlv&&(this.hTLV=c.tlv,this.isModified=!1)},tt.asn1.DERAbstractString=function(c){tt.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.s=c,this.hV=utf8tohex(this.s).toLowerCase()},this.setStringHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof c&&("string"==typeof c?this.setString(c):"undefined"!=typeof c.str?this.setString(c.str):"undefined"!=typeof c.hex&&this.setStringHex(c.hex))},extendClass(tt.asn1.DERAbstractString,tt.asn1.ASN1Object),tt.asn1.DERAbstractTime=function(c){tt.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(c){var p=c.getTime()+6e4*c.getTimezoneOffset();return new Date(p)},this.formatDate=function(c,p,v){var x=this.zeroPadding,E=this.localDateToUTC(c),F=String(E.getFullYear());"utc"==p&&(F=F.substr(2,2));var C=F+x(String(E.getMonth()+1),2)+x(String(E.getDate()),2)+x(String(E.getHours()),2)+x(String(E.getMinutes()),2)+x(String(E.getSeconds()),2);if(!0===v){var P=E.getMilliseconds();if(0!=P){var R=x(String(P),3);C=C+"."+(R=R.replace(/[0]+$/,""))}}return C+"Z"},this.zeroPadding=function(c,p){return c.length>=p?c:new Array(p-c.length+1).join("0")+c},this.setByParam=function(c){this.hV=null,this.hTLV=null,this.params=c},this.getString=function(){},this.setString=function(c){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.str=c},this.setByDate=function(c){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.date=c},this.setByDateValue=function(c,p,v,x,E,F){var C=new Date(Date.UTC(c,p-1,v,x,E,F,0));this.setByDate(C)},this.getFreshValueHex=function(){return this.hV}},extendClass(tt.asn1.DERAbstractTime,tt.asn1.ASN1Object),tt.asn1.DERAbstractStructured=function(c){tt.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array=c},this.appendASN1Object=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array.push(c)},this.asn1Array=new Array,"undefined"!=typeof c&&"undefined"!=typeof c.array&&(this.asn1Array=c.array)},extendClass(tt.asn1.DERAbstractStructured,tt.asn1.ASN1Object),tt.asn1.DERBoolean=function(c){tt.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==c?"010100":"0101ff"},extendClass(tt.asn1.DERBoolean,tt.asn1.ASN1Object),tt.asn1.DERInteger=function(c){tt.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var p=twoscompl;this.setByBigInteger=function(c){this.isModified=!0,this.params={bigint:c}},this.setByInteger=function(c){this.isModified=!0,this.params=c},this.setValueHex=function(c){this.isModified=!0,this.params={hex:c}},this.getFreshValueHex=function(){var c=this.params,v=null;if(null==c)throw new Error("value not set");if("object"==typeof c&&void 0!=c.hex)return this.hV=c.hex,this.hV;if("number"==typeof c)v=new BigInteger(String(c),10);else if(void 0!=c.int)v=new BigInteger(String(c.int),10);else{if(void 0==c.bigint)throw new Error("wrong parameter");v=c.bigint}return this.hV=p(v),this.hV},void 0!=c&&(this.params=c)},extendClass(tt.asn1.DERInteger,tt.asn1.ASN1Object),tt.asn1.DERBitString=function(c){if(void 0!==c&&"undefined"!==typeof c.obj){var p=tt.asn1.ASN1Util.newObject(c.obj);c.hex="00"+p.tohex()}tt.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(c){this.hTLV=null,this.isModified=!0,this.hV=c},this.setUnusedBitsAndHexValue=function(c,p){if(c<0||7<c)throw"unused bits shall be from 0 to 7: u = "+c;var v="0"+c;this.hTLV=null,this.isModified=!0,this.hV=v+p},this.setByBinaryString=function(c){var p=8-(c=c.replace(/0+$/,"")).length%8;8==p&&(p=0),c+="0000000".substr(0,p);for(var v="",x=0;x<c.length-1;x+=8){var E=c.substr(x,8),F=parseInt(E,2).toString(16);1==F.length&&(F="0"+F),v+=F}this.hTLV=null,this.isModified=!0,this.hV="0"+p+v},this.setByBooleanArray=function(c){for(var p="",v=0;v<c.length;v++)1==c[v]?p+="1":p+="0";this.setByBinaryString(p)},this.newFalseArray=function(c){for(var p=new Array(c),v=0;v<c;v++)p[v]=!1;return p},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof c&&("string"==typeof c&&c.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(c):"undefined"!=typeof c.hex?this.setHexValueIncludingUnusedBits(c.hex):"undefined"!=typeof c.bin?this.setByBinaryString(c.bin):"undefined"!=typeof c.array&&this.setByBooleanArray(c.array))},extendClass(tt.asn1.DERBitString,tt.asn1.ASN1Object),tt.asn1.DEROctetString=function(c){if(void 0!==c&&"undefined"!==typeof c.obj){var p=tt.asn1.ASN1Util.newObject(c.obj);c.hex=p.tohex()}tt.asn1.DEROctetString.superclass.constructor.call(this,c),this.hT="04"},extendClass(tt.asn1.DEROctetString,tt.asn1.DERAbstractString),tt.asn1.DERNull=function(){tt.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},extendClass(tt.asn1.DERNull,tt.asn1.ASN1Object),tt.asn1.DERObjectIdentifier=function(c){tt.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.setValueOidString=function(c){var p=oidtohex(c);if(null==p)throw new Error("malformed oid string: "+c);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=p},this.setValueName=function(c){var p=tt.asn1.x509.OID.name2oid(c);if(""===p)throw new Error("DERObjectIdentifier oidName undefined: "+c);this.setValueOidString(p)},this.setValueNameOrOid=function(c){c.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(c):this.setValueName(c)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(c){"string"===typeof c?this.setValueNameOrOid(c):void 0!==c.oid?this.setValueNameOrOid(c.oid):void 0!==c.name?this.setValueNameOrOid(c.name):void 0!==c.hex&&this.setValueHex(c.hex)},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.DERObjectIdentifier,tt.asn1.ASN1Object),tt.asn1.DEREnumerated=function(c){tt.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(c){this.hTLV=null,this.isModified=!0,this.hV=twoscompl(c)},this.setByInteger=function(c){var p=new BigInteger(String(c),10);this.setByBigInteger(p)},this.setValueHex=function(c){this.hV=c},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof c&&("undefined"!=typeof c.int?this.setByInteger(c.int):"number"==typeof c?this.setByInteger(c):"undefined"!=typeof c.hex&&this.setValueHex(c.hex))},extendClass(tt.asn1.DEREnumerated,tt.asn1.ASN1Object),tt.asn1.DERUTF8String=function(c){tt.asn1.DERUTF8String.superclass.constructor.call(this,c),this.hT="0c"},extendClass(tt.asn1.DERUTF8String,tt.asn1.DERAbstractString),tt.asn1.DERNumericString=function(c){tt.asn1.DERNumericString.superclass.constructor.call(this,c),this.hT="12"},extendClass(tt.asn1.DERNumericString,tt.asn1.DERAbstractString),tt.asn1.DERPrintableString=function(c){tt.asn1.DERPrintableString.superclass.constructor.call(this,c),this.hT="13"},extendClass(tt.asn1.DERPrintableString,tt.asn1.DERAbstractString),tt.asn1.DERTeletexString=function(c){tt.asn1.DERTeletexString.superclass.constructor.call(this,c),this.hT="14"},extendClass(tt.asn1.DERTeletexString,tt.asn1.DERAbstractString),tt.asn1.DERIA5String=function(c){tt.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="16"},extendClass(tt.asn1.DERIA5String,tt.asn1.DERAbstractString),tt.asn1.DERVisibleString=function(c){tt.asn1.DERIA5String.superclass.constructor.call(this,c),this.hT="1a"},extendClass(tt.asn1.DERVisibleString,tt.asn1.DERAbstractString),tt.asn1.DERBMPString=function(c){tt.asn1.DERBMPString.superclass.constructor.call(this,c),this.hT="1e"},extendClass(tt.asn1.DERBMPString,tt.asn1.DERAbstractString),tt.asn1.DERUTCTime=function(c){tt.asn1.DERUTCTime.superclass.constructor.call(this,c),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var c=this.params;if(void 0==this.params&&(c={date:new Date}),"string"==typeof c){if(!c.match(/^[0-9]{12}Z$/)&&!c.match(/^[0-9]{12}\.[0-9]+Z$/))throw new Error("malformed string for UTCTime: "+c);this.hV=stohex(c)}else if(void 0!=c.str)this.hV=stohex(c.str);else if(void 0==c.date&&1==c.millis){var p=new Date;this.hV=stohex(this.formatDate(p,"utc",!0))}else if(void 0!=c.date&&c.date instanceof Date){var v=!0===c.millis;this.hV=stohex(this.formatDate(c.date,"utc",v))}else c instanceof Date&&(this.hV=stohex(this.formatDate(c,"utc")));if(void 0==this.hV)throw new Error("parameter not specified properly for UTCTime");return this.hV},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.DERUTCTime,tt.asn1.DERAbstractTime),tt.asn1.DERGeneralizedTime=function(c){tt.asn1.DERGeneralizedTime.superclass.constructor.call(this,c),this.hT="18",this.params=c,this.getFreshValueHex=function(){var c=this.params;if(void 0==this.params&&(c={date:new Date}),"string"==typeof c){if(!c.match(/^[0-9]{14}Z$/)&&!c.match(/^[0-9]{14}\.[0-9]+Z$/))throw new Error("malformed string for GeneralizedTime: "+c);this.hV=stohex(c)}else if(void 0!=c.str)this.hV=stohex(c.str);else if(void 0==c.date&&1==c.millis){var p=new Date;this.hV=stohex(this.formatDate(p,"gen",!0))}else if(void 0!=c.date&&c.date instanceof Date){var v=!0===c.millis;this.hV=stohex(this.formatDate(c.date,"gen",v))}else c instanceof Date&&(this.hV=stohex(this.formatDate(c,"gen")));if(void 0==this.hV)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.DERGeneralizedTime,tt.asn1.DERAbstractTime),tt.asn1.DERSequence=function(c){tt.asn1.DERSequence.superclass.constructor.call(this,c),this.hT="30",this.getFreshValueHex=function(){for(var c="",p=0;p<this.asn1Array.length;p++){c+=this.asn1Array[p].tohex()}return this.hV=c,this.hV}},extendClass(tt.asn1.DERSequence,tt.asn1.DERAbstractStructured),tt.asn1.DERSet=function(c){tt.asn1.DERSet.superclass.constructor.call(this,c),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var c=new Array,p=0;p<this.asn1Array.length;p++){var v=this.asn1Array[p];c.push(v.tohex())}return 1==this.sortFlag&&c.sort(),this.hV=c.join(""),this.hV},"undefined"!=typeof c&&"undefined"!=typeof c.sortflag&&0==c.sortflag&&(this.sortFlag=!1)},extendClass(tt.asn1.DERSet,tt.asn1.DERAbstractStructured),tt.asn1.DERTaggedObject=function(c){tt.asn1.DERTaggedObject.superclass.constructor.call(this);var p=tt.asn1,v=nt,x=v.getV,E=(v.isASN1HEX,p.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(c,p,v){this.params={tag:p,explicit:c,obj:v}},this.getFreshValueHex=function(){var c=this.params;if(void 0==c.explicit&&(c.explicit=!0),void 0!=c.tage&&(c.tag=c.tage,c.explicit=!0),void 0!=c.tagi&&(c.tag=c.tagi,c.explicit=!1),void 0!=c.str)this.hV=utf8tohex(c.str);else if(void 0!=c.hex)this.hV=c.hex;else{if(void 0==c.obj)throw new Error("str, hex nor obj not specified");var v;c.obj instanceof p.ASN1Object?v=c.obj.tohex():"object"==typeof c.obj&&(v=E(c.obj).tohex()),c.explicit?this.hV=v:this.hV=x(v,0)}return void 0==c.tag&&(c.tag="a0"),this.hT=c.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.DERTaggedObject,tt.asn1.ASN1Object);var tt,et,rt,nt=new function(){};function stoBA(c){for(var p=new Array,v=0;v<c.length;v++)p[v]=c.charCodeAt(v);return p}function BAtos(c){for(var p="",v=0;v<c.length;v++)String.fromCharCode(c[v]);return p}function BAtohex(c){for(var p="",v=0;v<c.length;v++){var x=c[v].toString(16);1==x.length&&(x="0"+x),p+=x}return p}function stohex(c){return BAtohex(stoBA(c))}function b64tob64u(c){return c=(c=(c=c.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function b64utob64(c){return c.length%4==2?c+="==":c.length%4==3&&(c+="="),c=(c=c.replace(/-/g,"+")).replace(/_/g,"/")}function hextob64u(c){return c.length%2==1&&(c="0"+c),b64tob64u(hex2b64(c))}function b64utohex(c){return b64tohex(b64utob64(c))}function utf8tohex(c){return uricmptohex(encodeURIComponentAll(c)).toLowerCase()}function hextoutf8(c){try{return decodeURIComponent(hextouricmp(c))}catch(p){return null}}function iso88591hextoutf8(c){return hextoutf8(function iso88591hextoutf8hex(c){for(var p=c.match(/.{1,2}/g),v=[],x=0;x<p.length;x++){var E=parseInt(p[x],16);161<=E&&E<=191?(v.push("c2"),v.push(p[x])):192<=E&&E<=255?(v.push("c3"),v.push((E-64).toString(16))):v.push(p[x])}return v.join("")}(c))}function hextorstr(c){for(var p="",v=0;v<c.length-1;v+=2)p+=String.fromCharCode(parseInt(c.substr(v,2),16));return p}function rstrtohex(c){for(var p="",v=0;v<c.length;v++)p+=("0"+c.charCodeAt(v).toString(16)).slice(-2);return p}function hextob64(c){return hex2b64(c)}function foldnl(c,p){return c=(c=c.replace(new RegExp("(.{"+p+"})","g"),"$1\r\n")).replace(/\s+$/,"")}function b64nltohex(c){return b64tohex(c.replace(/[^0-9A-Za-z\/+=]*/g,""))}function hextopem(c,p){return"-----BEGIN "+p+"-----\r\n"+foldnl(hextob64(c),64)+"\r\n-----END "+p+"-----\r\n"}function pemtohex(c,p){if(-1==c.indexOf("-----BEGIN "))throw new Error("can't find PEM header");return b64nltohex(c=void 0!==p?(c=c.replace(new RegExp("^[^]*-----BEGIN "+p+"-----"),"")).replace(new RegExp("-----END "+p+"-----[^]*$"),""):(c=c.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function zulutomsec(c){var p,v,x,E,F,C,P,R,B,T;if(T=(c=timetogen(c)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return p=parseInt(T[1]),v=parseInt(T[2])-1,x=parseInt(T[3]),E=parseInt(T[4]),F=parseInt(T[5]),C=parseInt(T[6]),P=0,""!==(R=T[7])&&(B=(R.substr(1)+"00").substr(0,3),P=parseInt(B)),Date.UTC(p,v,x,E,F,C,P);throw new Error("unsupported zulu format: "+c)}function zulutosec(c){return Math.round(zulutomsec(c)/1e3)}function timetogen(c){return c.match(/^[0-9]{12}Z$/)||c.match(/^[0-9]{12}[.][0-9]*Z$/)?c.match(/^[0-4]/)?"20"+c:"19"+c:c}function uricmptohex(c){return c.replace(/%/g,"")}function hextouricmp(c){return c.replace(/(..)/g,"%$1")}function ipv6tohex(c){var p="malformed IPv6 address";if(!c.match(/^[0-9A-Fa-f:]+$/))throw p;var v=(c=c.toLowerCase()).split(":").length-1;if(v<2)throw p;var x=":".repeat(7-v+2),E=(c=c.replace("::",x)).split(":");if(8!=E.length)throw p;for(var F=0;F<8;F++)E[F]=("0000"+E[F]).slice(-4);return E.join("")}function hextoipv6(c){if(!c.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+c);var p=(c=c.toLowerCase()).match(/.{1,4}/g),v=(c=":"+(p=(p=p.map((function(c){return c.replace(/^0+/,"")}))).map((function(c){return""==c?"0":c}))).join(":")+":").match(/:(0:){2,}/g);if(null==v)return c.slice(1,-1);var x=v.sort().slice(-1)[0];return"::"!=(c=c.replace(x.substr(0,x.length-1),":")).substr(0,2)&&(c=c.substr(1)),"::"!=c.substr(-2,2)&&(c=c.substr(0,c.length-1)),c}function hextoip(c){var p=new Error("malformed hex value");if(!c.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw p;if(8==c.length){try{return parseInt(c.substr(0,2),16)+"."+parseInt(c.substr(2,2),16)+"."+parseInt(c.substr(4,2),16)+"."+parseInt(c.substr(6,2),16)}catch(v){throw p}}else{if(16!=c.length){if(32==c.length)return hextoipv6(c);if(64==c.length){try{return hextoipv6(c.substr(0,32))+"/"+ipprefixlen(c.substr(32))}catch(v){throw p}return}return c}try{return hextoip(c.substr(0,8))+"/"+ipprefixlen(c.substr(8))}catch(v){throw p}}}function ipprefixlen(c){var p,v=new Error("malformed mask");try{p=new BigInteger(c,16).toString(2)}catch(x){throw v}if(!p.match(/^1*0*$/))throw v;return p.replace(/0+$/,"").length}function iptohex(c){var p=new Error("malformed IP address");if(!(c=c.toLowerCase(c)).match(/^[0-9a-f.:/]+$/))throw p;if(!c.match(/^[0-9.]+$/)){var v;if(c.match(/^[0-9.]+\/[0-9]+$/))return iptohex((v=c.split("/"))[0])+ipnetmask(parseInt(v[1]),32);if(c.match(/^[0-9a-f:]+$/)&&-1!==c.indexOf(":"))return ipv6tohex(c);if(c.match(/^[0-9a-f:]+\/[0-9]+$/)&&-1!==c.indexOf(":"))return ipv6tohex((v=c.split("/"))[0])+ipnetmask(parseInt(v[1]),128);throw p}var x=c.split(".");if(4!==x.length)throw p;var E="";try{for(var F=0;F<4;F++){E+=("0"+parseInt(x[F]).toString(16)).slice(-2)}return E}catch(C){throw p}}function ipnetmask(c,p){return 32==p&&0==c?"00000000":128==p&&0==c?"00000000000000000000000000000000":new BigInteger(Array(c+1).join("1")+Array(p-c+1).join("0"),2).toString(16)}function ucs2hextoutf8(c){return c.match(/.{4}/g).map((function e(c){var p=parseInt(c.substr(0,2),16),v=parseInt(c.substr(2),16);if(0==p&v<128)return String.fromCharCode(v);if(p<8){var x=128|63&v;return hextoutf8((192|(7&p)<<3|(192&v)>>6).toString(16)+x.toString(16))}x=128|(15&p)<<2|(192&v)>>6;var E=128|63&v;return hextoutf8((224|(240&p)>>4).toString(16)+x.toString(16)+E.toString(16))})).join("")}function encodeURIComponentAll(c){for(var p=encodeURIComponent(c),v="",x=0;x<p.length;x++)"%"==p[x]?(v+=p.substr(x,3),x+=2):v=v+"%"+stohex(p[x]);return v}function ishex(c){return!(c.length%2!=0||!c.match(/^[0-9a-f]+$/)&&!c.match(/^[0-9A-F]+$/))}function isBase64URLDot(c){return!!c.match(/^[0-9A-Za-z-_.]+$/)}function hextoposhex(c){return c.length%2==1?"0"+c:c.substr(0,1)>"7"?"00"+c:c}nt.getLblen=function(c,p){if("8"!=c.substr(p+2,1))return 1;var v=parseInt(c.substr(p+3,1));return 0==v?-1:0<v&&v<10?v+1:-2},nt.getL=function(c,p){var v=nt.getLblen(c,p);return v<1?"":c.substr(p+2,2*v)},nt.getVblen=function(c,p){var v;return""==(v=nt.getL(c,p))?-1:("8"===v.substr(0,1)?new BigInteger(v.substr(2),16):new BigInteger(v,16)).intValue()},nt.getVidx=function(c,p){var v=nt.getLblen(c,p);return v<0?v:p+2*(v+1)},nt.getV=function(c,p){var v=nt.getVidx(c,p),x=nt.getVblen(c,p);return c.substr(v,2*x)},nt.getTLV=function(c,p){return c.substr(p,2)+nt.getL(c,p)+nt.getV(c,p)},nt.getTLVblen=function(c,p){return 2+2*nt.getLblen(c,p)+2*nt.getVblen(c,p)},nt.getNextSiblingIdx=function(c,p){return nt.getVidx(c,p)+2*nt.getVblen(c,p)},nt.getChildIdx=function(c,p){var v,x,E,F=nt,C=[];v=F.getVidx(c,p),x=2*F.getVblen(c,p),"03"==c.substr(p,2)&&(v+=2,x-=2),E=0;for(var P=v;E<=x;){var R=F.getTLVblen(c,P);if((E+=R)<=x&&C.push(P),P+=R,E>=x)break}return C},nt.getNthChildIdx=function(c,p,v){return nt.getChildIdx(c,p)[v]},nt.getIdxbyList=function(c,p,v,x){var E,F,C=nt;return 0==v.length?void 0!==x&&c.substr(p,2)!==x?-1:p:(E=v.shift())>=(F=C.getChildIdx(c,p)).length?-1:C.getIdxbyList(c,F[E],v,x)},nt.getIdxbyListEx=function(c,p,v,x){var E,F,C=nt;if(0==v.length)return void 0!==x&&c.substr(p,2)!==x?-1:p;E=v.shift(),F=C.getChildIdx(c,p);for(var P=0,R=0;R<F.length;R++){var B=c.substr(F[R],2);if("number"==typeof E&&!C.isContextTag(B)&&P==E||"string"==typeof E&&C.isContextTag(B,E))return C.getIdxbyListEx(c,F[R],v,x);C.isContextTag(B)||P++}return-1},nt.getTLVbyList=function(c,p,v,x){var E=nt,F=E.getIdxbyList(c,p,v,x);return-1==F||F>=c.length?null:E.getTLV(c,F)},nt.getTLVbyListEx=function(c,p,v,x){var E=nt,F=E.getIdxbyListEx(c,p,v,x);return-1==F?null:E.getTLV(c,F)},nt.getVbyList=function(c,p,v,x,E){var F,C,P=nt;return-1==(F=P.getIdxbyList(c,p,v,x))||F>=c.length?null:(C=P.getV(c,F),!0===E&&(C=C.substr(2)),C)},nt.getVbyListEx=function(c,p,v,x,E){var F,C,P=nt;return-1==(F=P.getIdxbyListEx(c,p,v,x))?null:(C=P.getV(c,F),"03"==c.substr(F,2)&&!1!==E&&(C=C.substr(2)),C)},nt.getInt=function(c,p,v){void 0==v&&(v=-1);try{var x=c.substr(p,2);if("02"!=x&&"03"!=x)return v;var E=nt.getV(c,p);return"02"==x?parseInt(E,16):bitstrtoint(E)}catch(F){return v}},nt.getOID=function(c,p,v){void 0==v&&(v=null);try{return"06"!=c.substr(p,2)?v:hextooid(nt.getV(c,p))}catch(x){return v}},nt.getOIDName=function(c,p,v){void 0==v&&(v=null);try{var x=nt.getOID(c,p,v);if(x==v)return v;var E=tt.asn1.x509.OID.oid2name(x);return""==E?x:E}catch(F){return v}},nt.getString=function(c,p,v){void 0==v&&(v=null);try{return hextorstr(nt.getV(c,p))}catch(x){return v}},nt.hextooidstr=function(c){var h=function(c,p){return c.length>=p?c:new Array(p-c.length+1).join("0")+c},p=[],v=c.substr(0,2),x=parseInt(v,16);p[0]=new String(Math.floor(x/40)),p[1]=new String(x%40);for(var E=c.substr(2),F=[],C=0;C<E.length/2;C++)F.push(parseInt(E.substr(2*C,2),16));var P=[],R="";for(C=0;C<F.length;C++)128&F[C]?R+=h((127&F[C]).toString(2),7):(R+=h((127&F[C]).toString(2),7),P.push(new String(parseInt(R,2))),R="");var B=p.join(".");return P.length>0&&(B=B+"."+P.join(".")),B},nt.dump=function(c,p,v,x){var E=nt,F=E.getV,C=E.dump,P=E.getChildIdx,R=c;c instanceof tt.asn1.ASN1Object&&(R=c.tohex());var q=function(c,p){return c.length<=2*p?c:c.substr(0,p)+"..(total "+c.length/2+"bytes).."+c.substr(c.length-p,p)};void 0===p&&(p={ommit_long_octet:32}),void 0===v&&(v=0),void 0===x&&(x="");var B,T=p.ommit_long_octet;if("01"==(B=R.substr(v,2)))return"00"==(N=F(R,v))?x+"BOOLEAN FALSE\n":x+"BOOLEAN TRUE\n";if("02"==B)return x+"INTEGER "+q(N=F(R,v),T)+"\n";if("03"==B){var N=F(R,v);if(E.isASN1HEX(N.substr(2))){var _=x+"BITSTRING, encapsulates\n";return _+=C(N.substr(2),p,0,x+"  ")}return x+"BITSTRING "+q(N,T)+"\n"}if("04"==B){N=F(R,v);if(E.isASN1HEX(N)){_=x+"OCTETSTRING, encapsulates\n";return _+=C(N,p,0,x+"  ")}return x+"OCTETSTRING "+q(N,T)+"\n"}if("05"==B)return x+"NULL\n";if("06"==B){var L=F(R,v),V=tt.asn1.ASN1Util.oidHexToInt(L),U=tt.asn1.x509.OID.oid2name(V),W=V.replace(/\./g," ");return""!=U?x+"ObjectIdentifier "+U+" ("+W+")\n":x+"ObjectIdentifier ("+W+")\n"}if("0a"==B)return x+"ENUMERATED "+parseInt(F(R,v))+"\n";if("0c"==B)return x+"UTF8String '"+hextoutf8(F(R,v))+"'\n";if("13"==B)return x+"PrintableString '"+hextoutf8(F(R,v))+"'\n";if("14"==B)return x+"TeletexString '"+hextoutf8(F(R,v))+"'\n";if("16"==B)return x+"IA5String '"+hextoutf8(F(R,v))+"'\n";if("17"==B)return x+"UTCTime "+hextoutf8(F(R,v))+"\n";if("18"==B)return x+"GeneralizedTime "+hextoutf8(F(R,v))+"\n";if("1a"==B)return x+"VisualString '"+hextoutf8(F(R,v))+"'\n";if("1e"==B)return x+"BMPString '"+ucs2hextoutf8(F(R,v))+"'\n";if("30"==B){if("3000"==R.substr(v,4))return x+"SEQUENCE {}\n";_=x+"SEQUENCE\n";var G=p;if((2==(Z=P(R,v)).length||3==Z.length)&&"06"==R.substr(Z[0],2)&&"04"==R.substr(Z[Z.length-1],2)){U=E.oidname(F(R,Z[0]));var X=JSON.parse(JSON.stringify(p));X.x509ExtName=U,G=X}for(var J=0;J<Z.length;J++)_+=C(R,G,Z[J],x+"  ");return _}if("31"==B){_=x+"SET\n";var Z=P(R,v);for(J=0;J<Z.length;J++)_+=C(R,p,Z[J],x+"  ");return _}if(0!=(128&(B=parseInt(B,16)))){var Y=31&B;if(0!=(32&B)){for(_=x+"["+Y+"]\n",Z=P(R,v),J=0;J<Z.length;J++)_+=C(R,p,Z[J],x+"  ");return _}N=F(R,v);if(nt.isASN1HEX(N)){var _=x+"["+Y+"]\n";return _+=C(N,p,0,x+"  ")}return("68747470"==N.substr(0,8)||"subjectAltName"===p.x509ExtName&&2==Y)&&(N=hextoutf8(N)),_=x+"["+Y+"] "+N+"\n"}return x+"UNKNOWN("+B+") "+F(R,v)+"\n"},nt.parse=function(c){var p=nt,v=p.parse,x=p.isASN1HEX,E=p.getV,F=p.getTLV,C=p.getChildIdx,P=tt.asn1,R=P.ASN1Util.oidHexToInt,B=P.x509.OID.oid2name,T=hextoutf8,N=ucs2hextoutf8,_=iso88591hextoutf8,L={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},V=c.substr(0,2),U={},W=E(c,0);if("01"==V)return"0101ff"==c?{bool:!0}:{bool:!1};if("02"==V)return{int:{hex:W}};if("03"==V)try{if("00"!=W.substr(0,2))throw"not encap";var G=W.substr(2);if(!x(G))throw"not encap";return{bitstr:{obj:v(G)}}}catch(Y){var X=null;return W.length<=10&&(X=bitstrtobinstr(W)),null==X?{bitstr:{hex:W}}:{bitstr:{bin:X}}}else if("04"==V)try{if(!x(W))throw"not encap";return{octstr:{obj:v(W)}}}catch(Y){return{octstr:{hex:W}}}else{if("05"==V)return{null:""};if("06"==V){var J=R(W),Z=B(J);return""==Z?{oid:J}:{oid:Z}}if("0a"==V)return W.length>4?{enum:{hex:W}}:{enum:parseInt(W,16)};if("30"==V||"31"==V)return U[L[V]]=function(c){for(var p=[],x=C(c,0),E=0;E<x.length;E++){var P=x[E],R=F(c,P),B=v(R);p.push(B)}return p}(c),U;if("14"==V){var Q=_(W);return U[L[V]]={str:Q},U}if("1e"==V){Q=N(W);return U[L[V]]={str:Q},U}if(-1!=":0c:12:13:16:17:18:1a:".indexOf(V)){Q=T(W);return U[L[V]]={str:Q},U}if(V.match(/^8[0-9]$/))return null==(Q=T(W))|""==Q||null!=Q.match(/[\x00-\x1F\x7F-\x9F]/)||null!=Q.match(/[\u0000-\u001F\u0080\u2013\u009F]/)?{tag:{tag:V,explicit:!1,hex:W}}:{tag:{tag:V,explicit:!1,str:Q}};if(!V.match(/^a[0-9]$/)){var et=new tt.asn1.ASN1Object;return et.hV=W,{asn1:{tlv:V+et.getLengthHexFromValue()+W}}}try{if(!x(W))throw new Error("not encap");return{tag:{tag:V,explicit:!0,obj:v(W)}}}catch(Y){return{tag:{tag:V,explicit:!0,hex:W}}}}},nt.isContextTag=function(c,p){var v,x;c=c.toLowerCase();try{v=parseInt(c,16)}catch(E){return-1}if(void 0===p)return 128==(192&v);try{return null!=p.match(/^\[[0-9]+\]$/)&&(!((x=parseInt(p.substr(1,p.length-1),10))>31)&&(128==(192&v)&&(31&v)==x))}catch(E){return!1}},nt.isASN1HEX=function(c){var p=nt;if(c.length%2==1)return!1;var v=p.getVblen(c,0),x=c.substr(0,2),E=p.getL(c,0);return c.length-x.length-E.length==2*v},nt.checkStrictDER=function(c,p,v,x,E){var F=nt;if(void 0===v){if("string"!=typeof c)throw new Error("not hex string");if(c=c.toLowerCase(),!tt.lang.String.isHex(c))throw new Error("not hex string");v=c.length,E=(x=c.length/2)<128?1:Math.ceil(x.toString(16))+1}if(F.getL(c,p).length>2*E)throw new Error("L of TLV too long: idx="+p);var C=F.getVblen(c,p);if(C>x)throw new Error("value of L too long than hex: idx="+p);var P=F.getTLV(c,p),R=P.length-2-F.getL(c,p).length;if(R!==2*C)throw new Error("V string length and L's value not the same:"+R+"/"+2*C);if(0===p&&c.length!=P.length)throw new Error("total length and TLV length unmatch:"+c.length+"!="+P.length);var B=c.substr(p,2);if("02"===B){var T=F.getVidx(c,p);if("00"==c.substr(T,2)&&c.charCodeAt(T+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(B,16)){for(var N=F.getVblen(c,p),_=0,L=F.getChildIdx(c,p),V=0;V<L.length;V++){_+=F.getTLV(c,L[V]).length,F.checkStrictDER(c,L[V],v,x,E)}if(2*N!=_)throw new Error("sum of children's TLV length and L unmatch: "+2*N+"!="+_)}},nt.oidname=function(c){var p=tt.asn1;tt.lang.String.isHex(c)&&(c=p.ASN1Util.oidHexToInt(c));var v=p.x509.OID.oid2name(c);return""===v&&(v=c),v},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),"undefined"!=typeof tt.asn1.x509&&tt.asn1.x509||(tt.asn1.x509={}),tt.asn1.x509.Certificate=function(c){tt.asn1.x509.Certificate.superclass.constructor.call(this);var p=tt.asn1,v=p.DERBitString,x=p.DERSequence,E=p.x509,F=E.TBSCertificate,C=E.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,p=c.sigalg;void 0!=c.sigalg.name&&(p=c.sigalg.name);var v=c.tbsobj.tohex(),x=new tt.crypto.Signature({alg:p});x.init(c.cakey),x.updateHex(v),c.sighex=x.sign()},this.getPEM=function(){return hextopem(this.tohex(),"CERTIFICATE")},this.tohex=function(){var c=this.params;if(void 0!=c.tbsobj&&null!=c.tbsobj||(c.tbsobj=new F(c)),void 0==c.sighex&&void 0!=c.cakey&&this.sign(),void 0==c.sighex)throw new Error("sighex or cakey parameter not defined");var p=[];return p.push(c.tbsobj),p.push(new C({name:c.sigalg})),p.push(new v({hex:"00"+c.sighex})),new x({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.Certificate,tt.asn1.ASN1Object),tt.asn1.x509.TBSCertificate=function(c){tt.asn1.x509.TBSCertificate.superclass.constructor.call(this);var p=tt.asn1,v=p.x509,x=p.DERTaggedObject,E=p.DERInteger,F=p.DERSequence,C=v.AlgorithmIdentifier,P=v.Time,R=v.X500Name,B=v.Extensions,T=v.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=[],p=this.params;if(void 0!=p.version||1!=p.version){var v=2;void 0!=p.version&&(v=p.version-1);var N=new x({obj:new E({int:v})});c.push(N)}return c.push(new E(p.serial)),c.push(new C({name:p.sigalg})),c.push(new R(p.issuer)),c.push(new F({array:[new P(p.notbefore),new P(p.notafter)]})),c.push(new R(p.subject)),c.push(new T(it.getKey(p.sbjpubkey))),void 0!==p.ext&&p.ext.length>0&&c.push(new x({tag:"a3",obj:new B(p.ext)})),new tt.asn1.DERSequence({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.TBSCertificate,tt.asn1.ASN1Object),tt.asn1.x509.Extensions=function(c){tt.asn1.x509.Extensions.superclass.constructor.call(this);var p=tt.asn1,v=p.DERSequence,x=p.x509;this.aParam=[],this.setByParam=function(c){this.aParam=c},this.tohex=function(){for(var c=[],p=0;p<this.aParam.length;p++){var E=this.aParam[p],F=E.extname,C=null;if(void 0!=E.extn)C=new x.PrivateExtension(E);else if("subjectKeyIdentifier"==F)C=new x.SubjectKeyIdentifier(E);else if("keyUsage"==F)C=new x.KeyUsage(E);else if("subjectAltName"==F)C=new x.SubjectAltName(E);else if("issuerAltName"==F)C=new x.IssuerAltName(E);else if("basicConstraints"==F)C=new x.BasicConstraints(E);else if("nameConstraints"==F)C=new x.NameConstraints(E);else if("cRLDistributionPoints"==F)C=new x.CRLDistributionPoints(E);else if("certificatePolicies"==F)C=new x.CertificatePolicies(E);else if("policyMappings"==F)C=new x.PolicyMappings(E);else if("policyConstraints"==F)C=new x.PolicyConstraints(E);else if("inhibitAnyPolicy"==F)C=new x.InhibitAnyPolicy(E);else if("authorityKeyIdentifier"==F)C=new x.AuthorityKeyIdentifier(E);else if("extKeyUsage"==F)C=new x.ExtKeyUsage(E);else if("authorityInfoAccess"==F)C=new x.AuthorityInfoAccess(E);else if("cRLNumber"==F)C=new x.CRLNumber(E);else if("cRLReason"==F)C=new x.CRLReason(E);else if("ocspNonce"==F)C=new x.OCSPNonce(E);else if("ocspNoCheck"==F)C=new x.OCSPNoCheck(E);else if("adobeTimeStamp"==F)C=new x.AdobeTimeStamp(E);else{if("subjectDirectoryAttributes"!=F)throw new Error("extension not supported:"+JSON.stringify(E));C=new x.SubjectDirectoryAttributes(E)}null!=C&&c.push(C)}return new v({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.x509.Extensions,tt.asn1.ASN1Object),tt.asn1.x509.Extension=function(c){tt.asn1.x509.Extension.superclass.constructor.call(this);var p=tt.asn1,v=p.DERObjectIdentifier,x=p.DEROctetString,E=(p.DERBitString,p.DERBoolean),F=p.DERSequence;this.tohex=function(){var c=new v({oid:this.oid}),p=new x({hex:this.getExtnValueHex()}),C=new Array;return C.push(c),this.critical&&C.push(new E),C.push(p),new F({array:C}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,void 0!==c&&void 0!==c.critical&&(this.critical=c.critical)},extendClass(tt.asn1.x509.Extension,tt.asn1.ASN1Object),tt.asn1.x509.KeyUsage=function(c){tt.asn1.x509.KeyUsage.superclass.constructor.call(this,c);var p=Error,v={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var c=this.getBinValue();return this.asn1ExtnValue=new tt.asn1.DERBitString({bin:c}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var c=this.params;if("object"!=typeof c||"object"!=typeof c.names&&"string"!=typeof c.bin)throw new p("parameter not yet set");if(void 0!=c.names)return namearraytobinstr(c.names,v);if(void 0!=c.bin)return c.bin;throw new p("parameter not set properly")},this.oid="2.5.29.15",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.KeyUsage,tt.asn1.x509.Extension),tt.asn1.x509.BasicConstraints=function(c){tt.asn1.x509.BasicConstraints.superclass.constructor.call(this,c);var p=tt.asn1,v=p.DERBoolean,x=p.DERInteger,E=p.DERSequence;this.getExtnValueHex=function(){var c=new Array;this.cA&&c.push(new v),this.pathLen>-1&&c.push(new x({int:this.pathLen}));var p=new E({array:c});return this.asn1ExtnValue=p,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==c&&(void 0!==c.cA&&(this.cA=c.cA),void 0!==c.pathLen&&(this.pathLen=c.pathLen))},extendClass(tt.asn1.x509.BasicConstraints,tt.asn1.x509.Extension),tt.asn1.x509.CRLDistributionPoints=function(c){tt.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,c);var p=tt.asn1,v=p.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(c){for(var x=[],E=0;E<c.length;E++)if(c[E]instanceof tt.asn1.ASN1Object)x.push(c[E]);else{var F=new v.DistributionPoint(c[E]);x.push(F)}this.asn1ExtnValue=new p.DERSequence({array:x})},this.setByOneURI=function(c){var p=new v.DistributionPoint({fulluri:c});this.setByDPArray([p])},this.oid="2.5.29.31",void 0!==c&&(void 0!==c.array?this.setByDPArray(c.array):void 0!==c.uri&&this.setByOneURI(c.uri))},extendClass(tt.asn1.x509.CRLDistributionPoints,tt.asn1.x509.Extension),tt.asn1.x509.DistributionPoint=function(c){tt.asn1.x509.DistributionPoint.superclass.constructor.call(this);var p=tt.asn1,v=p.x509.DistributionPointName;this.tohex=function(){var c=new p.DERSequence;if(null!=this.asn1DP){var v=new p.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});c.appendASN1Object(v)}return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(void 0!==c.dpobj?this.asn1DP=c.dpobj:void 0!==c.dpname?this.asn1DP=new v(c.dpname):void 0!==c.fulluri&&(this.asn1DP=new v({full:[{uri:c.fulluri}]})))},extendClass(tt.asn1.x509.DistributionPoint,tt.asn1.ASN1Object),tt.asn1.x509.DistributionPointName=function(c){tt.asn1.x509.DistributionPointName.superclass.constructor.call(this);var p=tt.asn1,v=p.DERTaggedObject;if(this.tohex=function(){if("full"!=this.type)throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new v({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c)if(p.x509.GeneralNames.prototype.isPrototypeOf(c))this.type="full",this.tag="a0",this.asn1V=c;else{if(void 0===c.full)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new p.x509.GeneralNames(c.full)}},extendClass(tt.asn1.x509.DistributionPointName,tt.asn1.ASN1Object),tt.asn1.x509.CertificatePolicies=function(c){tt.asn1.x509.CertificatePolicies.superclass.constructor.call(this,c);var p=tt.asn1,v=p.x509,x=p.DERSequence,E=v.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var c=[],p=0;p<this.params.array.length;p++)c.push(new E(this.params.array[p]));var v=new x({array:c});return this.asn1ExtnValue=v,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.CertificatePolicies,tt.asn1.x509.Extension),tt.asn1.x509.PolicyInformation=function(c){tt.asn1.x509.PolicyInformation.superclass.constructor.call(this,c);var p=tt.asn1,v=p.DERSequence,x=p.DERObjectIdentifier,E=p.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var c=[new x(this.params.policyoid)];if(void 0!==this.params.array){for(var p=[],F=0;F<this.params.array.length;F++)p.push(new E(this.params.array[F]));p.length>0&&c.push(new v({array:p}))}return new v({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.PolicyInformation,tt.asn1.ASN1Object),tt.asn1.x509.PolicyQualifierInfo=function(c){tt.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,c);var p=tt.asn1,v=p.DERSequence,x=p.DERIA5String,E=p.DERObjectIdentifier,F=p.x509.UserNotice;this.params=null,this.tohex=function(){return void 0!==this.params.cps?new v({array:[new E({oid:"1.3.6.1.5.5.7.2.1"}),new x({str:this.params.cps})]}).tohex():void 0!=this.params.unotice?new v({array:[new E({oid:"1.3.6.1.5.5.7.2.2"}),new F(this.params.unotice)]}).tohex():void 0},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.PolicyQualifierInfo,tt.asn1.ASN1Object),tt.asn1.x509.UserNotice=function(c){tt.asn1.x509.UserNotice.superclass.constructor.call(this,c);var p=tt.asn1.DERSequence,v=(tt.asn1.DERInteger,tt.asn1.x509.DisplayText),x=tt.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var c=[];return void 0!==this.params.noticeref&&c.push(new x(this.params.noticeref)),void 0!==this.params.exptext&&c.push(new v(this.params.exptext)),new p({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.UserNotice,tt.asn1.ASN1Object),tt.asn1.x509.NoticeReference=function(c){tt.asn1.x509.NoticeReference.superclass.constructor.call(this,c);var p=tt.asn1.DERSequence,v=tt.asn1.DERInteger,x=tt.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var c=[];if(void 0!==this.params.org&&c.push(new x(this.params.org)),void 0!==this.params.noticenum){for(var E=[],F=this.params.noticenum,C=0;C<F.length;C++)E.push(new v(F[C]));c.push(new p({array:E}))}if(0==c.length)throw new Error("parameter is empty");return new p({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.NoticeReference,tt.asn1.ASN1Object),tt.asn1.x509.DisplayText=function(c){tt.asn1.x509.DisplayText.superclass.constructor.call(this,c),this.hT="0c",void 0!==c&&("ia5"===c.type?this.hT="16":"vis"===c.type?this.hT="1a":"bmp"===c.type&&(this.hT="1e"))},extendClass(tt.asn1.x509.DisplayText,tt.asn1.DERAbstractString),tt.asn1.x509.PolicyMappings=function(c){tt.asn1.x509.PolicyMappings.superclass.constructor.call(this,c);var p=tt.asn1,v=(p.x509,p.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var c=this.params,p=[],x=0;x<c.array.length;x++){var E=c.array[x];p.push({seq:[{oid:E[0]},{oid:E[1]}]})}return this.asn1ExtnValue=v({seq:p}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.PolicyMappings,tt.asn1.x509.Extension),tt.asn1.x509.PolicyConstraints=function(c){tt.asn1.x509.PolicyConstraints.superclass.constructor.call(this,c);var p=tt.asn1,v=(p.x509,p.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var c=this.params,p=[];return void 0!=c.reqexp&&p.push({tag:{tagi:"80",obj:{int:c.reqexp}}}),void 0!=c.inhibit&&p.push({tag:{tagi:"81",obj:{int:c.inhibit}}}),this.asn1ExtnValue=v({seq:p}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.PolicyConstraints,tt.asn1.x509.Extension),tt.asn1.x509.InhibitAnyPolicy=function(c){tt.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,c);var p=tt.asn1,v=(p.x509,p.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=v({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.InhibitAnyPolicy,tt.asn1.x509.Extension),tt.asn1.x509.NameConstraints=function(c){tt.asn1.x509.NameConstraints.superclass.constructor.call(this,c);var p=tt.asn1,v=p.x509,x=p.ASN1Util.newObject,E=v.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var c=this.params,p=[];if(void 0!=c.permit&&void 0!=c.permit.length){for(var v=[],F=0;F<c.permit.length;F++)v.push(new E(c.permit[F]));p.push({tag:{tagi:"a0",obj:{seq:v}}})}if(void 0!=c.exclude&&void 0!=c.exclude.length){var C=[];for(F=0;F<c.exclude.length;F++)C.push(new E(c.exclude[F]));p.push({tag:{tagi:"a1",obj:{seq:C}}})}return this.asn1ExtnValue=x({seq:p}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.NameConstraints,tt.asn1.x509.Extension),tt.asn1.x509.GeneralSubtree=function(c){tt.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var p=tt.asn1,v=p.x509.GeneralName,x=p.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params,p=[new v(c)];return void 0!=c.min&&p.push({tag:{tagi:"80",obj:{int:c.min}}}),void 0!=c.max&&p.push({tag:{tagi:"81",obj:{int:c.max}}}),x({seq:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.GeneralSubtree,tt.asn1.ASN1Object),tt.asn1.x509.ExtKeyUsage=function(c){tt.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,c);var p=tt.asn1;this.setPurposeArray=function(c){this.asn1ExtnValue=new p.DERSequence;for(var v=0;v<c.length;v++){var x=new p.DERObjectIdentifier(c[v]);this.asn1ExtnValue.appendASN1Object(x)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",void 0!==c&&void 0!==c.array&&this.setPurposeArray(c.array)},extendClass(tt.asn1.x509.ExtKeyUsage,tt.asn1.x509.Extension),tt.asn1.x509.AuthorityKeyIdentifier=function(c){tt.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,c);var p=tt,v=p.asn1,x=v.DERTaggedObject,E=v.x509.GeneralNames;p.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var c=new Array;this.asn1KID&&c.push(new x({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&c.push(new x({explicit:!1,tag:"a1",obj:new E([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&c.push(new x({explicit:!1,tag:"82",obj:this.asn1CertSN}));var p=new v.DERSequence({array:c});return this.asn1ExtnValue=p,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(c){if(void 0!==c.str||void 0!==c.hex)this.asn1KID=new tt.asn1.DEROctetString(c);else if("object"===typeof c&&tt.crypto.Util.isKey(c)||"string"===typeof c&&-1!=c.indexOf("BEGIN ")){var p=c;"string"===typeof c&&(p=it.getKey(c));var v=it.getKeyID(p);this.asn1KID=new tt.asn1.DEROctetString({hex:v})}},this.setCertIssuerByParam=function(c){void 0!==c.str||void 0!==c.ldapstr||void 0!==c.hex||void 0!==c.certsubject||void 0!==c.certissuer?this.asn1CertIssuer=new tt.asn1.x509.X500Name(c):"string"===typeof c&&-1!=c.indexOf("BEGIN ")&&-1!=c.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new tt.asn1.x509.X500Name({certissuer:c}))},this.setCertSNByParam=function(c){if(void 0!==c.str||void 0!==c.bigint||void 0!==c.hex)this.asn1CertSN=new tt.asn1.DERInteger(c);else if("string"===typeof c&&-1!=c.indexOf("BEGIN ")&&c.indexOf("CERTIFICATE")){var p=new X509;p.readCertPEM(c);var v=p.getSerialNumberHex();this.asn1CertSN=new tt.asn1.DERInteger({hex:v})}},this.oid="2.5.29.35",void 0!==c&&(void 0!==c.kid&&this.setKIDByParam(c.kid),void 0!==c.issuer&&this.setCertIssuerByParam(c.issuer),void 0!==c.sn&&this.setCertSNByParam(c.sn),void 0!==c.issuersn&&"string"===typeof c.issuersn&&-1!=c.issuersn.indexOf("BEGIN ")&&c.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(c.issuersn),this.setCertIssuerByParam(c.issuersn)))},extendClass(tt.asn1.x509.AuthorityKeyIdentifier,tt.asn1.x509.Extension),tt.asn1.x509.SubjectKeyIdentifier=function(c){tt.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,c);var p=tt.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(c){if(void 0!==c.str||void 0!==c.hex)this.asn1KID=new p(c);else if("object"===typeof c&&tt.crypto.Util.isKey(c)||"string"===typeof c&&-1!=c.indexOf("BEGIN")){var v=c;"string"===typeof c&&(v=it.getKey(c));var x=it.getKeyID(v);this.asn1KID=new tt.asn1.DEROctetString({hex:x})}},this.oid="2.5.29.14",void 0!==c&&void 0!==c.kid&&this.setKIDByParam(c.kid)},extendClass(tt.asn1.x509.SubjectKeyIdentifier,tt.asn1.x509.Extension),tt.asn1.x509.AuthorityInfoAccess=function(c){tt.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,c),this.setAccessDescriptionArray=function(c){for(var p=new Array,v=tt.asn1,x=v.DERSequence,E=v.DERObjectIdentifier,F=v.x509.GeneralName,C=0;C<c.length;C++){var P,R=c[C];if(void 0!==R.ocsp)P=new x({array:[new E({oid:"1.3.6.1.5.5.7.48.1"}),new F({uri:R.ocsp})]});else{if(void 0===R.caissuer)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(R));P=new x({array:[new E({oid:"1.3.6.1.5.5.7.48.2"}),new F({uri:R.caissuer})]})}p.push(P)}this.asn1ExtnValue=new x({array:p})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==c&&void 0!==c.array&&this.setAccessDescriptionArray(c.array)},extendClass(tt.asn1.x509.AuthorityInfoAccess,tt.asn1.x509.Extension),tt.asn1.x509.SubjectAltName=function(c){tt.asn1.x509.SubjectAltName.superclass.constructor.call(this,c),this.setNameArray=function(c){this.asn1ExtnValue=new tt.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",void 0!==c&&void 0!==c.array&&this.setNameArray(c.array)},extendClass(tt.asn1.x509.SubjectAltName,tt.asn1.x509.Extension),tt.asn1.x509.IssuerAltName=function(c){tt.asn1.x509.IssuerAltName.superclass.constructor.call(this,c),this.setNameArray=function(c){this.asn1ExtnValue=new tt.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",void 0!==c&&void 0!==c.array&&this.setNameArray(c.array)},extendClass(tt.asn1.x509.IssuerAltName,tt.asn1.x509.Extension),tt.asn1.x509.SubjectDirectoryAttributes=function(c){tt.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,c);var p=tt.asn1,v=p.DERSequence,x=p.ASN1Util.newObject,E=p.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var c=[],p=0;p<this.params.array.length;p++){var F=this.params.array[p];if(void 0==F.attr||void 0==F.array){var C={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==F.attr)C.seq[0].oid=E(F.attr),C.seq[1].set[0]={gentime:F.str};else if("placeOfBirth"==F.attr)C.seq[0].oid=E(F.attr),C.seq[1].set[0]={utf8str:F.str};else if("gender"==F.attr)C.seq[0].oid=E(F.attr),C.seq[1].set[0]={prnstr:F.str};else if("countryOfCitizenship"==F.attr)C.seq[0].oid=E(F.attr),C.seq[1].set[0]={prnstr:F.str};else{if("countryOfResidence"!=F.attr)throw new Error("unsupported attribute: "+F.attr);C.seq[0].oid=E(F.attr),C.seq[1].set[0]={prnstr:F.str}}c.push(new x(C))}else{var P={seq:[{oid:F.attr},{set:F.array}]};c.push(x(P))}}var R=new v({array:c});return this.asn1ExtnValue=R,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",void 0!==c&&(this.params=c)},extendClass(tt.asn1.x509.SubjectDirectoryAttributes,tt.asn1.x509.Extension),tt.asn1.x509.PrivateExtension=function(c){tt.asn1.x509.PrivateExtension.superclass.constructor.call(this,c);var p=tt,v=p.lang.String.isHex,x=p.asn1,E=x.x509.OID.name2oid,F=x.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.oid=E(c.extname),this.params=c},this.getExtnValueHex=function(){if(void 0==this.params.extname||void 0==this.params.extn)throw new Error("extname or extnhex not specified");var c=this.params.extn;if("string"==typeof c&&v(c))return c;if("object"==typeof c)try{return F(c).tohex()}catch(p){}throw new Error("unsupported extn value")},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.x509.PrivateExtension,tt.asn1.x509.Extension),tt.asn1.x509.CRL=function(c){tt.asn1.x509.CRL.superclass.constructor.call(this);var p=tt.asn1,v=p.DERSequence,x=p.DERBitString,E=p.x509,F=E.AlgorithmIdentifier,C=E.TBSCertList;this.params=void 0,this.setByParam=function(c){this.params=c},this.sign=function(){var c=new C(this.params).tohex(),p=new tt.crypto.Signature({alg:this.params.sigalg});p.init(this.params.cakey),p.updateHex(c);var v=p.sign();this.params.sighex=v},this.getPEM=function(){return hextopem(this.tohex(),"X509 CRL")},this.tohex=function(){var c=this.params;if(void 0==c.tbsobj&&(c.tbsobj=new C(c)),void 0==c.sighex&&void 0!=c.cakey&&this.sign(),void 0==c.sighex)throw new Error("sighex or cakey parameter not defined");var p=[];return p.push(c.tbsobj),p.push(new F({name:c.sigalg})),p.push(new x({hex:"00"+c.sighex})),new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.CRL,tt.asn1.ASN1Object),tt.asn1.x509.TBSCertList=function(c){tt.asn1.x509.TBSCertList.superclass.constructor.call(this);var p=tt.asn1,v=p.DERInteger,x=p.DERSequence,E=p.DERTaggedObject,F=(p.DERObjectIdentifier,p.x509),C=F.AlgorithmIdentifier,P=F.Time,R=F.Extensions,B=F.X500Name;this.params=null,this.setByParam=function(c){this.params=c},this.getRevCertSequence=function(){for(var c=[],p=this.params.revcert,E=0;E<p.length;E++){var F=[new v(p[E].sn),new P(p[E].date)];void 0!=p[E].ext&&F.push(new R(p[E].ext)),c.push(new x({array:F}))}return new x({array:c})},this.tohex=function(){var c=[],p=this.params;if(void 0!=p.version){var F=p.version-1,T=new v({int:F});c.push(T)}if(c.push(new C({name:p.sigalg})),c.push(new B(p.issuer)),c.push(new P(p.thisupdate)),void 0!=p.nextupdate&&c.push(new P(p.nextupdate)),void 0!=p.revcert&&c.push(this.getRevCertSequence()),void 0!=p.ext){var N=new R(p.ext);c.push(new E({tag:"a0",explicit:!0,obj:N}))}return new x({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.TBSCertList,tt.asn1.ASN1Object),tt.asn1.x509.CRLEntry=function(c){tt.asn1.x509.CRLEntry.superclass.constructor.call(this);var p=tt.asn1;this.setCertSerial=function(c){this.sn=new p.DERInteger(c)},this.setRevocationDate=function(c){this.time=new p.x509.Time(c)},this.tohex=function(){var c=new p.DERSequence({array:[this.sn,this.time]});return this.TLV=c.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(void 0!==c.time&&this.setRevocationDate(c.time),void 0!==c.sn&&this.setCertSerial(c.sn))},extendClass(tt.asn1.x509.CRLEntry,tt.asn1.ASN1Object),tt.asn1.x509.CRLNumber=function(c){tt.asn1.x509.CRLNumber.superclass.constructor.call(this,c),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new tt.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.CRLNumber,tt.asn1.x509.Extension),tt.asn1.x509.CRLReason=function(c){tt.asn1.x509.CRLReason.superclass.constructor.call(this,c),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new tt.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.CRLReason,tt.asn1.x509.Extension),tt.asn1.x509.OCSPNonce=function(c){tt.asn1.x509.OCSPNonce.superclass.constructor.call(this,c),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new tt.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.OCSPNonce,tt.asn1.x509.Extension),tt.asn1.x509.OCSPNoCheck=function(c){tt.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,c),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new tt.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",void 0!=c&&(this.params=c)},extendClass(tt.asn1.x509.OCSPNoCheck,tt.asn1.x509.Extension),tt.asn1.x509.AdobeTimeStamp=function(c){tt.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,c);var p=tt.asn1,v=p.DERInteger,x=p.DERBoolean,E=p.DERSequence,F=p.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var c=this.params,p=[new v(1)];return p.push(new F({uri:c.uri})),void 0!=c.reqauth&&p.push(new x(c.reqauth)),this.asn1ExtnValue=new E({array:p}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.AdobeTimeStamp,tt.asn1.x509.Extension),tt.asn1.x509.X500Name=function(c){tt.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var p=tt.asn1,v=p.x509,x=v.RDN;this.setByString=function(c,p){void 0!==p&&(this.sRule=p);var v=c.split("/");v.shift();for(var E=[],F=0;F<v.length;F++)if(v[F].match(/^[^=]+=.+$/))E.push(v[F]);else{var C=E.length-1;E[C]=E[C]+"/"+v[F]}for(F=0;F<E.length;F++)this.asn1Array.push(new x({str:E[F],rule:this.sRule}))},this.setByLdapString=function(c,p){void 0!==p&&(this.sRule=p);var x=v.X500Name.ldapToCompat(c);this.setByString(x,p)},this.setByObject=function(c,p){for(var v in void 0!==p&&(this.sRule=p),c)if(c.hasOwnProperty(v)){var E=new x({str:v+"="+c[v],rule:this.sRule});this.asn1Array?this.asn1Array.push(E):this.asn1Array=[E]}},this.setByParam=function(c){var p;(void 0!==c.rule&&(this.sRule=c.rule),void 0!==c.array)?this.paramArray=c.array:void 0!==c.str?this.setByString(c.str):void 0!==c.ldapstr?this.setByLdapString(c.ldapstr):void 0!==c.hex?this.hTLV=c.hex:void 0!==c.certissuer?((p=new X509).readCertPEM(c.certissuer),this.hTLV=p.getIssuerHex()):void 0!==c.certsubject?((p=new X509).readCertPEM(c.certsubject),this.hTLV=p.getSubjectHex()):"object"===typeof c&&void 0===c.certsubject&&void 0===c.certissuer&&this.setByObject(c)},this.tohex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var c=0;c<this.paramArray.length;c++){var v={array:this.paramArray[c]};"utf8"!=this.sRule&&(v.rule=this.sRule);var E=new x(v);this.asn1Array.push(E)}var F=new p.DERSequence({array:this.asn1Array});return this.hTLV=F.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.X500Name,tt.asn1.ASN1Object),tt.asn1.x509.X500Name.compatToLDAP=function(c){if("/"!==c.substr(0,1))throw"malformed input";var p=(c=c.substr(1)).split("/");return p.reverse(),(p=p.map((function(c){return c.replace(/,/,"\\,")}))).join(",")},tt.asn1.x509.X500Name.onelineToLDAP=function(c){return tt.asn1.x509.X500Name.compatToLDAP(c)},tt.asn1.x509.X500Name.ldapToCompat=function(c){for(var p=c.split(","),v=!1,x=[],E=0;p.length>0;E++){var F=p.shift();if(!0===v){var C=(x.pop()+","+F).replace(/\\,/g,",");x.push(C),v=!1}else x.push(F);"\\"===F.substr(-1,1)&&(v=!0)}return(x=x.map((function(c){return c.replace("/","\\/")}))).reverse(),"/"+x.join("/")},tt.asn1.x509.X500Name.ldapToOneline=function(c){return tt.asn1.x509.X500Name.ldapToCompat(c)},tt.asn1.x509.RDN=function(c){tt.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var p=tt.asn1.x509.AttributeTypeAndValue;this.setByParam=function(c){void 0!==c.rule&&(this.sRule=c.rule),void 0!==c.str&&this.addByMultiValuedString(c.str),void 0!==c.array&&(this.paramArray=c.array)},this.addByString=function(c){this.asn1Array.push(new tt.asn1.x509.AttributeTypeAndValue({str:c,rule:this.sRule}))},this.addByMultiValuedString=function(c){for(var p=tt.asn1.x509.RDN.parseString(c),v=0;v<p.length;v++)this.addByString(p[v])},this.tohex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var c=0;c<this.paramArray.length;c++){var v=this.paramArray[c];void 0!==v.rule&&"utf8"!=this.sRule&&(v.rule=this.sRule);var x=new p(v);this.asn1Array.push(x)}var E=new tt.asn1.DERSet({array:this.asn1Array});return this.TLV=E.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.RDN,tt.asn1.ASN1Object),tt.asn1.x509.RDN.parseString=function(c){for(var p=c.split(/\+/),v=!1,x=[],E=0;p.length>0;E++){var F=p.shift();if(!0===v){var C=(x.pop()+"+"+F).replace(/\\\+/g,"+");x.push(C),v=!1}else x.push(F);"\\"===F.substr(-1,1)&&(v=!0)}var P=!1,R=[];for(E=0;x.length>0;E++){F=x.shift();if(!0===P){var B=R.pop();if(F.match(/"$/)){C=(B+"+"+F).replace(/^([^=]+)="(.*)"$/,"$1=$2");R.push(C),P=!1}else R.push(B+"+"+F)}else R.push(F);F.match(/^[^=]+="/)&&(P=!0)}return R},tt.asn1.x509.AttributeTypeAndValue=function(c){tt.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var p=tt,v=p.asn1,x=v.DERSequence,E=v.DERUTF8String,F=v.DERPrintableString,C=v.DERTeletexString,P=v.DERIA5String,R=v.DERVisibleString,B=v.DERBMPString,T=p.lang.String.isMail,N=p.lang.String.isPrintable;this.setByParam=function(c){if(void 0!==c.rule&&(this.sRule=c.rule),void 0!==c.ds&&(this.dsType=c.ds),void 0===c.value&&void 0!==c.str){var p=c.str.match(/^([^=]+)=(.+)$/);if(!p)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=p[1],this.sValue=p[2]}else this.sType=c.type,this.sValue=c.value},this.setByString=function(c,p){void 0!==p&&(this.sRule=p);var v=c.match(/^([^=]+)=(.+)$/);if(!v)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(v[1],v[2])},this._getDsType=function(){var c=this.sType,p=this.sValue,v=this.sRule;return"prn"===v?"CN"==c&&T(p)?"ia5":N(p)?"prn":"utf8":"utf8"===v?"CN"==c&&T(p)?"ia5":"C"==c?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(c,p,v){void 0!==v&&(this.sRule=v),this.sType=c,this.sValue=p},this.getValueObj=function(c,p){if("utf8"==c)return new E({str:p});if("prn"==c)return new F({str:p});if("tel"==c)return new C({str:p});if("ia5"==c)return new P({str:p});if("vis"==c)return new R({str:p});if("bmp"==c)return new B({str:p});throw new Error("unsupported directory string type: type="+c+" value="+p)},this.tohex=function(){null==this.dsType&&(this.dsType=this._getDsType());var c=tt.asn1.x509.OID.atype2obj(this.sType),p=this.getValueObj(this.dsType,this.sValue),v=new x({array:[c,p]});return this.TLV=v.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.AttributeTypeAndValue,tt.asn1.ASN1Object),tt.asn1.x509.SubjectPublicKeyInfo=function(c){tt.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var p=tt,v=p.asn1,x=v.DERInteger,E=v.DERBitString,F=v.DERObjectIdentifier,C=v.DERSequence,P=v.ASN1Util.newObject,R=v.x509.AlgorithmIdentifier,B=p.crypto;B.ECDSA,B.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new C({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var c=this.getASN1Object();return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(c){try{if(c instanceof RSAKey){var p=P({seq:[{int:{bigint:c.n}},{int:{int:c.e}}]}).tohex();this.asn1AlgId=new R({name:"rsaEncryption"}),this.asn1SubjPKey=new E({hex:"00"+p})}}catch(B){}try{if(c instanceof tt.crypto.ECDSA){var v=new F({name:c.curveName});this.asn1AlgId=new R({name:"ecPublicKey",asn1params:v}),this.asn1SubjPKey=new E({hex:"00"+c.pubKeyHex})}}catch(B){}try{if(c instanceof tt.crypto.DSA){v=new P({seq:[{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.g}}]});this.asn1AlgId=new R({name:"dsa",asn1params:v});var C=new x({bigint:c.y});this.asn1SubjPKey=new E({hex:"00"+C.tohex()})}}catch(B){}},void 0!==c&&this.setPubKey(c)},extendClass(tt.asn1.x509.SubjectPublicKeyInfo,tt.asn1.ASN1Object),tt.asn1.x509.Time=function(c){tt.asn1.x509.Time.superclass.constructor.call(this);var p=tt.asn1,v=p.DERUTCTime,x=p.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(c){this.timeParams=c},this.setByParam=function(c){this.params=c},this.getType=function(c){return c.match(/^[0-9]{12}Z$/)?"utc":c.match(/^[0-9]{14}Z$/)?"gen":c.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":c.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var c=this.params,p=null;if("string"==typeof c&&(c={str:c}),null==c||!c.str||null!=c.type&&void 0!=c.type||(c.type=this.getType(c.str)),null!=c&&c.str?("utc"==c.type&&(p=new v(c.str)),"gen"==c.type&&(p=new x(c.str))):p="gen"==this.type?new x:new v,null==p)throw new Error("wrong setting for Time");return this.TLV=p.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},tt.asn1.x509.Time_bak=function(c){tt.asn1.x509.Time_bak.superclass.constructor.call(this);var p=tt.asn1,v=p.DERUTCTime,x=p.DERGeneralizedTime;this.setTimeParams=function(c){this.timeParams=c},this.tohex=function(){var c=null;return c=null!=this.timeParams?"utc"==this.type?new v(this.timeParams):new x(this.timeParams):"utc"==this.type?new v:new x,this.TLV=c.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",void 0!==c&&(void 0!==c.type?this.type=c.type:void 0!==c.str&&(c.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),c.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=c)},extendClass(tt.asn1.x509.Time,tt.asn1.ASN1Object),tt.asn1.x509.AlgorithmIdentifier=function(c){tt.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var p=tt.asn1,v=p.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var c=null;for(var x in v)x===this.nameAlg&&(c=v[x]);if(null!==c)return this.hTLV=c,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=p.x509.OID.name2obj(this.nameAlg));var E=[this.asn1Alg];null!==this.asn1Params&&E.push(this.asn1Params);var F=new p.DERSequence({array:E});return this.hTLV=F.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&(void 0!==c.name&&(this.nameAlg=c.name),void 0!==c.asn1params&&(this.asn1Params=c.asn1params),void 0!==c.paramempty&&(this.paramEmpty=c.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var x=this.nameAlg.toLowerCase();"withdsa"!==x.substr(-7,7)&&"withecdsa"!==x.substr(-9,9)&&(this.asn1Params=new p.DERNull)}},extendClass(tt.asn1.x509.AlgorithmIdentifier,tt.asn1.ASN1Object),tt.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},tt.asn1.x509.GeneralName=function(c){tt.asn1.x509.GeneralName.superclass.constructor.call(this);var p=tt.asn1,v=p.x509,x=v.X500Name,E=v.OtherName,F=p.DERIA5String,C=(p.DERPrintableString,p.DEROctetString),P=p.DERTaggedObject,R=p.ASN1Object,B=Error;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c,p,v=this.params,T=!1;if(void 0!==v.other)c="a0",p=new E(v.other);else if(void 0!==v.rfc822)c="81",p=new F({str:v.rfc822});else if(void 0!==v.dns)c="82",p=new F({str:v.dns});else if(void 0!==v.dn)c="a4",T=!0,p="string"===typeof v.dn?new x({str:v.dn}):v.dn instanceof tt.asn1.x509.X500Name?v.dn:new x(v.dn);else if(void 0!==v.ldapdn)c="a4",T=!0,p=new x({ldapstr:v.ldapdn});else if(void 0!==v.certissuer||void 0!==v.certsubj){var N,_;c="a4",T=!0;var L=null;if(void 0!==v.certsubj?(N=!1,_=v.certsubj):(N=!0,_=v.certissuer),_.match(/^[0-9A-Fa-f]+$/),-1!=_.indexOf("-----BEGIN ")&&(L=pemtohex(_)),null==L)throw new Error("certsubj/certissuer not cert");var V,U=new X509;U.hex=L,V=N?U.getIssuerHex():U.getSubjectHex(),(p=new R).hTLV=V}else if(void 0!==v.uri)c="86",p=new F({str:v.uri});else{if(void 0===v.ip)throw new B("improper params");var W;c="87";var G=v.ip;try{if(G.match(/^[0-9a-f]+$/)){var X=G.length;if(8!=X&&16!=X&&32!=X&&64!=X)throw"err";W=G}else W=iptohex(G)}catch(J){throw new B("malformed IP address: "+v.ip+":"+J.message)}p=new C({hex:W})}return new P({tag:c,explicit:T,obj:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.GeneralName,tt.asn1.ASN1Object),tt.asn1.x509.GeneralNames=function(c){tt.asn1.x509.GeneralNames.superclass.constructor.call(this);var p=tt.asn1;this.setByParamArray=function(c){for(var v=0;v<c.length;v++){var x=new p.x509.GeneralName(c[v]);this.asn1Array.push(x)}},this.tohex=function(){return new p.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,"undefined"!=typeof c&&this.setByParamArray(c)},extendClass(tt.asn1.x509.GeneralNames,tt.asn1.ASN1Object),tt.asn1.x509.OtherName=function(c){tt.asn1.x509.OtherName.superclass.constructor.call(this);var p=tt.asn1,v=p.DERObjectIdentifier,x=p.DERSequence,E=p.ASN1Util.newObject;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if(void 0==c.oid||void 0==c.value)throw new Error("oid or value not specified");var p=new v({oid:c.oid}),F=E({tag:{tag:"a0",explicit:!0,obj:c.value}});return new x({array:[p,F]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.x509.OtherName,tt.asn1.ASN1Object),tt.asn1.x509.OID=new function(){var c=tt.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(p){if("undefined"!=typeof this.objCache[p])return this.objCache[p];if("undefined"==typeof this.name2oidList[p])throw"Name of ObjectIdentifier not defined: "+p;var v=this.name2oidList[p],x=new c({oid:v});return this.objCache[p]=x,x},this.atype2obj=function(p){if(void 0!==this.objCache[p])return this.objCache[p];var v;if(p.match(/^\d+\.\d+\.[0-9.]+$/))v=p;else if(void 0!==this.atype2oidList[p])v=this.atype2oidList[p];else{if(void 0===this.name2oidList[p])throw new Error("AttributeType name undefined: "+p);v=this.name2oidList[p]}var x=new c({oid:v});return this.objCache[p]=x,x},this.registerOIDs=function(c){if(this.checkOIDs(c))for(var p in c)this.name2oidList[p]=c[p]},this.checkOIDs=function(c){try{var p=Object.keys(c);return 0!=p.length&&(p.map((function(c,p,v){if(!this[c].match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")}),c),!0)}catch(v){return!1}}},tt.asn1.x509.OID.oid2name=function(c){var p=tt.asn1.x509.OID.name2oidList;for(var v in p)if(p[v]==c)return v;return""},tt.asn1.x509.OID.oid2atype=function(c){var p=tt.asn1.x509.OID.atype2oidList;for(var v in p)if(p[v]==c)return v;return c},tt.asn1.x509.OID.name2oid=function(c){if(c.match(/^[0-9.]+$/))return c;var p=tt.asn1.x509.OID.name2oidList;return void 0===p[c]?"":p[c]},tt.asn1.x509.X509Util={},tt.asn1.x509.X509Util.newCertPEM=function(c){var p=tt.asn1.x509;p.TBSCertificate;return new(0,p.Certificate)(c).getPEM()},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),"undefined"!=typeof tt.asn1.cms&&tt.asn1.cms||(tt.asn1.cms={}),tt.asn1.cms.Attribute=function(c){var p=Error,v=tt.asn1,x=v.DERSequence,E=v.DERSet,F=v.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(c){this.params=c},this.getValueArray=function(){throw new p("not yet implemented abstract")},this.tohex=function(){var c=new F({oid:this.typeOid}),p=new E({array:this.getValueArray()});return new x({array:[c,p]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},extendClass(tt.asn1.cms.Attribute,tt.asn1.ASN1Object),tt.asn1.cms.ContentType=function(c){var p=tt.asn1;p.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new p.DERObjectIdentifier(this.params.type)]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.ContentType,tt.asn1.cms.Attribute),tt.asn1.cms.MessageDigest=function(c){var p=tt.asn1,v=p.DEROctetString;p.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new v(this.params)]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.MessageDigest,tt.asn1.cms.Attribute),tt.asn1.cms.SigningTime=function(c){var p=tt.asn1;p.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new p.x509.Time(this.params)]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SigningTime,tt.asn1.cms.Attribute),tt.asn1.cms.SigningCertificate=function(c){var p=Error,v=tt,x=v.asn1,E=x.DERSequence,F=x.cms,C=F.ESSCertID;v.crypto;F.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new p("parameter 'array' not specified");for(var v=this.params.array,x=[],F=0;F<v.length;F++){var P=v[F];0!=c.hasis||"string"!=typeof P||-1==P.indexOf("-----BEGIN")&&!nt.isASN1HEX(P)||(P={cert:P}),0!=P.hasis&&0==c.hasis&&(P.hasis=!1),x.push(new C(P))}var R=new E({array:x});return[new E({array:[R]})]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SigningCertificate,tt.asn1.cms.Attribute),tt.asn1.cms.ESSCertID=function(c){tt.asn1.cms.ESSCertID.superclass.constructor.call(this);var p=Error,v=tt,x=v.asn1,E=x.DEROctetString,F=x.DERSequence,C=x.cms.IssuerSerial;this.params=null,this.getCertHash=function(c,x){if(void 0!=c.hash)return c.hash;if("string"==typeof c&&-1==c.indexOf("-----BEGIN")&&!nt.isASN1HEX(c))return c;var E,F,C;if("string"==typeof c)E=c;else{if(void 0==c.cert)throw new p("hash nor cert unspecified");E=c.cert}if(F=-1!=E.indexOf("-----BEGIN")?pemtohex(E):E,"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?F=pemtohex(c):nt.isASN1HEX(c)&&(F=c)),void 0!=c.alg)C=c.alg;else{if(void 0==x)throw new p("hash alg unspecified");C=x}return v.crypto.Util.hashHex(F,C)},this.tohex=function(){var c=this.params,p=this.getCertHash(c,"sha1"),v=[];return v.push(new E({hex:p})),("string"==typeof c&&-1!=c.indexOf("-----BEGIN")||void 0!=c.cert&&0!=c.hasis||void 0!=c.issuer&&void 0!=c.serial)&&v.push(new C(c)),new F({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.ESSCertID,tt.asn1.ASN1Object),tt.asn1.cms.SigningCertificateV2=function(c){var p=Error,v=tt,x=v.asn1,E=x.DERSequence,F=(x.x509,x.cms),C=F.ESSCertIDv2;v.crypto;F.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new p("parameter 'array' not specified");for(var v=this.params.array,x=[],F=0;F<v.length;F++){var P=v[F];void 0==c.alg&&0!=c.hasis||"string"!=typeof P||-1==P.indexOf("-----BEGIN")&&!nt.isASN1HEX(P)||(P={cert:P}),void 0==P.alg&&void 0!=c.alg&&(P.alg=c.alg),0!=P.hasis&&0==c.hasis&&(P.hasis=!1),x.push(new C(P))}var R=new E({array:x});return[new E({array:[R]})]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SigningCertificateV2,tt.asn1.cms.Attribute),tt.asn1.cms.ESSCertIDv2=function(c){tt.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);Error;var p=tt.asn1,v=p.DEROctetString,x=p.DERSequence,E=p.cms.IssuerSerial,F=p.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var c=this.params,p=this.getCertHash(c,"sha256"),C=[];return void 0!=c.alg&&"sha256"!=c.alg&&C.push(new F({name:c.alg})),C.push(new v({hex:p})),("string"==typeof c&&-1!=c.indexOf("-----BEGIN")||void 0!=c.cert&&0!=c.hasis||void 0!=c.issuer&&void 0!=c.serial)&&C.push(new E(c)),new x({array:C}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.ESSCertIDv2,tt.asn1.cms.ESSCertID),tt.asn1.cms.IssuerSerial=function(c){var p=Error,v=tt.asn1,x=v.DERInteger,E=v.DERSequence,F=v.cms,C=v.x509.GeneralNames,P=X509;F.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(c){this.params=c},this.tohex=function(){var c,v,F=this.params;if("string"==typeof F&&-1!=F.indexOf("-----BEGIN")||void 0!=F.cert){var R;R=void 0!=F.cert?F.cert:F;var B=new P;B.readCertPEM(R),c=B.getIssuer(),v={hex:B.getSerialNumberHex()}}else{if(void 0==F.issuer||!F.serial)throw new p("cert or issuer and serial parameter not specified");c=F.issuer,v=F.serial}var T=new C([{dn:c}]),N=new x(v);return new E({array:[T,N]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.IssuerSerial,tt.asn1.ASN1Object),tt.asn1.cms.SignerIdentifier=function(c){var p=tt.asn1,v=(p.DERInteger,p.DERSequence,p.cms),x=v.IssuerAndSerialNumber,E=v.SubjectKeyIdentifier;p.x509.X500Name,Error;v.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if("isssn"==c.type)return new x(c).tohex();if("skid"==c.type)return new E(c).tohex();throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SignerIdentifier,tt.asn1.ASN1Object),tt.asn1.cms.IssuerAndSerialNumber=function(c){var p=tt.asn1,v=p.DERInteger,x=p.DERSequence,E=p.cms,F=p.x509.X500Name,C=X509,P=Error;E.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c,p,E=this.params;if("string"==typeof E&&-1!=E.indexOf("-----BEGIN")||void 0!=E.cert){var R;R=void 0!=E.cert?E.cert:E;var B=new C;B.readCertPEM(R),c=B.getIssuer(),p={hex:B.getSerialNumberHex()}}else{if(void 0==E.issuer||!E.serial)throw new P("cert or issuer and serial parameter not specified");c=E.issuer,p=E.serial}var T=new F(c),N=new v(p);return new x({array:[T,N]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.IssuerAndSerialNumber,tt.asn1.ASN1Object),tt.asn1.cms.SubjectKeyIdentifier=function(c){var p=tt.asn1,v=(p.DERInteger,p.DERSequence,p.ASN1Util.newObject),x=p.cms,E=(x.IssuerAndSerialName,x.SubjectKeyIdentifier,p.x509.X500Name,X509),F=Error;x.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var c,p=this.params;if(void 0==p.cert&&void 0==p.skid)throw new F("property cert nor skid undefined");void 0!=p.cert?c=new E(p.cert).getExtSubjectKeyIdentifier().kid.hex:void 0!=p.skid&&(c=p.skid);return v({tag:{tage:"a0",obj:{octstr:{hex:c}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SubjectKeyIdentifier,tt.asn1.ASN1Object),tt.asn1.cms.AttributeList=function(c){var p=Error,v=tt.asn1,x=v.DERSet,E=v.cms;E.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if(null!=this.hTLV)return this.hTLV;var v=!0;void 0!=c.sortflag&&(v=c.sortflag);for(var F=c.array,C=[],P=0;P<F.length;P++){var R=F[P],B=R.attr;if("contentType"==B)C.push(new E.ContentType(R));else if("messageDigest"==B)C.push(new E.MessageDigest(R));else if("signingTime"==B)C.push(new E.SigningTime(R));else if("signingCertificate"==B)C.push(new E.SigningCertificate(R));else if("signingCertificateV2"==B)C.push(new E.SigningCertificateV2(R));else if("signaturePolicyIdentifier"==B)C.push(new tt.asn1.cades.SignaturePolicyIdentifier(R));else{if("signatureTimeStamp"!=B&&"timeStampToken"!=B)throw new p("unknown attr: "+B);C.push(new tt.asn1.cades.SignatureTimeStamp(R))}}var T=new x({array:C,sortflag:v});return this.hTLV=T.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.AttributeList,tt.asn1.ASN1Object),tt.asn1.cms.SignerInfo=function(c){var p=Error,v=tt,x=v.asn1,E=x.DERInteger,F=x.DEROctetString,C=x.DERSequence,P=x.DERTaggedObject,R=x.cms,B=R.SignerIdentifier,T=R.AttributeList,N=(R.ContentType,R.EncapsulatedContentInfo,R.MessageDigest,R.SignedData,x.x509.AlgorithmIdentifier),_=v.crypto,L=it;R.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var c=this.params,p=c.sigalg,v=new T(c.sattrs).tohex(),x=L.getKey(c.signkey),E=new _.Signature({alg:p});E.init(x),E.updateHex(v);var F=E.sign();c.sighex=F},this.tohex=function(){var c=this.params,v=[];if(v.push(new E({int:c.version})),v.push(new B(c.id)),v.push(new N({name:c.hashalg})),void 0!=c.sattrs){var x=new T(c.sattrs);try{v.push(new P({tag:"a0",explicit:!1,obj:x}))}catch(R){throw new p("si sattr error: "+R)}}if(void 0!=c.sigalgfield?v.push(new N({name:c.sigalgfield})):v.push(new N({name:c.sigalg})),void 0==c.sighex&&void 0!=c.signkey&&this.sign(),v.push(new F({hex:c.sighex})),void 0!=c.uattrs){x=new T(c.uattrs);try{v.push(new P({tag:"a1",explicit:!1,obj:x}))}catch(R){throw new p("si uattr error: "+R)}}return new C({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SignerInfo,tt.asn1.ASN1Object),tt.asn1.cms.EncapsulatedContentInfo=function(c){var p=tt.asn1,v=p.DERTaggedObject,x=p.DERSequence,E=p.DERObjectIdentifier,F=p.DEROctetString;p.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=[];if(p.push(new E(c.type)),void 0!=c.content&&(void 0!=c.content.hex||void 0!=c.content.str)&&1!=c.isDetached){var C=new F(c.content),P=new v({tag:"a0",explicit:!0,obj:C});p.push(P)}return new x({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.EncapsulatedContentInfo,tt.asn1.ASN1Object),tt.asn1.cms.ContentInfo=function(c){var p=tt.asn1,v=p.DERTaggedObject,x=p.DERSequence,E=p.DERObjectIdentifier;p.x509.OID.name2obj;tt.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=[];p.push(new E(c.type));var F=new v({tag:"a0",explicit:!0,obj:c.obj});return p.push(F),new x({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.ContentInfo,tt.asn1.ASN1Object),tt.asn1.cms.SignedData=function(c){Error;var p=tt.asn1,v=(p.ASN1Object,p.DERInteger),x=p.DERSet,E=p.DERSequence,F=(p.DERTaggedObject,p.cms),C=F.EncapsulatedContentInfo,P=F.SignerInfo,R=F.ContentInfo,B=F.CertificateSet,T=F.RevocationInfoChoices,N=p.x509.AlgorithmIdentifier;tt.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var c=this.params;this._setDigestAlgs(c),this._setContentTypeByEContent(c),this._setMessageDigestByEContent(c),this._setSignerInfoVersion(c),this._setSignedDataVersion(c)},this._setDigestAlgs=function(c){for(var p={},v=c.sinfos,x=0;x<v.length;x++){p[v[x].hashalg]=1}c.hashalgs=Object.keys(p).sort()},this._setContentTypeByEContent=function(c){for(var p=c.econtent.type,v=c.sinfos,x=0;x<v.length;x++){var E=v[x];this._getAttrParamByName(E,"contentType").type=p}},this._setMessageDigestByEContent=function(c){var p=c.econtent,v=(c.econtent.type,p.content.hex);void 0==v&&"data"==p.type&&void 0!=p.content.str&&(v=rstrtohex(p.content.str));for(var x=c.sinfos,E=0;E<x.length;E++){var F=x[E],C=F.hashalg,P=this._getAttrParamByName(F,"messageDigest"),R=tt.crypto.Util.hashHex(v,C);P.hex=R}},this._getAttrParamByName=function(c,p){for(var v=c.sattrs.array,x=0;x<v.length;x++)if(v[x].attr==p)return v[x]},this._setSignerInfoVersion=function(c){for(var p=c.sinfos,v=0;v<p.length;v++){var x=p[v],E=1;"skid"==x.id.type&&(E=3),x.version=E}},this._setSignedDataVersion=function(c){var p=this._getSignedDataVersion(c);c.version=p},this._getSignedDataVersion=function(c){if(void 0!=c.revinfos)for(var p=c.revinfos,v=0;v<p.length;v++){if(void 0!=p[v].ocsp)return 5}var x=c.sinfos;for(v=0;v<x.length;v++){if(3==c.sinfos[v].version)return 3}return"data"!=c.econtent.type?3:1},this.tohex=function(){var c=this.params;void 0!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),1!=c.fixed&&this.checkAndFixParam();var p=[];p.push(new v({int:c.version}));for(var F=[],R=0;R<c.hashalgs.length;R++){var _=c.hashalgs[R];F.push(new N({name:_}))}p.push(new x({array:F})),p.push(new C(c.econtent)),void 0!=c.certs&&p.push(new B(c.certs)),void 0!=c.revinfos&&p.push(new T(c.revinfos));var L=[];for(R=0;R<c.sinfos.length;R++){var V=c.sinfos[R];L.push(new P(V))}return p.push(new x({array:L})),new E({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new R({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.SignedData,tt.asn1.ASN1Object),tt.asn1.cms.CertificateSet=function(c){tt.asn1.cms.CertificateSet.superclass.constructor.call(this);var p=Error,v=tt.asn1,x=v.DERTaggedObject,E=v.DERSet,F=v.ASN1Object;this.params=null,this.tohex=function(){var c,v=this.params,C=[];if(v instanceof Array)c=v;else{if(void 0==v.array)throw new p("cert array not specified");c=v.array}for(var P=0;P<c.length;P++){var R=pemtohex(c[P]),B=new F;B.hTLV=R,C.push(B)}var T={array:C};0==v.sortflag&&(T.sortflag=!1);var N=new E(T);return new x({tag:"a0",explicit:!1,obj:N}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.CertificateSet,tt.asn1.ASN1Object),tt.asn1.cms.RevocationInfoChoices=function(c){tt.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(!c instanceof Array)throw new Error("params is not array");for(var p=[],v=0;v<c.length;v++)p.push(new tt.asn1.cms.RevocationInfoChoice(c[v]));return tt.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:p}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.RevocationInfoChoices,tt.asn1.ASN1Object),tt.asn1.cms.RevocationInfoChoice=function(c){tt.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(void 0!=c.crl&&"string"==typeof c.crl){var p=c.crl;return-1!=c.crl.indexOf("-----BEGIN")&&(p=pemtohex(c.crl)),p}if(void 0!=c.ocsp)return tt.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new tt.asn1.cms.OtherRevocationFormat(c)}}).tohex();throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.RevocationInfoChoice,tt.asn1.ASN1Object),tt.asn1.cms.OtherRevocationFormat=function(c){tt.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var p=Error,v=tt,x=v.asn1.ASN1Util.newObject,E=v.lang.String.isHex;this.params=null,this.tohex=function(){var c=this.params;if(void 0==c.ocsp)throw new p("property ocsp not specified");if(!E(c.ocsp)||!nt.isASN1HEX(c.ocsp))throw new p("ocsp value not ASN.1 hex string");return x({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:c.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cms.OtherRevocationFormat,tt.asn1.ASN1Object),tt.asn1.cms.CMSUtil=new function(){},tt.asn1.cms.CMSUtil.newSignedData=function(c){return new tt.asn1.cms.SignedData(c)},tt.asn1.cms.CMSUtil.verifySignedData=function(c){var p=tt,v=p.asn1,x=v.cms,E=(x.SignerInfo,x.SignedData,x.SigningTime,x.SigningCertificate,x.SigningCertificateV2,v.cades.SignaturePolicyIdentifier,p.lang.String.isHex),F=nt,C=F.getVbyList,P=F.getTLVbyList,R=F.getIdxbyList,B=F.getChildIdx,T=F.getTLV,N=F.oidname,_=p.crypto.Util.hashHex;void 0===c.cms&&E(c.cms);var L=c.cms,k=function(c,p){var v=p.idx;p.signerid_issuer1=P(c,v,[1,0],"30"),p.signerid_serial1=C(c,v,[1,1],"02"),p.hashalg=N(C(c,v,[2,0],"06"));var x=R(c,v,[3],"a0");p.idxSignedAttrs=x,f(c,p,x);var E=B(c,v).length;if(E<6)throw"malformed SignerInfo";p.sigalg=N(C(c,v,[E-2,0],"06")),p.sigval=C(c,v,[E-1],"04")},f=function(c,p,v){var x=B(c,v);p.signedAttrIdxList=x;for(var E=0;E<x.length;E++){var F,P=x[E],R=C(c,P,[0],"06");"2a864886f70d010905"===R?(F=hextoutf8(C(c,P,[1,0])),p.saSigningTime=F):"2a864886f70d010904"===R&&(F=C(c,P,[1,0],"04"),p.saMessageDigest=F)}},e=function(c,p,v,x){v.verifyDetail={};var E=v.verifyDetail,F=p.parse.econtent,C=v.hashalg,P=v.saMessageDigest;E.validMessageDigest=!1,_(F,C)===P&&(E.validMessageDigest=!0),function(c,p,v,x){var E,F=p.parse.certsIdx;if(void 0===p.certs){E=[],p.certkeys=[];for(var C=B(c,F),P=0;P<C.length;P++){var R=T(c,C[P]),N=new X509;N.readCertHex(R),E[P]=N,p.certkeys[P]=N.getPublicKey()}p.certs=E}else E=p.certs;for(p.cccc=E.length,p.cccci=C.length,P=0;P<E.length;P++){var _=N.getIssuerHex(),L=N.getSerialNumberHex();v.signerid_issuer1===_&&v.signerid_serial1===L&&(v.certkey_idx=P)}}(c,p,v),E.validSignatureValue=!1;var R=v.sigalg,N="31"+T(c,v.idxSignedAttrs).substr(2);v.signedattrshex=N;var L=p.certs[v.certkey_idx].getPublicKey(),V=new tt.crypto.Signature({alg:R});V.init(L),V.updateHex(N);var U=V.verify(v.sigval);E.validSignatureValue_isValid=U,!0===U&&(E.validSignatureValue=!0),v.isValid=!1,E.validMessageDigest&&E.validSignatureValue&&(v.isValid=!0)},V={isValid:!1,parse:{}};return function(c,p){if("2a864886f70d010702"!==C(c,0,[0],"06"))return p;p.cmsType="signedData",p.econtent=C(c,0,[1,0,2,1,0]),function(c,p){for(var v,x=3;x<6;x++)if(void 0!==(v=R(c,0,[1,0,x]))){var E=c.substr(v,2);"a0"===E&&(p.certsIdx=v),"a1"===E&&(p.revinfosIdx=v),"31"===E&&(p.signerinfosIdx=v)}}(c,p),p.signerInfos=[],function(c,p){var v=p.signerinfosIdx;if(void 0!==v){var x=B(c,v);p.signerInfoIdxList=x;for(var E=0;E<x.length;E++){var F={idx:x[E]};k(c,F),p.signerInfos.push(F)}}}(c,p)}(L,V.parse),function(c,p){for(var v=p.parse.signerInfos,x=v.length,E=!0,F=0;F<x;F++){var C=v[F];e(c,p,C,F),C.isValid||(E=!1)}p.isValid=E}(L,V),V},tt.asn1.cms.CMSParser=function(){var c=Error,p=X509,v=new p,x=nt,E=x.getV,F=x.getTLV,C=(x.getIdxbyList,x.getTLVbyList),P=x.getTLVbyListEx,R=x.getVbyList,B=x.getVbyListEx,T=x.getChildIdx;this.getCMSSignedData=function(c){var p=C(c,0,[1,0]);return this.getSignedData(p)},this.getSignedData=function(c){var p=T(c,0),v={},x=E(c,p[0]),C=parseInt(x,16);v.version=C;var R=F(c,p[1]);v.hashalgs=this.getHashAlgArray(R);var B=F(c,p[2]);v.econtent=this.getEContent(B);var N=P(c,0,["[0]"]);null!=N&&(v.certs=this.getCertificateSet(N));P(c,0,["[1]"]);var _=P(c,0,[3]);return v.sinfos=this.getSignerInfos(_),v},this.getHashAlgArray=function(c){for(var v=T(c,0),x=new p,E=[],C=0;C<v.length;C++){var P=F(c,v[C]),R=x.getAlgorithmIdentifierName(P);E.push(R)}return E},this.getEContent=function(c){var p={},v=R(c,0,[0]),x=R(c,0,[1,0]);return p.type=tt.asn1.x509.OID.oid2name(nt.hextooidstr(v)),p.content={hex:x},p},this.getSignerInfos=function(c){for(var p=[],v=T(c,0),x=0;x<v.length;x++){var E=F(c,v[x]),C=this.getSignerInfo(E);p.push(C)}return p},this.getSignerInfo=function(c){var p={},E=T(c,0),C=x.getInt(c,E[0],-1);-1!=C&&(p.version=C);var R=F(c,E[1]),N=this.getIssuerAndSerialNumber(R);p.id=N;var _=F(c,E[2]),L=v.getAlgorithmIdentifierName(_);p.hashalg=L;var V=P(c,0,["[0]"]);if(null!=V){var U=this.getAttributeList(V);p.sattrs=U}var W=P(c,0,[3]),G=v.getAlgorithmIdentifierName(W);p.sigalg=G;var X=B(c,0,[4]);p.sighex=X;var J=P(c,0,["[1]"]);if(null!=J){var Z=this.getAttributeList(J);p.uattrs=Z}return p},this.getSignerIdentifier=function(c){if("30"==c.substr(0,2))return this.getIssuerAndSerialNumber(c);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(c){var p={type:"isssn"},x=T(c,0),C=F(c,x[0]);p.issuer=v.getX500Name(C);var P=E(c,x[1]);return p.serial={hex:P},p},this.getAttributeList=function(c){for(var p=[],v=T(c,0),x=0;x<v.length;x++){var E=F(c,v[x]),C=this.getAttribute(E);p.push(C)}return{array:p}},this.getAttribute=function(c){var p={},v=T(c,0),E=x.getOID(c,v[0]),C=tt.asn1.x509.OID.oid2name(E);p.attr=C;var P=F(c,v[1]),R=T(P,0);if(1==R.length)p.valhex=F(P,R[0]);else{for(var B=[],N=0;N<R.length;N++)B.push(F(P,R[N]));p.valhex=B}return"contentType"==C?this.setContentType(p):"messageDigest"==C?this.setMessageDigest(p):"signingTime"==C?this.setSigningTime(p):"signingCertificate"==C?this.setSigningCertificate(p):"signingCertificateV2"==C?this.setSigningCertificateV2(p):"signaturePolicyIdentifier"==C&&this.setSignaturePolicyIdentifier(p),p},this.setContentType=function(c){var p=x.getOIDName(c.valhex,0,null);null!=p&&(c.type=p,delete c.valhex)},this.setSigningTime=function(c){var p=hextoutf8(E(c.valhex,0));c.str=p,delete c.valhex},this.setMessageDigest=function(c){var p=E(c.valhex,0);c.hex=p,delete c.valhex},this.setSigningCertificate=function(c){var p=T(c.valhex,0);if(p.length>0){for(var v=F(c.valhex,p[0]),x=T(v,0),E=[],C=0;C<x.length;C++){var P=F(v,x[C]),R=this.getESSCertID(P);E.push(R)}c.array=E}if(p.length>1){var B=F(c.valhex,p[1]);c.polhex=B}delete c.valhex},this.setSignaturePolicyIdentifier=function(c){var v=T(c.valhex,0);if(v.length>0){var C=x.getOID(c.valhex,v[0]);c.oid=C}if(v.length>1){var P=new p,R=T(c.valhex,v[1]),B=F(c.valhex,R[0]),N=P.getAlgorithmIdentifierName(B);c.alg=N;var _=E(c.valhex,R[1]);c.hash=_}delete c.valhex},this.setSigningCertificateV2=function(c){var p=T(c.valhex,0);if(p.length>0){for(var v=F(c.valhex,p[0]),x=T(v,0),E=[],C=0;C<x.length;C++){var P=F(v,x[C]),R=this.getESSCertIDv2(P);E.push(R)}c.array=E}if(p.length>1){var B=F(c.valhex,p[1]);c.polhex=B}delete c.valhex},this.getESSCertID=function(c){var p={},v=T(c,0);if(v.length>0){var x=E(c,v[0]);p.hash=x}if(v.length>1){var C=F(c,v[1]),P=this.getIssuerSerial(C);void 0!=P.serial&&(p.serial=P.serial),void 0!=P.issuer&&(p.issuer=P.issuer)}return p},this.getESSCertIDv2=function(p){var x={},C=T(p,0);if(C.length<1||3<C.length)throw new c("wrong number of elements");var P=0;if("30"==p.substr(C[0],2)){var R=F(p,C[0]);x.alg=v.getAlgorithmIdentifierName(R),P++}else x.alg="sha256";var B=E(p,C[P]);if(x.hash=B,C.length>P+1){var N=F(p,C[P+1]),_=this.getIssuerSerial(N);x.issuer=_.issuer,x.serial=_.serial}return x},this.getIssuerSerial=function(c){var p={},x=T(c,0),C=F(c,x[0]),P=v.getGeneralNames(C)[0].dn;p.issuer=P;var R=E(c,x[1]);return p.serial={hex:R},p},this.getCertificateSet=function(c){for(var p=T(c,0),v=[],x=0;x<p.length;x++){var E=F(c,p[x]);if("30"==E.substr(0,2)){var C=hextopem(E,"CERTIFICATE");v.push(C)}}return{array:v,sortflag:!1}}},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),"undefined"!=typeof tt.asn1.tsp&&tt.asn1.tsp||(tt.asn1.tsp={}),tt.asn1.tsp.TimeStampToken=function(c){var p=tt.asn1.tsp;p.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var c=new p.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=c.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.TimeStampToken,tt.asn1.cms.SignedData),tt.asn1.tsp.TSTInfo=function(c){Error;var p=tt.asn1,v=p.DERSequence,x=p.DERInteger,E=p.DERBoolean,F=p.DERGeneralizedTime,C=p.DERObjectIdentifier,P=p.DERTaggedObject,R=p.tsp,B=R.MessageImprint,T=R.Accuracy,N=(p.x509.X500Name,p.x509.GeneralName);if(R.TSTInfo.superclass.constructor.call(this),this.dVersion=new x({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var c=[this.dVersion];if(null==this.dPolicy)throw new Error("policy shall be specified.");if(c.push(this.dPolicy),null==this.dMessageImprint)throw new Error("messageImprint shall be specified.");if(c.push(this.dMessageImprint),null==this.dSerial)throw new Error("serialNumber shall be specified.");if(c.push(this.dSerial),null==this.dGenTime)throw new Error("genTime shall be specified.");c.push(this.dGenTime),null!=this.dAccuracy&&c.push(this.dAccuracy),null!=this.dOrdering&&c.push(this.dOrdering),null!=this.dNonce&&c.push(this.dNonce),null!=this.dTsa&&c.push(this.dTsa);var p=new v({array:c});return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c){if("string"==typeof c.policy){if(!c.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new C({oid:c.policy})}void 0!==c.messageImprint&&(this.dMessageImprint=new B(c.messageImprint)),void 0!==c.serial&&(this.dSerial=new x(c.serial)),void 0!==c.genTime&&(this.dGenTime=new F(c.genTime)),void 0!==c.accuracy&&(this.dAccuracy=new T(c.accuracy)),void 0!==c.ordering&&1==c.ordering&&(this.dOrdering=new E),void 0!==c.nonce&&(this.dNonce=new x(c.nonce)),void 0!==c.tsa&&(this.dTsa=new P({tag:"a0",explicit:!0,obj:new N({dn:c.tsa})}))}},extendClass(tt.asn1.tsp.TSTInfo,tt.asn1.ASN1Object),tt.asn1.tsp.Accuracy=function(c){var p=tt.asn1,v=p.ASN1Util.newObject;p.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=[];return void 0!=c.seconds&&"number"==typeof c.seconds&&p.push({int:c.seconds}),void 0!=c.millis&&"number"==typeof c.millis&&p.push({tag:{tagi:"80",obj:{int:c.millis}}}),void 0!=c.micros&&"number"==typeof c.micros&&p.push({tag:{tagi:"81",obj:{int:c.micros}}}),v({seq:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.Accuracy,tt.asn1.ASN1Object),tt.asn1.tsp.MessageImprint=function(c){var p=tt.asn1,v=p.DERSequence,x=p.DEROctetString,E=p.x509.AlgorithmIdentifier;p.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=new E({name:c.alg}),F=new x({hex:c.hash});return new v({array:[p,F]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.tsp.MessageImprint,tt.asn1.ASN1Object),tt.asn1.tsp.TimeStampReq=function(c){var p=tt.asn1,v=p.DERSequence,x=p.DERInteger,E=p.DERBoolean,F=(p.ASN1Object,p.DERObjectIdentifier),C=p.tsp,P=C.MessageImprint;C.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=[];return p.push(new x({int:1})),c.messageImprint instanceof tt.asn1.ASN1Object?p.push(c.messageImprint):p.push(new P(c.messageImprint)),void 0!=c.policy&&p.push(new F(c.policy)),void 0!=c.nonce&&p.push(new x(c.nonce)),1==c.certreq&&p.push(new E),new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.TimeStampReq,tt.asn1.ASN1Object),tt.asn1.tsp.TimeStampResp=function(c){var p=tt.asn1,v=p.DERSequence,x=(p.ASN1Object,p.tsp),E=x.PKIStatusInfo;x.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,F=[];if(void 0!=c.econtent||void 0!=c.tst)if(void 0!=c.statusinfo?F.push(new E(c.statusinfo)):F.push(new E("granted")),void 0!=c.econtent)F.push(new x.TimeStampToken(c).getContentInfo());else{if(!(c.tst instanceof p.ASN1Object))throw new Error("improper member tst value");F.push(c.tst)}else{if(void 0==c.statusinfo)throw new Error("parameter for token nor statusinfo not specified");F.push(new E(c.statusinfo))}return new v({array:F}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.TimeStampResp,tt.asn1.ASN1Object),tt.asn1.tsp.PKIStatusInfo=function(c){var p=Error,v=tt.asn1,x=v.DERSequence,E=v.tsp,F=E.PKIStatus,C=E.PKIFreeText,P=E.PKIFailureInfo;E.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,v=[];if("string"==typeof c)v.push(new F(c));else{if(void 0==c.status)throw new p("property 'status' unspecified");v.push(new F(c.status)),void 0!=c.statusstr&&v.push(new C(c.statusstr)),void 0!=c.failinfo&&v.push(new P(c.failinfo))}return new x({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.PKIStatusInfo,tt.asn1.ASN1Object),tt.asn1.tsp.PKIStatus=function(c){var p=Error,v=tt.asn1,x=v.DERInteger;v.tsp.PKIStatus.superclass.constructor.call(this);var E={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var c,v=this.params;if("string"==typeof v)try{c=E[v]}catch(F){throw new p("undefined name: "+v)}else{if("number"!=typeof v)throw new p("unsupported params");c=v}return new x({int:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.PKIStatus,tt.asn1.ASN1Object),tt.asn1.tsp.PKIFreeText=function(c){var p=Error,v=tt.asn1,x=v.DERSequence,E=v.DERUTF8String;v.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(!c instanceof Array)throw new p("wrong params: not array");for(var v=[],F=0;F<c.length;F++)v.push(new E({str:c[F]}));return new x({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.PKIFreeText,tt.asn1.ASN1Object),tt.asn1.tsp.PKIFailureInfo=function(c){var p=Error,v=tt.asn1,x=v.DERBitString,E=v.tsp.PKIFailureInfo,F={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};E.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var c=this.params,v=0;if("number"==typeof c&&0<=c&&c<=25){for(var x=(v|=1<<c).toString(2),E="",C=x.length-1;C>=0;C--)E+=x[C];return E}if("string"==typeof c&&void 0!=F[c])return namearraytobinstr([c],F);if("object"==typeof c&&void 0!=c.length)return namearraytobinstr(c,F);throw new p("wrong params")},this.tohex=function(){this.params;var c=this.getBinValue();return new x({bin:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.tsp.PKIFailureInfo,tt.asn1.ASN1Object),tt.asn1.tsp.AbstractTSAAdapter=function(c){this.getTSTHex=function(c,p){throw"not implemented yet"}},tt.asn1.tsp.SimpleTSAAdapter=function(c){var p=tt,v=p.asn1.tsp,x=p.crypto.Util.hashHex;v.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(c,p){var E=x(c,p);this.params.econtent.content.messageImprint={alg:p,hash:E},this.params.econtent.content.serial={int:this.serial++};var F=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:F},new v.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.tsp.SimpleTSAAdapter,tt.asn1.tsp.AbstractTSAAdapter),tt.asn1.tsp.FixedTSAAdapter=function(c){var p=tt,v=p.asn1.tsp,x=p.crypto.Util.hashHex;v.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(c,p){var E=x(c,p);return this.params.econtent.content.messageImprint={alg:p,hash:E},new v.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==c&&(this.params=c)},extendClass(tt.asn1.tsp.FixedTSAAdapter,tt.asn1.tsp.AbstractTSAAdapter),tt.asn1.tsp.TSPUtil=new function(){},tt.asn1.tsp.TSPUtil.newTimeStampToken=function(c){return new tt.asn1.tsp.TimeStampToken(c)},tt.asn1.tsp.TSPUtil.parseTimeStampReq=function(c){return(new tt.asn1.tsp.TSPParser).getTimeStampReq(c)},tt.asn1.tsp.TSPUtil.parseMessageImprint=function(c){return(new tt.asn1.tsp.TSPParser).getMessageImprint(c)},tt.asn1.tsp.TSPParser=function(){Error;var c=new X509,p=nt,v=p.getV,x=p.getTLV,E=p.getIdxbyList,F=(p.getTLVbyListEx,p.getChildIdx),C=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],P={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(c){var p=F(c,0);if(1==p.length)return this.getPKIStatusInfo(x(c,p[0]));if(p.length>1){var v=this.getPKIStatusInfo(x(c,p[0])),E=x(c,p[1]),C=this.getToken(E);return C.statusinfo=v,C}},this.getToken=function(c){var p=(new tt.asn1.cms.CMSParser).getCMSSignedData(c);return this.setTSTInfo(p),p},this.setTSTInfo=function(c){var p=c.econtent;if("tstinfo"==p.type){var v=p.content.hex,x=this.getTSTInfo(v);p.content=x}},this.getTSTInfo=function(p){var E={},C=F(p,0),P=v(p,C[1]);E.policy=hextooid(P);var R=x(p,C[2]);E.messageImprint=this.getMessageImprint(R);var B=v(p,C[3]);E.serial={hex:B};var T=v(p,C[4]);E.genTime={str:hextoutf8(T)};var N=0;if(C.length>5&&"30"==p.substr(C[5],2)){var _=x(p,C[5]);E.accuracy=this.getAccuracy(_),N++}C.length>5+N&&"01"==p.substr(C[5+N],2)&&("ff"==v(p,C[5+N])&&(E.ordering=!0),N++);if(C.length>5+N&&"02"==p.substr(C[5+N],2)){var L=v(p,C[5+N]);E.nonce={hex:L},N++}if(C.length>5+N&&"a0"==p.substr(C[5+N],2)){var V=x(p,C[5+N]);V="30"+V.substr(2),pGeneralNames=c.getGeneralNames(V);var U=pGeneralNames[0].dn;E.tsa=U,N++}if(C.length>5+N&&"a1"==p.substr(C[5+N],2)){var W=x(p,C[5+N]);W="30"+W.substr(2);var G=c.getExtParamArray(W);E.ext=G,N++}return E},this.getAccuracy=function(c){for(var p={},x=F(c,0),E=0;E<x.length;E++){var C=c.substr(x[E],2),P=v(c,x[E]),R=parseInt(P,16);"02"==C?p.seconds=R:"80"==C?p.millis=R:"81"==C&&(p.micros=R)}return p},this.getMessageImprint=function(c){if("30"!=c.substr(0,2))throw new Error("head of messageImprint hex shall be x30");var x={},C=(F(c,0),E(c,0,[0,0])),P=v(c,C),R=p.hextooidstr(P),B=tt.asn1.x509.OID.oid2name(R);if(""==B)throw new Error("hashAlg name undefined: "+R);var T=B,N=E(c,0,[1]);return x.alg=T,x.hash=v(c,N),x},this.getPKIStatusInfo=function(c){var p={},E=F(c,0),P=0;try{var R=v(c,E[0]),B=parseInt(R,16);p.status=C[B]}catch(_){}if(E.length>1&&"30"==c.substr(E[1],2)){var T=x(c,E[1]);p.statusstr=this.getPKIFreeText(T),P++}if(E.length>P&&"03"==c.substr(E[1+P],2)){var N=x(c,E[1+P]);p.failinfo=this.getPKIFailureInfo(N)}return p},this.getPKIFreeText=function(c){for(var v=[],x=F(c,0),E=0;E<x.length;E++)v.push(p.getString(c,x[E]));return v},this.getPKIFailureInfo=function(c){var v=p.getInt(c,0);return void 0!=P[v]?P[v]:v},this.getTimeStampReq=function(c){var E={certreq:!1},C=F(c,0);if(C.length<2)throw new Error("TimeStampReq must have at least 2 items");var P=x(c,C[1]);E.messageImprint=tt.asn1.tsp.TSPUtil.parseMessageImprint(P);for(var R=2;R<C.length;R++){var B=C[R],T=c.substr(B,2);if("06"==T){var N=v(c,B);E.policy=p.hextooidstr(N)}"02"==T&&(E.nonce=v(c,B)),"01"==T&&(E.certreq=!0)}return E}},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),"undefined"!=typeof tt.asn1.cades&&tt.asn1.cades||(tt.asn1.cades={}),tt.asn1.cades.SignaturePolicyIdentifier=function(c){var p=tt.asn1.cades,v=p.SignaturePolicyId;p.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new v(this.params)]},this.setByParam=function(c){this.params=c},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.SignaturePolicyIdentifier,tt.asn1.cms.Attribute),tt.asn1.cades.SignaturePolicyId=function(c){var p=tt.asn1,v=p.DERSequence,x=p.DERObjectIdentifier,E=(p.x509.AlgorithmIdentifier,p.cades),F=E.SignaturePolicyId,C=E.OtherHashAlgAndValue;F.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,p=[];return p.push(new x(c.oid)),p.push(new C(c)),new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.SignaturePolicyId,tt.asn1.ASN1Object),tt.asn1.cades.OtherHashAlgAndValue=function(c){var p=Error,v=tt.asn1,x=v.DERSequence,E=v.DEROctetString,F=v.x509.AlgorithmIdentifier;v.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(void 0==c.alg)throw new p("property 'alg' not specified");if(void 0==c.hash&&void 0==c.cert)throw new p("property 'hash' nor 'cert' not specified");var v=null;if(void 0!=c.hash)v=c.hash;else if(void 0!=c.cert){if("string"!=typeof c.cert)throw new p("cert not string");var C=c.cert;-1!=c.cert.indexOf("-----BEGIN")&&(C=pemtohex(c.cert)),v=tt.crypto.Util.hashHex(C,c.alg)}var P=[];return P.push(new F({name:c.alg})),P.push(new E({hex:v})),new x({array:P}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.OtherHashAlgAndValue,tt.asn1.ASN1Object),tt.asn1.cades.OtherHashValue=function(c){tt.asn1.cades.OtherHashValue.superclass.constructor.call(this);var p=Error,v=tt,x=(v.lang.String.isHex,v.asn1.DEROctetString);v.crypto.Util.hashHex;this.params=null,this.tohex=function(){var c=this.params;if(void 0==c.hash&&void 0==c.cert)throw new p("hash or cert not specified");var v=null;if(void 0!=c.hash)v=c.hash;else if(void 0!=c.cert){if("string"!=typeof c.cert)throw new p("cert not string");var E=c.cert;-1!=c.cert.indexOf("-----BEGIN")&&(E=pemtohex(c.cert)),v=tt.crypto.Util.hashHex(E,"sha1")}return new x({hex:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.OtherHashValue,tt.asn1.ASN1Object),tt.asn1.cades.SignatureTimeStamp=function(c){var p=Error,v=tt,x=v.lang.String.isHex,E=v.asn1,F=E.ASN1Object;E.x509;E.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var c=this.params;if(void 0!=c.tst){if(x(c.tst))return(E=new F).hTLV=c.tst,[E];if(c.tst instanceof F)return[c.tst];throw new p("params.tst has wrong value")}if(void 0!=c.res){var v=c.res;if(v instanceof F&&(v=v.tohex()),"string"!=typeof v||!x(v))throw new p("params.res has wrong value");var E;nt.getTLVbyList(v,0,[1]);return(E=new F).hTLV=c.tst,[E]}},null!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.SignatureTimeStamp,tt.asn1.cms.Attribute),tt.asn1.cades.CompleteCertificateRefs=function(c){var p=Error,v=tt,x=v.asn1,E=x.DERSequence,F=x.cades,C=F.OtherCertID,P=v.lang.String.isHex;F.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var c=this.params,v=[],x=0;x<c.array.length;x++){var F=c.array[x];if("string"==typeof F)if(-1!=F.indexOf("-----BEGIN"))F={cert:F};else{if(!P(F))throw new p("unsupported value: "+F);F={hash:F}}void 0!=c.alg&&void 0==F.alg&&(F.alg=c.alg),void 0!=c.hasis&&void 0==F.hasis&&(F.hasis=c.hasis);var R=new C(F);v.push(R)}return[new E({array:v})]},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.CompleteCertificateRefs,tt.asn1.cms.Attribute),tt.asn1.cades.OtherCertID=function(c){var p=tt.asn1,v=p.DERSequence,x=p.cms.IssuerSerial,E=p.cades,F=E.OtherHashValue,C=E.OtherHashAlgAndValue;E.OtherCertID.superclass.constructor.call(this),this.params=c,this.tohex=function(){var c=this.params;"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?c={cert:c}:_isHex(c)&&(c={hash:c}));var p=[],E=null;if(E=void 0!=c.alg?new C(c):new F(c),p.push(E),void 0!=c.cert&&1==c.hasis||void 0!=c.issuer&&void 0!=c.serial){var P=new x(c);p.push(P)}return new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.OtherCertID,tt.asn1.ASN1Object),tt.asn1.cades.OtherHash=function(c){Error;var p=tt,v=p.asn1,x=(v.cms,v.cades),E=x.OtherHashAlgAndValue,F=x.OtherHashValue,C=(p.crypto.Util.hashHex,p.lang.String.isHex);x.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?c={cert:c}:C(c)&&(c={hash:c}));return(void 0!=c.alg?new E(c):new F(c)).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.cades.OtherHash,tt.asn1.ASN1Object),tt.asn1.cades.CAdESUtil=new function(){},tt.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(c){return(new tt.asn1.cms.CMSParser).getCMSSignedData(c)},tt.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(c,p,v){var x=nt,E=x.getChildIdx,F=x.getTLV,C=x.getV,P=tt.asn1,R=P.ASN1Object,B=P.cms,T=B.AttributeList,N=B.SignerInfo,_={},L=E(c,p);if(6!=L.length)throw"not supported items for SignerInfo (!=6)";var V=L.shift();_.version=F(c,V);var U=L.shift();_.si=F(c,U);var W=L.shift();_.digalg=F(c,W);var G=L.shift();_.sattrs=F(c,G);var X=L.shift();_.sigalg=F(c,X);var J=L.shift();_.sig=F(c,J),_.sigval=C(c,J);var Z=null;return _.obj=new N,(Z=new R).hTLV=_.version,_.obj.dCMSVersion=Z,(Z=new R).hTLV=_.si,_.obj.dSignerIdentifier=Z,(Z=new R).hTLV=_.digalg,_.obj.dDigestAlgorithm=Z,(Z=new R).hTLV=_.sattrs,_.obj.dSignedAttrs=Z,(Z=new R).hTLV=_.sigalg,_.obj.dSigAlg=Z,(Z=new R).hTLV=_.sig,_.obj.dSig=Z,_.obj.dUnsignedAttrs=new T,_},"undefined"!=typeof tt.asn1.csr&&tt.asn1.csr||(tt.asn1.csr={}),tt.asn1.csr.CertificationRequest=function(c){var p=tt.asn1,v=p.DERBitString,x=p.DERSequence,E=p.csr,F=(p.x509,E.CertificationRequestInfo);E.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(c){this.params=c},this.sign=function(){var c=new F(this.params).tohex(),p=new tt.crypto.Signature({alg:this.params.sigalg});p.init(this.params.sbjprvkey),p.updateHex(c);var v=p.sign();this.params.sighex=v},this.getPEM=function(){return hextopem(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var c=this.params,p=new tt.asn1.csr.CertificationRequestInfo(this.params),E=new tt.asn1.x509.AlgorithmIdentifier({name:c.sigalg});if(void 0==c.sighex&&void 0!=c.sbjprvkey&&this.sign(),void 0==c.sighex)throw new Error("sighex or sbjprvkey parameter not defined");var F=new v({hex:"00"+c.sighex});return new x({array:[p,E,F]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.csr.CertificationRequest,tt.asn1.ASN1Object),tt.asn1.csr.CertificationRequestInfo=function(c){var p=tt.asn1,v=(p.DERBitString,p.DERSequence),x=p.DERInteger,E=p.DERUTF8String,F=p.DERTaggedObject,C=p.ASN1Util.newObject,P=p.csr,R=p.x509,B=R.X500Name,T=R.Extensions,N=R.SubjectPublicKeyInfo;P.AttributeList;P.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(c){void 0!=c&&(this.params=c)},this.tohex=function(){var c=this.params,p=[];if(p.push(new x({int:0})),p.push(new B(c.subject)),p.push(new N(it.getKey(c.sbjpubkey))),void 0!=c.attrs){var P=function m(c){for(var p=Error,v=tt.asn1.x509.Extensions,x=[],E=0;E<c.length;E++){var F=c[E],C=F.attr;if("extensionRequest"==C){var P={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new v(F.ext)]}]};x.push(P)}else if("unstructuredName"==C){P={seq:[{oid:"1.2.840.113549.1.9.2"},{set:F.names}]};x.push(P)}else{if("challengePassword"!=C)throw new p("unknown CSR attribute");P={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:F.password}]}]};x.push(P)}}return{set:x}}(c.attrs),R=C({tag:{tage:"a0",obj:P}});p.push(R)}else if(void 0!=c.extreq){var _=new T(c.extreq);R=C({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[_]}]}}});p.push(R)}else p.push(new F({tag:"a0",explicit:!1,obj:new E({str:""})}));return new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=c&&this.setByParam(c)},extendClass(tt.asn1.csr.CertificationRequestInfo,tt.asn1.ASN1Object),tt.asn1.csr.AttributeList=function(c){},extendClass(tt.asn1.csr.AttributeList,tt.asn1.ASN1Object),tt.asn1.csr.CSRUtil=new function(){},tt.asn1.csr.CSRUtil.newCSRPEM=function(c){return new tt.asn1.csr.CertificationRequest(c).getPEM()},tt.asn1.csr.CSRUtil.getParam=function(c,p){var v=nt,x=v.getV,E=v.getIdxbyList,F=v.getTLVbyList,C=v.getTLVbyListEx,P=v.getVbyListEx,R={};if(-1==c.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw new Error("argument is not PEM file");var B=pemtohex(c,"CERTIFICATE REQUEST");p&&(R.tbs=F(B,0,[0]));try{var T=C(B,0,[0,1]);if("3000"==T)R.subject={};else{var N=new X509;R.subject=N.getX500Name(T)}}catch(G){}var _=C(B,0,[0,2]),L=it.getKey(_,null,"pkcs8pub");R.sbjpubkey=it.getPEM(L,"PKCS8PUB");var V=function(c){var p=E(c,0,[0,3,0,0],"06");return"2a864886f70d01090e"!=x(c,p)?null:F(c,0,[0,3,0,1,0],"30")}(B);N=new X509;null!=V&&(R.extreq=N.getExtParamArray(V));try{var U=C(B,0,[1],"30");N=new X509;R.sigalg=N.getAlgorithmIdentifierName(U)}catch(G){}try{var W=P(B,0,[2]);R.sighex=W}catch(G){}return R},tt.asn1.csr.CSRUtil.verifySignature=function(c){try{var p=null;if("string"==typeof c&&-1!=c.indexOf("-----BEGIN CERTIFICATE REQUEST")?p=tt.asn1.csr.CSRUtil.getParam(c,!0):"object"==typeof c&&void 0!=c.sbjpubkey&&void 0!=c.sigalg&&void 0!=c.sighex&&void 0!=c.tbs&&(p=c),null==p)return!1;var v=new tt.crypto.Signature({alg:p.sigalg});return v.init(p.sbjpubkey),v.updateHex(p.tbs),v.verify(p.sighex)}catch(x){return alert(x),!1}},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.asn1&&tt.asn1||(tt.asn1={}),"undefined"!=typeof tt.asn1.ocsp&&tt.asn1.ocsp||(tt.asn1.ocsp={}),tt.asn1.ocsp.DEFAULT_HASH="sha1",tt.asn1.ocsp.OCSPResponse=function(c){tt.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);tt.asn1.DEREnumerated;var p=tt.asn1.ASN1Util.newObject,v=tt.asn1.ocsp.ResponseBytes,x=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var c=this.params.resstatus;return"number"==typeof c?c:"string"!=typeof c?-1:x.indexOf(c)},this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params,x=this._getStatusCode();if(-1==x)throw new Error("responseStatus not supported: "+c.resstatus);if(0!=x)return p({seq:[{enum:{int:x}}]}).tohex();var E=new v(c);return p({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:E}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.OCSPResponse,tt.asn1.ASN1Object),tt.asn1.ocsp.ResponseBytes=function(c){tt.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var p=tt.asn1,v=p.DERSequence,x=p.DERObjectIdentifier,E=p.DEROctetString,F=p.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params;if("ocspBasic"!=c.restype)throw new Error("not supported responseType: "+c.restype);var p=new F(c),C=[];return C.push(new x({name:"ocspBasic"})),C.push(new E({hex:p.tohex()})),new v({array:C}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.ResponseBytes,tt.asn1.ASN1Object),tt.asn1.ocsp.BasicOCSPResponse=function(c){tt.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var p=Error,v=tt.asn1,x=v.ASN1Object,E=v.DERSequence,F=(v.DERGeneralizedTime,v.DERTaggedObject),C=v.DERBitString,P=(v.x509.Extensions,v.x509.AlgorithmIdentifier),R=v.ocsp;R.ResponderID;_SingleResponseList=R.SingleResponseList,_ResponseData=R.ResponseData,this.params=null,this.setByParam=function(c){this.params=c},this.sign=function(){var c=this.params,p=c.tbsresp.tohex(),v=new tt.crypto.Signature({alg:c.sigalg});v.init(c.reskey),v.updateHex(p),c.sighex=v.sign()},this.tohex=function(){var c=this.params;void 0==c.tbsresp&&(c.tbsresp=new _ResponseData(c)),void 0==c.sighex&&void 0!=c.reskey&&this.sign();var v=[];if(v.push(c.tbsresp),v.push(new P({name:c.sigalg})),v.push(new C({hex:"00"+c.sighex})),void 0!=c.certs&&void 0!=c.certs.length){for(var R=[],B=0;B<c.certs.length;B++){var T=c.certs[B],N=null;if(nt.isASN1HEX(T))N=T;else{if(!T.match(/-----BEGIN/))throw new p("certs["+B+"] not hex or PEM");N=pemtohex(T)}R.push(new x({tlv:N}))}var _=new E({array:R});v.push(new F({tag:"a0",explicit:!0,obj:_}))}return new E({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.BasicOCSPResponse,tt.asn1.ASN1Object),tt.asn1.ocsp.ResponseData=function(c){tt.asn1.ocsp.ResponseData.superclass.constructor.call(this);var p=Error,v=tt.asn1,x=v.DERSequence,E=v.DERGeneralizedTime,F=v.DERTaggedObject,C=v.x509.Extensions,P=v.ocsp,R=P.ResponderID;_SingleResponseList=P.SingleResponseList,this.params=null,this.tohex=function(){var c=this.params;void 0!=c.respid&&new p("respid not specified"),void 0!=c.prodat&&new p("prodat not specified"),void 0!=c.array&&new p("array not specified");var v=[];if(v.push(new R(c.respid)),v.push(new E(c.prodat)),v.push(new _SingleResponseList(c.array)),void 0!=c.ext){var P=new C(c.ext);v.push(new F({tag:"a1",explicit:!0,obj:P}))}return new x({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.ResponseData,tt.asn1.ASN1Object),tt.asn1.ocsp.ResponderID=function(c){tt.asn1.ocsp.ResponderID.superclass.constructor.call(this);var p=tt,v=p.asn1,x=v.ASN1Util.newObject,E=v.x509.X500Name,F=p.lang.String.isHex,C=Error;this.params=null,this.tohex=function(){var c=this.params;if(void 0!=c.key){var p,v=null;if("string"==typeof c.key){if(F(c.key)&&(v=c.key),c.key.match(/-----BEGIN CERTIFICATE/))null!=(p=new X509(c.key).getExtSubjectKeyIdentifier())&&(v=p.kid.hex)}else if(c.key instanceof X509)null!=(p=c.key.getExtSubjectKeyIdentifier())&&(v=p.kid.hex);if(null==v)throw new C("wrong key member value");return x({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:v}}}}).tohex()}if(void 0!=c.name){var P=null;if("string"==typeof c.name&&c.name.match(/-----BEGIN CERTIFICATE/))P=new X509(c.name).getSubject();else c.name instanceof X509?P=c.name.getSubject():"object"!=typeof c.name||void 0==c.name.array&&void 0==c.name.str||(P=c.name);if(null==P)throw new C("wrong name member value");return x({tag:{tag:"a1",explicit:!0,obj:new E(P)}}).tohex()}throw new C("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.ResponderID,tt.asn1.ASN1Object),tt.asn1.ocsp.SingleResponseList=function(c){tt.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var p=tt.asn1,v=p.DERSequence,x=p.ocsp.SingleResponse;this.params=null,this.tohex=function(){var c=this.params;if("object"!=typeof c||void 0==c.length)throw new Error("params not specified properly");for(var p=[],E=0;E<c.length;E++)p.push(new x(c[E]));return new v({array:p}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.SingleResponseList,tt.asn1.ASN1Object),tt.asn1.ocsp.SingleResponse=function(c){var p=Error,v=tt.asn1,x=v.DERSequence,E=v.DERGeneralizedTime,F=v.DERTaggedObject,C=v.ocsp,P=C.CertID,R=C.CertStatus,B=v.x509.Extensions;C.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params,v=[];if(void 0==c.certid)throw new p("certid unspecified");if(void 0==c.status)throw new p("status unspecified");if(void 0==c.thisupdate)throw new p("thisupdate unspecified");if(v.push(new P(c.certid)),v.push(new R(c.status)),v.push(new E(c.thisupdate)),void 0!=c.nextupdate){var C=new E(c.nextupdate);v.push(new F({tag:"a0",explicit:!0,obj:C}))}if(void 0!=c.ext){var T=new B(c.ext);v.push(new F({tag:"a1",explicit:!0,obj:T}))}return new x({array:v}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.SingleResponse,tt.asn1.ASN1Object),tt.asn1.ocsp.CertID=function(c){var p=tt,v=p.asn1,x=v.DEROctetString,E=v.DERInteger,F=v.DERSequence,C=v.x509.AlgorithmIdentifier,P=v.ocsp,R=(P.DEFAULT_HASH,p.crypto.Util.hashHex),B=X509,T=nt.getVbyList;P.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(c,p,v,x){void 0==x&&(x=this.DEFAULT_HASH),this.params={alg:x,issname:c,isskey:p,sbjsn:v}},this.setByCert=function(c,p,v){void 0==v&&(v=this.DEFAULT_HASH),this.params={alg:v,issuerCert:c,subjectCert:p}},this.getParamByCerts=function(c,p,v){void 0==v&&(v=this.DEFAULT_HASH);var x=new B(c),E=new B(p),F=R(x.getSubjectHex(),v),C=x.getPublicKeyHex();return{alg:v,issname:F,isskey:R(T(C,0,[1],"03",!0),v),sbjsn:E.getSerialNumberHex()}},this.tohex=function(){if("object"!=typeof this.params)throw new Error("params not set");var c,p,v,P,R=this.params;if(P=void 0==R.alg?this.DEFAULT_HASH:R.alg,void 0!=R.issuerCert&&void 0!=R.subjectCert){var B=this.getParamByCerts(R.issuerCert,R.subjectCert,P);c=B.issname,p=B.isskey,v=B.sbjsn}else{if(void 0==R.issname||void 0==R.isskey||void 0==R.sbjsn)throw new Error("required param members not defined");c=R.issname,p=R.isskey,v=R.sbjsn}var T=new C({name:P}),N=new x({hex:c}),_=new x({hex:p}),L=new E({hex:v}),V=new F({array:[T,N,_,L]});return this.hTLV=V.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.CertID,tt.asn1.ASN1Object),tt.asn1.ocsp.CertStatus=function(c){tt.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if("good"==c.status)return"8000";if("unknown"==c.status)return"8200";if("revoked"==c.status){var p=[{gentime:{str:c.time}}];void 0!=c.reason&&p.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:c.reason}}}});var v={tag:"a1",explicit:!1,obj:{seq:p}};return tt.asn1.ASN1Util.newObject({tag:v}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},void 0!==c&&this.setByParam(c)},extendClass(tt.asn1.ocsp.CertStatus,tt.asn1.ASN1Object),tt.asn1.ocsp.Request=function(c){var p=tt.asn1,v=p.DERSequence,x=p.ocsp;if(x.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var c=[];if(null===this.dReqCert)throw"reqCert not set";c.push(this.dReqCert);var p=new v({array:c});return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},"undefined"!==typeof c){var E=new x.CertID(c);this.dReqCert=E}},extendClass(tt.asn1.ocsp.Request,tt.asn1.ASN1Object),tt.asn1.ocsp.TBSRequest=function(c){var p=tt.asn1,v=p.DERSequence,x=p.ocsp;x.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(c){for(var p=[],v=0;v<c.length;v++){var E=new x.Request(c[0]);p.push(E)}this.dRequestList=p},this.tohex=function(){var c=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var p=new v({array:this.dRequestList});if(c.push(p),null!==this.dRequestExt)throw"requestExtensions not supported";var x=new v({array:c});return this.hTLV=x.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&void 0!==c.reqList&&this.setRequestListByParam(c.reqList)},extendClass(tt.asn1.ocsp.TBSRequest,tt.asn1.ASN1Object),tt.asn1.ocsp.OCSPRequest=function(c){var p=tt.asn1,v=p.DERSequence,x=p.ocsp;if(x.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var c=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(c.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var p=new v({array:c});return this.hTLV=p.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==c&&void 0!==c.reqList){var E=new x.TBSRequest(c);this.dTbsRequest=E}},extendClass(tt.asn1.ocsp.OCSPRequest,tt.asn1.ASN1Object),tt.asn1.ocsp.OCSPUtil={},tt.asn1.ocsp.OCSPUtil.getRequestHex=function(c,p,v){var x=tt.asn1.ocsp;void 0===v&&(v=x.DEFAULT_HASH);var E={alg:v,issuerCert:c,subjectCert:p};return new x.OCSPRequest({reqList:[E]}).tohex()},tt.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(c){var p=nt,v=p.getVbyList,x=p.getVbyListEx,E=p.getIdxbyList,F=(p.getIdxbyListEx,p.getV),C={};try{var P=x(c,0,[0],"0a");C.responseStatus=parseInt(P,16)}catch(N){}if(0!==C.responseStatus)return C;try{var R=E(c,0,[1,0,1,0,0,2,0,1]);"80"===c.substr(R,2)?C.certStatus="good":"a1"===c.substr(R,2)?(C.certStatus="revoked",C.revocationTime=hextoutf8(v(c,R,[0]))):"82"===c.substr(R,2)&&(C.certStatus="unknown")}catch(N){}try{var B=E(c,0,[1,0,1,0,0,2,0,2]);C.thisUpdate=hextoutf8(F(c,B))}catch(N){}try{var T=E(c,0,[1,0,1,0,0,2,0,3]);"a0"===c.substr(T,2)&&(C.nextUpdate=hextoutf8(v(c,T,[0])))}catch(N){}return C},tt.asn1.ocsp.OCSPParser=function(){var c=Error,p=X509,v=new p,x=nt,E=x.getV,F=x.getTLV,C=x.getIdxbyList,P=x.getVbyList,R=x.getTLVbyList,B=x.getVbyListEx,T=x.getTLVbyListEx,N=x.getChildIdx;this.getOCSPRequest=function(p){var v=N(p,0);if(1!=v.length&&2!=v.length)throw new c("wrong number elements: "+v.length);return this.getTBSRequest(F(p,v[0]))},this.getTBSRequest=function(c){var p={},x=T(c,0,[0],"30");p.array=this.getRequestList(x);var E=T(c,0,["[2]",0],"30");return null!=E&&(p.ext=v.getExtParamArray(E)),p},this.getRequestList=function(c){for(var p=[],v=N(c,0),x=0;x<v.length;x++){c=F(c,v[x]);p.push(this.getRequest(c))}return p},this.getRequest=function(p){var x=N(p,0);if(1!=x.length&&2!=x.length)throw new c("wrong number elements: "+x.length);var E=this.getCertID(F(p,x[0]));if(2==x.length){var P=C(p,0,[1,0]);E.ext=v.getExtParamArray(F(p,P))}return E},this.getCertID=function(v){var x=N(v,0);if(4!=x.length)throw new c("wrong number elements: "+x.length);var C=new p,P={};return P.alg=C.getAlgorithmIdentifierName(F(v,x[0])),P.issname=E(v,x[1]),P.isskey=E(v,x[2]),P.sbjsn=E(v,x[3]),P},this.getOCSPResponse=function(c){var p,v=N(c,0),x=E(c,v[0]),F=parseInt(x);if(1==v.length)return{resstatus:F};var C=R(c,0,[1,0]);return(p=this.getResponseBytes(C)).resstatus=F,p},this.getResponseBytes=function(c){var p,v=N(c,0),x=R(c,0,[1,0]);p=this.getBasicOCSPResponse(x);var F=E(c,v[0]);return p.restype=tt.asn1.x509.OID.oid2name(hextooid(F)),p},this.getBasicOCSPResponse=function(c){var p,v=N(c,0);p=this.getResponseData(F(c,v[0]));var x=new X509;p.alg=x.getAlgorithmIdentifierName(F(c,v[1]));var C=E(c,v[2]);p.sighex=C.substr(2);var P=B(c,0,["[0]"]);if(null!=P){for(var R=N(P,0),T=[],_=0;_<R.length;_++){var L=F(P,R[_]);T.push(L)}p.certs=T}return p},this.getResponseData=function(c){var p=N(c,0),v=p.length,x={},C=0;"a0"==c.substr(p[0],2)&&C++,x.respid=this.getResponderID(F(c,p[C++]));var P=E(c,p[C++]);if(x.prodat=hextoutf8(P),x.array=this.getSingleResponseList(F(c,p[C++])),"a1"==c.substr(p[v-1],2)){var B=R(c,p[v-1],[0]),T=new X509;x.ext=T.getExtParamArray(B)}return x},this.getResponderID=function(c){var p={};if("a2"==c.substr(0,2)){var v=P(c,0,[0]);p.key=v}if("a1"==c.substr(0,2)){var x=R(c,0,[0]),E=new X509;p.name=E.getX500Name(x)}return p},this.getSingleResponseList=function(c){for(var p=N(c,0),v=[],x=0;x<p.length;x++){var E=this.getSingleResponse(F(c,p[x]));v.push(E)}return v},this.getSingleResponse=function(c){var p=N(c,0),v={},x=this.getCertID(F(c,p[0]));v.certid=x;var C=this.getCertStatus(F(c,p[1]));if(v.status=C,"18"==c.substr(p[2],2)){var B=E(c,p[2]);v.thisupdate=hextoutf8(B)}for(var T=3;T<p.length;T++){if("a0"==c.substr(p[T],2)){var _=P(c,p[T],[0],"18");v.nextupdate=hextoutf8(_)}if("a1"==c.substr(p[T],2)){var L=new X509,V=R(c,0,[T,0]);v.ext=L.getExtParamArray(V)}}return v},this.getCertStatus=function(c){var p={};if("8000"==c)return{status:"good"};if("8200"==c)return{status:"unknown"};if("a1"==c.substr(0,2)){p.status="revoked";var v=hextoutf8(P(c,0,[0]));p.time=v}return p}},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.lang&&tt.lang||(tt.lang={}),tt.lang.String=function(){},"function"===typeof Buffer?(et=function(c){return b64tob64u(Buffer.from(c,"utf8").toString("base64"))},rt=function(c){return Buffer.from(b64utob64(c),"base64").toString("utf8")}):(et=function(c){return hextob64u(uricmptohex(encodeURIComponentAll(c)))},rt=function(c){return decodeURIComponent(hextouricmp(b64utohex(c)))}),tt.lang.String.isInteger=function(c){return!!c.match(/^[0-9]+$/)||!!c.match(/^-[0-9]+$/)},tt.lang.String.isHex=function(c){return ishex(c)},tt.lang.String.isBase64=function(c){return!(!(c=c.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||c.length%4!=0)},tt.lang.String.isBase64URL=function(c){return!c.match(/[+/=]/)&&(c=b64utob64(c),tt.lang.String.isBase64(c))},tt.lang.String.isIntegerArray=function(c){return!!(c=c.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},tt.lang.String.isPrintable=function(c){return null!==c.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},tt.lang.String.isIA5=function(c){return null!==c.match(/^[\x20-\x21\x23-\x7f]*$/)},tt.lang.String.isMail=function(c){return null!==c.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};function oidtohex(c){var f=function(c){var p=c.toString(16);return 1==p.length&&(p="0"+p),p},e=function(c){var p="",v=parseInt(c,10).toString(2),x=7-v.length%7;7==x&&(x=0);for(var E="",F=0;F<x;F++)E+="0";v=E+v;for(F=0;F<v.length-1;F+=7){var C=v.substr(F,7);F!=v.length-7&&(C="1"+C),p+=f(parseInt(C,2))}return p};try{if(!c.match(/^[0-9.]+$/))return null;var p="",v=c.split("."),x=40*parseInt(v[0],10)+parseInt(v[1],10);p+=f(x),v.splice(0,2);for(var E=0;E<v.length;E++)p+=e(v[E]);return p}catch(F){return null}}function hextooid(c){if(!ishex(c))return null;try{var p=[],v=c.substr(0,2),x=parseInt(v,16);p[0]=new String(Math.floor(x/40)),p[1]=new String(x%40);for(var E=c.substr(2),F=[],C=0;C<E.length/2;C++)F.push(parseInt(E.substr(2*C,2),16));var P=[],R="";for(C=0;C<F.length;C++)128&F[C]?R+=strpad((127&F[C]).toString(2),7):(R+=strpad((127&F[C]).toString(2),7),P.push(new String(parseInt(R,2))),R="");var B=p.join(".");return P.length>0&&(B=B+"."+P.join(".")),B}catch(T){return null}}function inttohex(c){return twoscompl(new BigInteger(String(c),10))}function twoscompl(c){var p=c.toString(16);if("-"!=p.substr(0,1))return p.length%2==1?p="0"+p:p.match(/^[0-7]/)||(p="00"+p),p;var v=p.substr(1).length;v%2==1?v+=1:p.match(/^[0-7]/)||(v+=2);for(var x="",E=0;E<v;E++)x+="f";return p=new BigInteger(x,16).xor(c).add(BigInteger.ONE).toString(16).replace(/^-/,"")}var strpad=function(c,p,v){return void 0==v&&(v="0"),c.length>=p?c:new Array(p-c.length+1).join(v)+c};function bitstrtoint(c){if(c.length%2!=0)return-1;if(null==(c=c.toLowerCase()).match(/^[0-9a-f]+$/))return-1;try{var p=c.substr(0,2);if("00"==p)return parseInt(c.substr(2),16);var v=parseInt(p,16);if(v>7)return-1;var x=c.substr(2),E=parseInt(x,16).toString(2);"0"==E&&(E="00000000"),E=E.slice(0,0-v);var F=parseInt(E,2);return NaN==F?-1:F}catch(C){return-1}}function inttobitstr(c){if("number"!=typeof c)return null;if(c<0)return null;var p=Number(c).toString(2),v=8-p.length%8;8==v&&0,strpad("",v,"0");var x=parseInt(p,2).toString(16);return x.length%2==1&&"0"+x,"0"+v+x}function bitstrtobinstr(c){if("string"!=typeof c)return null;if(c.length%2!=0)return null;if(!c.match(/^[0-9a-f]+$/))return null;try{var p=parseInt(c.substr(0,2),16);if(p<0||7<p)return null;for(var v=c.substr(2),x="",E=0;E<v.length;E+=2){var F=v.substr(E,2),C=parseInt(F,16).toString(2);x+=C=("0000000"+C).slice(-8)}return x.substr(0,x.length-p)}catch(P){return null}}function namearraytobinstr(c,p){for(var v=0,x=0;x<c.length;x++)v|=1<<p[c[x]];var E=v.toString(2),F="";for(x=E.length-1;x>=0;x--)F+=E[x];return F}function aryval(c,p,v){if("object"==typeof c){p=String(p).split(".");for(var x=0;x<p.length&&c;x++){var E=p[x];E.match(/^[0-9]+$/)&&(E=parseInt(E)),c=c[E]}return c||!1===c?c:v}}function extendClass(c,p){var b=function(){};b.prototype=p.prototype,c.prototype=new b,c.prototype.constructor=c,c.superclass=p.prototype,p.prototype.constructor==Object.prototype.constructor&&(p.prototype.constructor=p)}"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.crypto&&tt.crypto||(tt.crypto={}),tt.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:E.algo.MD5,sha1:E.algo.SHA1,sha224:E.algo.SHA224,sha256:E.algo.SHA256,sha384:E.algo.SHA384,sha512:E.algo.SHA512,ripemd160:E.algo.RIPEMD160},this.getDigestInfoHex=function(c,p){if("undefined"==typeof this.DIGESTINFOHEAD[p])throw"alg not supported in Util.DIGESTINFOHEAD: "+p;return this.DIGESTINFOHEAD[p]+c},this.getPaddedDigestInfoHex=function(c,p,v){var x=this.getDigestInfoHex(c,p),E=v/4;if(x.length+22>E)throw"key is too short for SigAlg: keylen="+v+","+p;for(var F="0001",C="00"+x,P="",R=E-4-C.length,B=0;B<R;B+=2)P+="ff";return F+P+C},this.hashString=function(c,p){return new tt.crypto.MessageDigest({alg:p}).digestString(c)},this.hashHex=function(c,p){return new tt.crypto.MessageDigest({alg:p}).digestHex(c)},this.sha1=function(c){return this.hashString(c,"sha1")},this.sha256=function(c){return this.hashString(c,"sha256")},this.sha256Hex=function(c){return this.hashHex(c,"sha256")},this.sha512=function(c){return this.hashString(c,"sha512")},this.sha512Hex=function(c){return this.hashHex(c,"sha512")},this.isKey=function(c){return c instanceof RSAKey||c instanceof tt.crypto.DSA||c instanceof tt.crypto.ECDSA}},tt.crypto.Util.md5=function(c){return new tt.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(c)},tt.crypto.Util.ripemd160=function(c){return new tt.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(c)},tt.crypto.Util.SECURERANDOMGEN=new SecureRandom,tt.crypto.Util.getRandomHexOfNbytes=function(c){var p=new Array(c);return tt.crypto.Util.SECURERANDOMGEN.nextBytes(p),BAtohex(p)},tt.crypto.Util.getRandomBigIntegerOfNbytes=function(c){return new BigInteger(tt.crypto.Util.getRandomHexOfNbytes(c),16)},tt.crypto.Util.getRandomHexOfNbits=function(c){var p=c%8,v=new Array((c-p)/8+1);return tt.crypto.Util.SECURERANDOMGEN.nextBytes(v),v[0]=(255<<p&255^255)&v[0],BAtohex(v)},tt.crypto.Util.getRandomBigIntegerOfNbits=function(c){return new BigInteger(tt.crypto.Util.getRandomHexOfNbits(c),16)},tt.crypto.Util.getRandomBigIntegerZeroToMax=function(c){for(var p=c.bitLength();;){var v=tt.crypto.Util.getRandomBigIntegerOfNbits(p);if(-1!=c.compareTo(v))return v}},tt.crypto.Util.getRandomBigIntegerMinToMax=function(c,p){var v=c.compareTo(p);if(1==v)throw"biMin is greater than biMax";if(0==v)return c;var x=p.subtract(c);return tt.crypto.Util.getRandomBigIntegerZeroToMax(x).add(c)},tt.crypto.MessageDigest=function(c){this.setAlgAndProvider=function(c,p){if(null!==(c=tt.crypto.MessageDigest.getCanonicalAlgName(c))&&void 0===p&&(p=tt.crypto.Util.DEFAULTPROVIDER[c]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)&&"cryptojs"==p){try{this.md=tt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c].create()}catch(v){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+v}this.updateString=function(c){this.md.update(c)},this.updateHex=function(c){var p=E.enc.Hex.parse(c);this.md.update(p)},this.digest=function(){return this.md.finalize().toString(E.enc.Hex)},this.digestString=function(c){return this.updateString(c),this.digest()},this.digestHex=function(c){return this.updateHex(c),this.digest()}}if(-1!=":sha256:".indexOf(c)&&"sjcl"==p){try{this.md=new sjcl.hash.sha256}catch(v){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+v}this.updateString=function(c){this.md.update(c)},this.updateHex=function(c){var p=sjcl.codec.hex.toBits(c);this.md.update(p)},this.digest=function(){var c=this.md.finalize();return sjcl.codec.hex.fromBits(c)},this.digestString=function(c){return this.updateString(c),this.digest()},this.digestHex=function(c){return this.updateHex(c),this.digest()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==c&&void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=tt.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},tt.crypto.MessageDigest.getCanonicalAlgName=function(c){return"string"===typeof c&&(c=(c=c.toLowerCase()).replace(/-/,"")),c},tt.crypto.MessageDigest.getHashLength=function(c){var p=tt.crypto.MessageDigest,v=p.getCanonicalAlgName(c);if(void 0===p.HASHLENGTH[v])throw"not supported algorithm: "+c;return p.HASHLENGTH[v]},tt.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},tt.crypto.Mac=function(c){this.setAlgAndProvider=function(c,p){if(null==(c=c.toLowerCase())&&(c="hmacsha1"),"hmac"!=(c=c.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+c;void 0===p&&(p=tt.crypto.Util.DEFAULTPROVIDER[c]),this.algProv=c+"/"+p;var v=c.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(v)&&"cryptojs"==p){try{var x=tt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[v];this.mac=E.algo.HMAC.create(x,this.pass)}catch(F){throw"setAlgAndProvider hash alg set fail hashAlg="+v+"/"+F}this.updateString=function(c){this.mac.update(c)},this.updateHex=function(c){var p=E.enc.Hex.parse(c);this.mac.update(p)},this.doFinal=function(){return this.mac.finalize().toString(E.enc.Hex)},this.doFinalString=function(c){return this.updateString(c),this.doFinal()},this.doFinalHex=function(c){return this.updateHex(c),this.doFinal()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(c){if("string"==typeof c){var p=c;return c.length%2!=1&&c.match(/^[0-9A-Fa-f]+$/)||(p=rstrtohex(c)),void(this.pass=E.enc.Hex.parse(p))}if("object"!=typeof c)throw"KJUR.crypto.Mac unsupported password type: "+c;p=null;if(void 0!==c.hex){if(c.hex.length%2!=0||!c.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+c.hex;p=c.hex}if(void 0!==c.utf8&&(p=utf8tohex(c.utf8)),void 0!==c.rstr&&(p=rstrtohex(c.rstr)),void 0!==c.b64&&(p=b64tohex(c.b64)),void 0!==c.b64u&&(p=b64utohex(c.b64u)),null==p)throw"KJUR.crypto.Mac unsupported password type: "+c;this.pass=E.enc.Hex.parse(p)},void 0!==c&&(void 0!==c.pass&&this.setPassword(c.pass),void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov&&(this.provName=tt.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},tt.crypto.Signature=function(c){var p=null;if(this._setAlgNames=function(){var c=this.algName.match(/^(.+)with(.+)$/);c&&(this.mdAlgName=c[1].toLowerCase(),this.pubkeyAlgName=c[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(c,p){for(var v="",x=p/4-c.length,E=0;E<x;E++)v+="0";return v+c},this.setAlgAndProvider=function(c,p){if(this._setAlgNames(),"cryptojs/jsrsa"!=p)throw new Error("provider not supported: "+p);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new tt.crypto.MessageDigest({alg:this.mdAlgName})}catch(v){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+v)}this.init=function(c,p){var v=null;try{v=void 0===p?it.getKey(c):it.getKey(c,p)}catch(x){throw"init failed:"+x}if(!0===v.isPrivate)this.prvKey=v,this.state="SIGN";else{if(!0!==v.isPublic)throw"init failed.:"+v;this.pubKey=v,this.state="VERIFY"}},this.updateString=function(c){this.md.updateString(c)},this.updateHex=function(c){this.md.updateHex(c)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==tt.crypto.ECDSA&&(this.prvKey=new tt.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof tt.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof tt.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(c){return this.updateString(c),this.sign()},this.signHex=function(c){return this.updateHex(c),this.sign()},this.verify=function(c){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==tt.crypto.ECDSA&&(this.pubKey=new tt.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof RSAKey&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,c,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof RSAKey&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,c);if(void 0!==tt.crypto.ECDSA&&this.pubKey instanceof tt.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,c);if(void 0!==tt.crypto.DSA&&this.pubKey instanceof tt.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,c);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(c,p){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(c){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(c){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(c){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(c){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=c,void 0!==c&&(void 0!==c.alg&&(this.algName=c.alg,void 0===c.prov?this.provName=tt.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=c.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==c.psssaltlen&&(this.pssSaltLen=c.psssaltlen),void 0!==c.prvkeypem)){if(void 0!==c.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{p=it.getKey(c.prvkeypem);this.init(p)}catch(v){throw"fatal error to load pem private key: "+v}}},tt.crypto.Cipher=function(c){},tt.crypto.Cipher.encrypt=function(c,p,v,x){if(void 0!=aryval(x,"enclag")&&(v=x.encalg),"string"==typeof v&&"-CBC"==v.substr(-4)){var F=p,C=c;void 0!=aryval(x,"key")&&(F=x.key),void 0!=aryval(x,"enc")&&(hEnc=x.enc);var P,R=E.enc.Hex.parse(F),B=E.enc.Hex.parse(C),T=E.enc.Hex.parse(x.iv);if("des-EDE3-CBC"==v)P=E.TripleDES.encrypt(B,R,{iv:T});else{if("aes128-CBC"!=v&&"aes256-CBC"!=v)throw new Error("unsupported algorithm: "+v);P=E.AES.encrypt(B,R,{iv:T})}return P+""}if(p instanceof RSAKey&&p.isPublic){var N=tt.crypto.Cipher.getAlgByKeyAndName(p,v);if("RSA"===N)return p.encrypt(c);if("RSAOAEP"===N)return p.encryptOAEP(c,"sha1");var _=N.match(/^RSAOAEP(\d+)$/);if(null!==_)return p.encryptOAEP(c,"sha"+_[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+v}throw"Cipher.encrypt: unsupported key or algorithm"},tt.crypto.Cipher.decrypt=function(c,p,v,x){if(void 0!=aryval(x,"enclag")&&(v=x.encalg),"string"==typeof v&&"-CBC"==v.substr(-4)){var F=p,C=c;void 0!=aryval(x,"key")&&(F=x.key),void 0!=aryval(x,"enc")&&(C=x.enc);var P,R=E.enc.Hex.parse(F),B=E.enc.Hex.parse(C),T=E.enc.Hex.parse(x.iv);if("des-EDE3-CBC"==v)P=E.TripleDES.decrypt({ciphertext:B},R,{iv:T});else{if("aes128-CBC"!=v&&"aes256-CBC"!=v)throw new Error("unsupported algorithm: "+v);P=E.AES.decrypt({ciphertext:B},R,{iv:T})}return E.enc.Hex.stringify(P)}if(p instanceof RSAKey&&p.isPrivate){var N=tt.crypto.Cipher.getAlgByKeyAndName(p,v);if("RSA"===N)return p.decrypt(c);if("RSAOAEP"===N)return p.decryptOAEP(c,"sha1");var _=N.match(/^RSAOAEP(\d+)$/);if(null!==_)return p.decryptOAEP(c,"sha"+_[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+v}throw"Cipher.decrypt: unsupported key or algorithm"},tt.crypto.Cipher.getAlgByKeyAndName=function(c,p){if(c instanceof RSAKey){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(p))return p;if(null===p||void 0===p)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+p}throw"getAlgByKeyAndName: not supported algorithm name: "+p},tt.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.crypto&&tt.crypto||(tt.crypto={}),tt.crypto.ECDSA=function(c){var p=Error,v=BigInteger,x=ECPointFp,E=tt.crypto.ECDSA,F=tt.crypto.ECParameterDB,C=E.getName,P=nt,R=P.getVbyListEx,B=P.isASN1HEX,T=new SecureRandom;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(c){return new v(c.bitLength(),T).mod(c.subtract(v.ONE)).add(v.ONE)},this.setNamedCurve=function(c){this.ecparams=F.getByName(c),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=c},this.setPrivateKeyHex=function(c){this.isPrivate=!0,this.prvKeyHex=c},this.setPublicKeyHex=function(c){this.isPublic=!0,this.pubKeyHex=c},this.getPublicKeyXYHex=function(){var c=this.pubKeyHex;if("04"!==c.substr(0,2))throw"this method supports uncompressed format(04) only";var p=this.ecparams.keycharlen;if(c.length!==2+2*p)throw"malformed public key hex length";var v={};return v.x=c.substr(2,p),v.y=c.substr(2+p),v},this.getShortNISTPCurveName=function(){var c=this.curveName;return"secp256r1"===c||"NIST P-256"===c||"P-256"===c||"prime256v1"===c?"P-256":"secp384r1"===c||"NIST P-384"===c||"P-384"===c?"P-384":"secp521r1"===c||"NIST P-521"===c||"P-521"===c?"P-521":null},this.generateKeyPairHex=function(){var c=this.ecparams.n,p=this.getBigRandom(c),v=this.ecparams.keycharlen,x=("0000000000"+p.toString(16)).slice(-v);return this.setPrivateKeyHex(x),{ecprvhex:x,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var c=new v(this.prvKeyHex,16),p=this.ecparams.G.multiply(c),x=p.getX().toBigInteger(),E=p.getY().toBigInteger(),F=this.ecparams.keycharlen,C="04"+("0000000000"+x.toString(16)).slice(-F)+("0000000000"+E.toString(16)).slice(-F);return this.setPublicKeyHex(C),C},this.signWithMessageHash=function(c){return this.signHex(c,this.prvKeyHex)},this.signHex=function(c,p){var x=new v(p,16),F=this.ecparams.n,C=new v(c.substring(0,this.ecparams.keycharlen),16);do{var P=this.getBigRandom(F),R=this.ecparams.G.multiply(P).getX().toBigInteger().mod(F)}while(R.compareTo(v.ZERO)<=0);var B=P.modInverse(F).multiply(C.add(x.multiply(R))).mod(F);return E.biRSSigToASN1Sig(R,B)},this.sign=function(c,p){var x=p,E=this.ecparams.n,F=v.fromByteArrayUnsigned(c);do{var C=this.getBigRandom(E),P=this.ecparams.G.multiply(C).getX().toBigInteger().mod(E)}while(P.compareTo(BigInteger.ZERO)<=0);var R=C.modInverse(E).multiply(F.add(x.multiply(P))).mod(E);return this.serializeSig(P,R)},this.verifyWithMessageHash=function(c,p){return this.verifyHex(c,p,this.pubKeyHex)},this.verifyHex=function(c,p,F){try{var C,P,R=E.parseSigHex(p);C=R.r,P=R.s;var B=x.decodeFromHex(this.ecparams.curve,F),T=new v(c.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(T,C,P,B)}catch(N){return!1}},this.verify=function(c,p,E){var F,C,P;if(Bitcoin.Util.isArray(p)){var R=this.parseSig(p);F=R.r,C=R.s}else{if("object"!==typeof p||!p.r||!p.s)throw"Invalid value for signature";F=p.r,C=p.s}if(E instanceof ECPointFp)P=E;else{if(!Bitcoin.Util.isArray(E))throw"Invalid format for pubkey value, must be byte array or ECPointFp";P=x.decodeFrom(this.ecparams.curve,E)}var B=v.fromByteArrayUnsigned(c);return this.verifyRaw(B,F,C,P)},this.verifyRaw=function(c,p,x,E){var F=this.ecparams.n,C=this.ecparams.G;if(p.compareTo(v.ONE)<0||p.compareTo(F)>=0)return!1;if(x.compareTo(v.ONE)<0||x.compareTo(F)>=0)return!1;var P=x.modInverse(F),R=c.multiply(P).mod(F),B=p.multiply(P).mod(F);return C.multiply(R).add(E.multiply(B)).getX().toBigInteger().mod(F).equals(p)},this.serializeSig=function(c,p){var v=c.toByteArraySigned(),x=p.toByteArraySigned(),E=[];return E.push(2),E.push(v.length),(E=E.concat(v)).push(2),E.push(x.length),(E=E.concat(x)).unshift(E.length),E.unshift(48),E},this.parseSig=function(c){var p;if(48!=c[0])throw new Error("Signature not a valid DERSequence");if(2!=c[p=2])throw new Error("First element in signature must be a DERInteger");var x=c.slice(p+2,p+2+c[p+1]);if(2!=c[p+=2+c[p+1]])throw new Error("Second element in signature must be a DERInteger");var E=c.slice(p+2,p+2+c[p+1]);return p+=2+c[p+1],{r:v.fromByteArrayUnsigned(x),s:v.fromByteArrayUnsigned(E)}},this.parseSigCompact=function(c){if(65!==c.length)throw"Signature has the wrong length";var p=c[0]-27;if(p<0||p>7)throw"Invalid signature type";var x=this.ecparams.n;return{r:v.fromByteArrayUnsigned(c.slice(1,33)).mod(x),s:v.fromByteArrayUnsigned(c.slice(33,65)).mod(x),i:p}},this.readPKCS5PrvKeyHex=function(c){if(!1===B(c))throw new Error("not ASN.1 hex string");var p,v,x;try{p=R(c,0,["[0]",0],"06"),v=R(c,0,[1],"04");try{x=R(c,0,["[1]",0],"03")}catch(E){}}catch(E){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=C(p),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(x),this.setPrivateKeyHex(v),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(c){if(!1===B(c))throw new p("not ASN.1 hex string");var v,x,E;try{R(c,0,[1,0],"06"),v=R(c,0,[1,1],"06"),x=R(c,0,[2,0,1],"04");try{E=R(c,0,[2,0,"[1]",0],"03")}catch(F){}}catch(F){throw new p("malformed PKCS#8 plain ECC private key")}if(this.curveName=C(v),void 0===this.curveName)throw new p("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E),this.setPrivateKeyHex(x),this.isPublic=!1},this.readPKCS8PubKeyHex=function(c){if(!1===B(c))throw new p("not ASN.1 hex string");var v,x;try{R(c,0,[0,0],"06"),v=R(c,0,[0,1],"06"),x=R(c,0,[1],"03")}catch(E){throw new p("malformed PKCS#8 ECC public key")}if(this.curveName=C(v),null===this.curveName)throw new p("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(x)},this.readCertPubKeyHex=function(c,v){if(!1===B(c))throw new p("not ASN.1 hex string");var x,E;try{x=R(c,0,[0,5,0,1],"06"),E=R(c,0,[0,5,1],"03")}catch(F){throw new p("malformed X.509 certificate ECC public key")}if(this.curveName=C(x),null===this.curveName)throw new p("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(E)},void 0!==c&&void 0!==c.curve&&(this.curveName=c.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==c&&(void 0!==c.prv&&this.setPrivateKeyHex(c.prv),void 0!==c.pub&&this.setPublicKeyHex(c.pub))},tt.crypto.ECDSA.parseSigHex=function(c){var p=tt.crypto.ECDSA.parseSigHexInHexRS(c);return{r:new BigInteger(p.r,16),s:new BigInteger(p.s,16)}},tt.crypto.ECDSA.parseSigHexInHexRS=function(c){var p=nt,v=p.getChildIdx,x=p.getV;if(p.checkStrictDER(c,0),"30"!=c.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var E=v(c,0);if(2!=E.length)throw new Error("signature shall have two elements");var F=E[0],C=E[1];if("02"!=c.substr(F,2))throw new Error("1st item not ASN.1 integer");if("02"!=c.substr(C,2))throw new Error("2nd item not ASN.1 integer");return{r:x(c,F),s:x(c,C)}},tt.crypto.ECDSA.asn1SigToConcatSig=function(c){var p=tt.crypto.ECDSA.parseSigHexInHexRS(c),v=p.r,x=p.s;if(v.length>=130&&v.length<=134){if(v.length%2!=0)throw Error("unknown ECDSA sig r length error");if(x.length%2!=0)throw Error("unknown ECDSA sig s length error");"00"==v.substr(0,2)&&(v=v.substr(2)),"00"==x.substr(0,2)&&(x=x.substr(2));var E=Math.max(v.length,x.length);return(v=("000000"+v).slice(-E))+(x=("000000"+x).slice(-E))}if("00"==v.substr(0,2)&&v.length%32==2&&(v=v.substr(2)),"00"==x.substr(0,2)&&x.length%32==2&&(x=x.substr(2)),v.length%32==30&&(v="00"+v),x.length%32==30&&(x="00"+x),v.length%32!=0)throw Error("unknown ECDSA sig r length error");if(x.length%32!=0)throw Error("unknown ECDSA sig s length error");return v+x},tt.crypto.ECDSA.concatSigToASN1Sig=function(c){if(c.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var p=c.substr(0,c.length/2),v=c.substr(c.length/2);return tt.crypto.ECDSA.hexRSSigToASN1Sig(p,v)},tt.crypto.ECDSA.hexRSSigToASN1Sig=function(c,p){var v=new BigInteger(c,16),x=new BigInteger(p,16);return tt.crypto.ECDSA.biRSSigToASN1Sig(v,x)},tt.crypto.ECDSA.biRSSigToASN1Sig=function(c,p){var v=tt.asn1,x=new v.DERInteger({bigint:c}),E=new v.DERInteger({bigint:p});return new v.DERSequence({array:[x,E]}).tohex()},tt.crypto.ECDSA.getName=function(c){return"2b8104001f"===c?"secp192k1":"2a8648ce3d030107"===c?"secp256r1":"2b8104000a"===c?"secp256k1":"2b81040021"===c?"secp224r1":"2b81040022"===c?"secp384r1":"2b81040023"===c?"secp521r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(c)?"secp256r1":-1!=="|secp256k1|".indexOf(c)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(c)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(c)?"secp384r1":-1!=="|secp521r1|NIST P-521|P-521|".indexOf(c)?"secp521r1":null},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.crypto&&tt.crypto||(tt.crypto={}),tt.crypto.ECParameterDB=new function(){var c={},p={};function a(c){return new BigInteger(c,16)}this.getByName=function(v){var x=v;if("undefined"!=typeof p[x]&&(x=p[v]),"undefined"!=typeof c[x])return c[x];throw"unregistered EC curve name: "+x},this.regist=function(v,x,E,F,C,P,R,B,T,N,_,L){c[v]={};var V=a(E),U=a(F),W=a(C),G=a(P),X=a(R),J=new ECCurveFp(V,U,W),Z=J.decodePointHex("04"+B+T);c[v].name=v,c[v].keylen=x,c[v].keycharlen=2*Math.ceil(x/8),c[v].curve=J,c[v].G=Z,c[v].n=G,c[v].h=X,c[v].oid=_,c[v].info=L;for(var Y=0;Y<N.length;Y++)p[N[Y]]=v}},tt.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),tt.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),tt.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),tt.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),tt.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),tt.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),tt.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),tt.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),tt.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),tt.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.crypto&&tt.crypto||(tt.crypto={}),tt.crypto.DSA=function(){var c=nt,p=(c.getVbyList,c.getVbyListEx),v=c.isASN1HEX,x=BigInteger;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(c,p,v,x,E){this.isPrivate=!0,this.p=c,this.q=p,this.g=v,this.y=x,this.x=E},this.setPrivateHex=function(c,p,v,x,E){var F,C,P,R,B;F=new BigInteger(c,16),C=new BigInteger(p,16),P=new BigInteger(v,16),R="string"===typeof x&&x.length>1?new BigInteger(x,16):null,B=new BigInteger(E,16),this.setPrivate(F,C,P,R,B)},this.setPublic=function(c,p,v,x){this.isPublic=!0,this.p=c,this.q=p,this.g=v,this.y=x,this.x=null},this.setPublicHex=function(c,p,v,x){var E,F,C,P;E=new BigInteger(c,16),F=new BigInteger(p,16),C=new BigInteger(v,16),P=new BigInteger(x,16),this.setPublic(E,F,C,P)},this.signWithMessageHash=function(c){var p=this.p,v=this.q,x=this.g,E=(this.y,this.x),F=tt.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),v.subtract(BigInteger.ONE)),C=new BigInteger(c.substr(0,v.bitLength()/4),16),P=x.modPow(F,p).mod(v),R=F.modInverse(v).multiply(C.add(E.multiply(P))).mod(v);return tt.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:P}},{int:{bigint:R}}]})},this.verifyWithMessageHash=function(c,p){var v=this.p,x=this.q,E=this.g,F=this.y,C=this.parseASN1Signature(p),P=C[0],R=C[1],B=new BigInteger(c.substr(0,x.bitLength()/4),16);if(BigInteger.ZERO.compareTo(P)>0||P.compareTo(x)>0)throw"invalid DSA signature";if(BigInteger.ZERO.compareTo(R)>=0||R.compareTo(x)>0)throw"invalid DSA signature";var T=R.modInverse(x),N=B.multiply(T).mod(x),_=P.multiply(T).mod(x);return 0==E.modPow(N,v).multiply(F.modPow(_,v)).mod(v).mod(x).compareTo(P)},this.parseASN1Signature=function(c){try{return[new x(p(c,0,[0],"02"),16),new x(p(c,0,[1],"02"),16)]}catch(v){throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(c){var x,E,F,C,P;if(!1===v(c))throw new Error("not ASN.1 hex string");try{x=p(c,0,[1],"02"),E=p(c,0,[2],"02"),F=p(c,0,[3],"02"),C=p(c,0,[4],"02"),P=p(c,0,[5],"02")}catch(R){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(x,E,F,C,P)},this.readPKCS8PrvKeyHex=function(c){var x,E,F,C;if(!1===v(c))throw new Error("not ASN.1 hex string");try{x=p(c,0,[1,1,0],"02"),E=p(c,0,[1,1,1],"02"),F=p(c,0,[1,1,2],"02"),C=p(c,0,[2,0],"02")}catch(P){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(x,E,F,null,C)},this.readPKCS8PubKeyHex=function(c){var x,E,F,C;if(!1===v(c))throw new Error("not ASN.1 hex string");try{x=p(c,0,[0,1,0],"02"),E=p(c,0,[0,1,1],"02"),F=p(c,0,[0,1,2],"02"),C=p(c,0,[1,0],"02")}catch(P){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(x,E,F,C)},this.readCertPubKeyHex=function(c,x){var E,F,C,P;if(!1===v(c))throw new Error("not ASN.1 hex string");try{E=p(c,0,[0,5,0,1,0],"02"),F=p(c,0,[0,5,0,1,1],"02"),C=p(c,0,[0,5,0,1,2],"02"),P=p(c,0,[0,5,1,0],"02")}catch(R){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(E,F,C,P)}};var it=function(){var d=function(c,p,v){return k(E.AES,c,p,v)},k=function(c,p,v,x){var F=E.enc.Hex.parse(p),C=E.enc.Hex.parse(v),P=E.enc.Hex.parse(x),R={};R.key=C,R.iv=P,R.ciphertext=F;var B=c.decrypt(R,C,{iv:P});return E.enc.Hex.stringify(B)},l=function(c,p,v){return g(E.AES,c,p,v)},g=function(c,p,v,x){var F=E.enc.Hex.parse(p),C=E.enc.Hex.parse(v),P=E.enc.Hex.parse(x),R=c.encrypt(F,C,{iv:P}),B=E.enc.Hex.parse(R.toString());return E.enc.Base64.stringify(B)},c={"AES-256-CBC":{proc:d,eproc:l,keylen:32,ivlen:16},"AES-192-CBC":{proc:d,eproc:l,keylen:24,ivlen:16},"AES-128-CBC":{proc:d,eproc:l,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(c,p,v){return k(E.TripleDES,c,p,v)},eproc:function(c,p,v){return g(E.TripleDES,c,p,v)},keylen:24,ivlen:8},"DES-CBC":{proc:function(c,p,v){return k(E.DES,c,p,v)},eproc:function(c,p,v){return g(E.DES,c,p,v)},keylen:8,ivlen:8}},n=function(c){var p={},v=c.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));v&&(p.cipher=v[1],p.ivsalt=v[2]);var x=c.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));x&&(p.type=x[1]);var E=-1,F=0;-1!=c.indexOf("\r\n\r\n")&&(E=c.indexOf("\r\n\r\n"),F=2),-1!=c.indexOf("\n\n")&&(E=c.indexOf("\n\n"),F=1);var C=c.indexOf("-----END");if(-1!=E&&-1!=C){var P=c.substring(E+2*F,C-F);P=P.replace(/\s+/g,""),p.data=P}return p},j=function(p,v,x){for(var F=x.substring(0,16),C=E.enc.Hex.parse(F),P=E.enc.Utf8.parse(v),R=c[p].keylen+c[p].ivlen,B="",T=null;;){var N=E.algo.MD5.create();if(null!=T&&N.update(T),N.update(P),N.update(C),T=N.finalize(),(B+=E.enc.Hex.stringify(T)).length>=2*R)break}var _={};return _.keyhex=B.substr(0,2*c[p].keylen),_.ivhex=B.substr(2*c[p].keylen,2*c[p].ivlen),_},b=function(p,v,x,F){var C=E.enc.Base64.parse(p),P=E.enc.Hex.stringify(C);return(0,c[v].proc)(P,x,F)};return{version:"1.0.0",parsePKCS5PEM:function(c){return n(c)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(c,p,v){return j(c,p,v)},decryptKeyB64:function(c,p,v,x){return b(c,p,v,x)},getDecryptedKeyHex:function(c,p){var v=n(c),x=(v.type,v.cipher),E=v.ivsalt,F=v.data,C=j(x,p,E).keyhex;return b(F,x,C,E)},getEncryptedPKCS5PEMFromPrvKeyHex:function(p,v,x,F,C){var P="";if("undefined"!=typeof F&&null!=F||(F="AES-256-CBC"),"undefined"==typeof c[F])throw new Error("KEYUTIL unsupported algorithm: "+F);if("undefined"==typeof C||null==C){var R=function(c){var p=E.lib.WordArray.random(c);return E.enc.Hex.stringify(p)}(c[F].ivlen);C=R.toUpperCase()}var B=function(p,v,x,E){return(0,c[v].eproc)(p,x,E)}(v,F,j(F,x,C).keyhex,C);P="-----BEGIN "+p+" PRIVATE KEY-----\r\n";return P+="Proc-Type: 4,ENCRYPTED\r\n",P+="DEK-Info: "+F+","+C+"\r\n",P+="\r\n",P+=B.replace(/(.{64})/g,"$1\r\n"),P+="\r\n-----END "+p+" PRIVATE KEY-----\r\n"},getEncryptedPKCS8PEM:function(c,p,v){return hextopem(this.getEncryptedPKCS8Hex(c,p,v),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(c,p,v){var x;(x=void 0==v||null==v?{}:JSON.parse(JSON.stringify(v))).plain=c,this.initPBES2Param(x),this.encryptPBES2Param(x,p);var E=this.generatePBES2ASN1Param(x);return tt.asn1.ASN1Util.newObject(E).tohex()},initPBES2Param:function(c){var p;(void 0==aryval(c,"encalg")&&(c.encalg="aes256-CBC"),void 0==aryval(c,"iter")&&(c.iter=2048),void 0==aryval(c,"prf")&&(c.prf="hmacWithSHA256"),void 0==aryval(c,"salt")&&(c.salt=E.enc.Hex.stringify(E.lib.WordArray.random(8))),void 0==aryval(c,"enciv"))&&("des-EDE3-CBC"==c.encalg&&(p=8),"aes128-CBC"==c.encalg&&(p=16),"aes256-CBC"==c.encalg&&(p=16),c.enciv=E.enc.Hex.stringify(E.lib.WordArray.random(p)))},encryptPBES2Param:function(c,p){var v=it.getDKFromPBES2Param(c,p);try{var x=tt.crypto.Cipher.encrypt(c.plain,v,c.encalg,{iv:c.enciv})}catch(E){throw new Error("encrypt error: "+c.plain+" "+v+" "+c.encalg+" "+c.enciv)}c.enc=x},generatePBES2ASN1Param:function(c){var p={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:c.salt}},{int:{hex:inttohex(c.iter)}}]}]},{seq:[{oid:c.encalg},{octstr:{hex:c.enciv}}]}]}]},{octstr:{hex:c.enc}}]};return"hmacWithSHA1"!=c.prf&&p.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:c.prf},{null:""}]}),p},parseHexOfEncryptedPKCS8:function(c){var p=nt,v=p.getChildIdx,x=p.getV,E={},F=v(c,0);if(2!=F.length)throw new Error("malformed format: SEQUENCE(0).items != 2: "+F.length);E.ciphertext=x(c,F[1]);var C=v(c,F[0]);if(2!=C.length)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+C.length);if("2a864886f70d01050d"!=x(c,C[0]))throw new Error("this only supports pkcs5PBES2");var P=v(c,C[1]);if(2!=C.length)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+P.length);var R=v(c,P[1]);if(2!=R.length)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+R.length);if("2a864886f70d0307"!=x(c,R[0]))throw"this only supports TripleDES";E.encryptionSchemeAlg="TripleDES",E.encryptionSchemeIV=x(c,R[1]);var B=v(c,P[0]);if(2!=B.length)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+B.length);if("2a864886f70d01050c"!=x(c,B[0]))throw new Error("this only supports pkcs5PBKDF2");var T=v(c,B[1]);if(T.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+T.length);E.pbkdf2Salt=x(c,T[0]);var N=x(c,T[1]);try{E.pbkdf2Iter=parseInt(N,16)}catch(_){throw new Error("malformed format pbkdf2Iter: "+N)}return E},getPBKDF2KeyHexFromParam:function(c,p){var v=E.enc.Hex.parse(c.pbkdf2Salt),x=c.pbkdf2Iter,F=E.PBKDF2(p,v,{keySize:6,iterations:x});return E.enc.Hex.stringify(F)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(c,p){var v=pemtohex(c,"ENCRYPTED PRIVATE KEY"),x=this.parseHexOfEncryptedPKCS8(v),F=it.getPBKDF2KeyHexFromParam(x,p),C={};C.ciphertext=E.enc.Hex.parse(x.ciphertext);var P=E.enc.Hex.parse(F),R=E.enc.Hex.parse(x.encryptionSchemeIV),B=E.TripleDES.decrypt(C,P,{iv:R});return E.enc.Hex.stringify(B)},parsePBES2:function(c){var p=nt.parse(c);if("pkcs5PBES2"!=aryval(p,"seq.0.seq.0.oid")||"pkcs5PBKDF2"!=aryval(p,"seq.0.seq.1.seq.0.seq.0.oid"))throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var v=aryval(p,"seq.0.seq.1.seq.0.seq.1.seq");if(void 0==v)throw new Error("PBKDF2 parameter not found");var x=aryval(v,"0.octstr.hex"),E=aryval(v,"1.int.hex"),F=aryval(v,"2.seq.0.oid","hmacWithSHA1"),C=-1;try{C=parseInt(E,16)}catch(T){throw new Error("iter not proper value")}var P=aryval(p,"seq.0.seq.1.seq.1.seq.0.oid"),R=aryval(p,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),B=aryval(p,"seq.1.octstr.hex");if(void 0==P||void 0==R||void 0==B)throw new Error("encalg, enciv or enc is undefined");return{salt:x,iter:C,prf:F,encalg:P,enciv:R,enc:B}},getDKFromPBES2Param:function(c,p){var v={hmacWithSHA1:E.algo.SHA1,hmacWithSHA224:E.algo.SHA224,hmacWithSHA256:E.algo.SHA256,hmacWithSHA384:E.algo.SHA384,hmacWithSHA512:E.algo.SHA512}[c.prf];if(void 0==v)throw new Error("unsupported prf");var x={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[c.encalg];if(void 0==x)throw new Error("unsupported encalg");var F=E.enc.Hex.parse(c.salt),C=c.iter;try{var P=E.PBKDF2(p,F,{keySize:x,iterations:C,hasher:v});return E.enc.Hex.stringify(P)}catch(X){throw new Error("PBKDF2 error: "+X+" "+JSON.stringify(c)+" "+p)}},getPlainHexFromEncryptedPKCS8PEM:function(c,p){if(-1==c.indexOf("BEGIN ENCRYPTED PRIVATE KEY"))throw new Error("not Encrypted PKCS#8 PEM string");var v,x=pemtohex(c);try{v=it.parsePBES2(x)}catch(F){throw new Error("malformed PBES2 format: "+F.message)}var E=it.getDKFromPBES2Param(v,p);return tt.crypto.Cipher.decrypt(v.enc,E,v.encalg,{iv:v.enciv})},getKeyFromEncryptedPKCS8PEM:function(c,p){var v=this.getPlainHexFromEncryptedPKCS8PEM(c,p);return this.getKeyFromPlainPrivatePKCS8Hex(v)},parsePlainPrivatePKCS8Hex:function(c){var p=nt,v=p.getChildIdx,x=p.getV,E={algparam:null};if("30"!=c.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var F=v(c,0);if(F.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=c.substr(F[1],2))throw new Error("malformed PKCS8 private key(code:003)");var C=v(c,F[1]);if(2!=C.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=c.substr(C[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(E.algoid=x(c,C[0]),"06"==c.substr(C[1],2)&&(E.algparam=x(c,C[1])),"04"!=c.substr(F[2],2))throw new Error("malformed PKCS8 private key(code:006)");return E.keyidx=p.getVidx(c,F[2]),E},getKeyFromPlainPrivatePKCS8PEM:function(c){var p=pemtohex(c,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(p)},getKeyFromPlainPrivatePKCS8Hex:function(c){var p,v=this.parsePlainPrivatePKCS8Hex(c);if("2a864886f70d010101"==v.algoid)p=new RSAKey;else if("2a8648ce380401"==v.algoid)p=new tt.crypto.DSA;else{if("2a8648ce3d0201"!=v.algoid)throw new Error("unsupported private key algorithm");p=new tt.crypto.ECDSA}return p.readPKCS8PrvKeyHex(c),p},_getKeyFromPublicPKCS8Hex:function(c){var p,v=nt.getVbyList(c,0,[0,0],"06");if("2a864886f70d010101"===v)p=new RSAKey;else if("2a8648ce380401"===v)p=new tt.crypto.DSA;else{if("2a8648ce3d0201"!==v)throw new Error("unsupported PKCS#8 public key hex");p=new tt.crypto.ECDSA}return p.readPKCS8PubKeyHex(c),p},parsePublicRawRSAKeyHex:function(c){var p=nt,v=p.getChildIdx,x=p.getV,E={};if("30"!=c.substr(0,2))throw new Error("malformed RSA key(code:001)");var F=v(c,0);if(2!=F.length)throw new Error("malformed RSA key(code:002)");if("02"!=c.substr(F[0],2))throw new Error("malformed RSA key(code:003)");if(E.n=x(c,F[0]),"02"!=c.substr(F[1],2))throw new Error("malformed RSA key(code:004)");return E.e=x(c,F[1]),E},parsePublicPKCS8Hex:function(c){var p=nt,v=p.getChildIdx,x=p.getV,E={algparam:null},F=v(c,0);if(2!=F.length)throw new Error("outer DERSequence shall have 2 elements: "+F.length);var C=F[0];if("30"!=c.substr(C,2))throw new Error("malformed PKCS8 public key(code:001)");var P=v(c,C);if(2!=P.length)throw new Error("malformed PKCS8 public key(code:002)");if("06"!=c.substr(P[0],2))throw new Error("malformed PKCS8 public key(code:003)");if(E.algoid=x(c,P[0]),"06"==c.substr(P[1],2)?E.algparam=x(c,P[1]):"30"==c.substr(P[1],2)&&(E.algparam={},E.algparam.p=p.getVbyList(c,P[1],[0],"02"),E.algparam.q=p.getVbyList(c,P[1],[1],"02"),E.algparam.g=p.getVbyList(c,P[1],[2],"02")),"03"!=c.substr(F[1],2))throw new Error("malformed PKCS8 public key(code:004)");return E.key=x(c,F[1]).substr(2),E}}}();it.getKey=function(c,p,v){var x=(W=nt).getChildIdx,E=(W.getV,W.getVbyList),F=tt.crypto,C=F.ECDSA,P=F.DSA,R=RSAKey,B=pemtohex,T=it;if("undefined"!=typeof R&&c instanceof R)return c;if("undefined"!=typeof C&&c instanceof C)return c;if("undefined"!=typeof P&&c instanceof P)return c;if(void 0!==c.curve&&void 0!==c.xy&&void 0===c.d)return new C({pub:c.xy,curve:c.curve});if(void 0!==c.curve&&void 0!==c.d)return new C({prv:c.d,curve:c.curve});if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(ot=new R).setPublic(c.n,c.e),ot;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.co&&void 0===c.qi)return(ot=new R).setPrivateEx(c.n,c.e,c.d,c.p,c.q,c.dp,c.dq,c.co),ot;if(void 0===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0===c.p)return(ot=new R).setPrivate(c.n,c.e,c.d),ot;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0===c.x)return(ot=new P).setPublic(c.p,c.q,c.g,c.y),ot;if(void 0!==c.p&&void 0!==c.q&&void 0!==c.g&&void 0!==c.y&&void 0!==c.x)return(ot=new P).setPrivate(c.p,c.q,c.g,c.y,c.x),ot;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0===c.d)return(ot=new R).setPublic(b64utohex(c.n),b64utohex(c.e)),ot;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d&&void 0!==c.p&&void 0!==c.q&&void 0!==c.dp&&void 0!==c.dq&&void 0!==c.qi)return(ot=new R).setPrivateEx(b64utohex(c.n),b64utohex(c.e),b64utohex(c.d),b64utohex(c.p),b64utohex(c.q),b64utohex(c.dp),b64utohex(c.dq),b64utohex(c.qi)),ot;if("RSA"===c.kty&&void 0!==c.n&&void 0!==c.e&&void 0!==c.d)return(ot=new R).setPrivate(b64utohex(c.n),b64utohex(c.e),b64utohex(c.d)),ot;if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0===c.d){var N=(at=new C({curve:c.crv})).ecparams.keycharlen,_="04"+("0000000000"+b64utohex(c.x)).slice(-N)+("0000000000"+b64utohex(c.y)).slice(-N);return at.setPublicKeyHex(_),at}if("EC"===c.kty&&void 0!==c.crv&&void 0!==c.x&&void 0!==c.y&&void 0!==c.d){N=(at=new C({curve:c.crv})).ecparams.keycharlen,_="04"+("0000000000"+b64utohex(c.x)).slice(-N)+("0000000000"+b64utohex(c.y)).slice(-N);var L=("0000000000"+b64utohex(c.d)).slice(-N);return at.setPublicKeyHex(_),at.setPrivateKeyHex(L),at}if("pkcs5prv"===v){var V,U=c,W=nt;if(9===(V=x(U,0)).length)(ot=new R).readPKCS5PrvKeyHex(U);else if(6===V.length)(ot=new P).readPKCS5PrvKeyHex(U);else{if(!(V.length>2&&"04"===U.substr(V[1],2)))throw new Error("unsupported PKCS#1/5 hexadecimal key");(ot=new C).readPKCS5PrvKeyHex(U)}return ot}if("pkcs8prv"===v)return ot=T.getKeyFromPlainPrivatePKCS8Hex(c);if("pkcs8pub"===v)return T._getKeyFromPublicPKCS8Hex(c);if("x509pub"===v)return X509.getPublicKeyFromCertHex(c);if(-1!=c.indexOf("-END CERTIFICATE-",0)||-1!=c.indexOf("-END X509 CERTIFICATE-",0)||-1!=c.indexOf("-END TRUSTED CERTIFICATE-",0))return X509.getPublicKeyFromCertPEM(c);if(-1!=c.indexOf("-END PUBLIC KEY-")){var G=pemtohex(c,"PUBLIC KEY");return T._getKeyFromPublicPKCS8Hex(G)}if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var X=B(c,"RSA PRIVATE KEY");return T.getKey(X,null,"pkcs5prv")}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){var J=E(ut=B(c,"DSA PRIVATE KEY"),0,[1],"02"),Z=E(ut,0,[2],"02"),Y=E(ut,0,[3],"02"),Q=E(ut,0,[4],"02"),et=E(ut,0,[5],"02");return(ot=new P).setPrivate(new BigInteger(J,16),new BigInteger(Z,16),new BigInteger(Y,16),new BigInteger(Q,16),new BigInteger(et,16)),ot}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1==c.indexOf("4,ENCRYPTED")){X=B(c,"EC PRIVATE KEY");return T.getKey(X,null,"pkcs5prv")}if(-1!=c.indexOf("-END PRIVATE KEY-"))return T.getKeyFromPlainPrivatePKCS8PEM(c);if(-1!=c.indexOf("-END RSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var rt=T.getDecryptedKeyHex(c,p),st=new RSAKey;return st.readPKCS5PrvKeyHex(rt),st}if(-1!=c.indexOf("-END EC PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var at,ot=E(ut=T.getDecryptedKeyHex(c,p),0,[1],"04"),ct=E(ut,0,[2,0],"06"),ht=E(ut,0,[3,0],"03").substr(2);if(void 0===tt.crypto.OID.oidhex2name[ct])throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+ct);return(at=new C({curve:tt.crypto.OID.oidhex2name[ct]})).setPublicKeyHex(ht),at.setPrivateKeyHex(ot),at.isPublic=!1,at}if(-1!=c.indexOf("-END DSA PRIVATE KEY-")&&-1!=c.indexOf("4,ENCRYPTED")){var ut;J=E(ut=T.getDecryptedKeyHex(c,p),0,[1],"02"),Z=E(ut,0,[2],"02"),Y=E(ut,0,[3],"02"),Q=E(ut,0,[4],"02"),et=E(ut,0,[5],"02");return(ot=new P).setPrivate(new BigInteger(J,16),new BigInteger(Z,16),new BigInteger(Y,16),new BigInteger(Q,16),new BigInteger(et,16)),ot}if(-1!=c.indexOf("-END ENCRYPTED PRIVATE KEY-"))return T.getKeyFromEncryptedPKCS8PEM(c,p);throw new Error("not supported argument")},it.generateKeypair=function(c,p){if("RSA"==c){var v=p;(C=new RSAKey).generate(v,"10001"),C.isPrivate=!0,C.isPublic=!0;var x=new RSAKey,E=C.n.toString(16),F=C.e.toString(16);return x.setPublic(E,F),x.isPrivate=!1,x.isPublic=!0,(P={}).prvKeyObj=C,P.pubKeyObj=x,P}if("EC"==c){var C,P,R=p,B=new tt.crypto.ECDSA({curve:R}).generateKeyPairHex();return(C=new tt.crypto.ECDSA({curve:R})).setPublicKeyHex(B.ecpubhex),C.setPrivateKeyHex(B.ecprvhex),C.isPrivate=!0,C.isPublic=!1,(x=new tt.crypto.ECDSA({curve:R})).setPublicKeyHex(B.ecpubhex),x.isPrivate=!1,x.isPublic=!0,(P={}).prvKeyObj=C,P.pubKeyObj=x,P}throw new Error("unknown algorithm: "+c)},it.getPEM=function(c,p,v,x,E,F){var C=tt,P=C.asn1,R=P.DERObjectIdentifier,B=P.DERInteger,T=P.ASN1Util.newObject,N=P.x509.SubjectPublicKeyInfo,_=C.crypto,L=_.DSA,V=_.ECDSA,U=RSAKey;function z(c){return T({seq:[{int:0},{int:{bigint:c.n}},{int:c.e},{int:{bigint:c.d}},{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.dmp1}},{int:{bigint:c.dmq1}},{int:{bigint:c.coeff}}]})}function A(c){return T({seq:[{int:1},{octstr:{hex:c.prvKeyHex}},{tag:["a0",!0,{oid:{name:c.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+c.pubKeyHex}}]}]})}function w(c){return T({seq:[{int:0},{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.g}},{int:{bigint:c.y}},{int:{bigint:c.x}}]})}if((void 0!==U&&c instanceof U||void 0!==L&&c instanceof L||void 0!==V&&c instanceof V)&&1==c.isPublic&&(void 0===p||"PKCS8PUB"==p))return hextopem(J=new N(c).tohex(),"PUBLIC KEY");if("PKCS1PRV"==p&&void 0!==U&&c instanceof U&&(void 0===v||null==v)&&1==c.isPrivate)return hextopem(J=z(c).tohex(),"RSA PRIVATE KEY");if("PKCS1PRV"==p&&void 0!==V&&c instanceof V&&(void 0===v||null==v)&&1==c.isPrivate){var W=new R({name:c.curveName}).tohex(),G=A(c).tohex(),X="";return X+=hextopem(W,"EC PARAMETERS"),X+=hextopem(G,"EC PRIVATE KEY")}if("PKCS1PRV"==p&&void 0!==L&&c instanceof L&&(void 0===v||null==v)&&1==c.isPrivate)return hextopem(J=w(c).tohex(),"DSA PRIVATE KEY");if("PKCS5PRV"==p&&void 0!==U&&c instanceof U&&void 0!==v&&null!=v&&1==c.isPrivate){var J=z(c).tohex();return void 0===x&&(x="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",J,v,x,F)}if("PKCS5PRV"==p&&void 0!==V&&c instanceof V&&void 0!==v&&null!=v&&1==c.isPrivate){J=A(c).tohex();return void 0===x&&(x="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",J,v,x,F)}if("PKCS5PRV"==p&&void 0!==L&&c instanceof L&&void 0!==v&&null!=v&&1==c.isPrivate){J=w(c).tohex();return void 0===x&&(x="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",J,v,x,F)}var f=function(c,p){if("string"==typeof p)return it.getEncryptedPKCS8PEM(c,p);if("object"==typeof p&&void 0!=aryval(p,"passcode")){var v=JSON.parse(JSON.stringify(p)),x=v.passcode;return delete v.passcode,it.getEncryptedPKCS8PEM(c,x,v)}};if("PKCS8PRV"==p&&void 0!=U&&c instanceof U&&1==c.isPrivate){var Z=z(c).tohex();J=T({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:Z}}]}).tohex();return void 0===v||null==v?hextopem(J,"PRIVATE KEY"):f(J,v)}if("PKCS8PRV"==p&&void 0!==V&&c instanceof V&&1==c.isPrivate){var Y={seq:[{int:1},{octstr:{hex:c.prvKeyHex}}]};"string"==typeof c.pubKeyHex&&Y.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+c.pubKeyHex}}]});Z=new T(Y).tohex(),J=T({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:c.curveName}}]},{octstr:{hex:Z}}]}).tohex();return void 0===v||null==v?hextopem(J,"PRIVATE KEY"):f(J,v)}if("PKCS8PRV"==p&&void 0!==L&&c instanceof L&&1==c.isPrivate){Z=new B({bigint:c.x}).tohex(),J=T({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:c.p}},{int:{bigint:c.q}},{int:{bigint:c.g}}]}]},{octstr:{hex:Z}}]}).tohex();return void 0===v||null==v?hextopem(J,"PRIVATE KEY"):f(J,v)}throw new Error("unsupported object nor format")},it.getKeyFromCSRPEM=function(c){var p=pemtohex(c,"CERTIFICATE REQUEST");return it.getKeyFromCSRHex(p)},it.getKeyFromCSRHex=function(c){var p=it.parseCSRHex(c);return it.getKey(p.p8pubkeyhex,null,"pkcs8pub")},it.parseCSRHex=function(c){var p=nt,v=p.getChildIdx,x=p.getTLV,E={},F=c;if("30"!=F.substr(0,2))throw new Error("malformed CSR(code:001)");var C=v(F,0);if(C.length<1)throw new Error("malformed CSR(code:002)");if("30"!=F.substr(C[0],2))throw new Error("malformed CSR(code:003)");var P=v(F,C[0]);if(P.length<3)throw new Error("malformed CSR(code:004)");return E.p8pubkeyhex=x(F,P[2]),E},it.getKeyID=function(c){var p=it,v=nt;"string"===typeof c&&-1!=c.indexOf("BEGIN ")&&(c=p.getKey(c));var x=pemtohex(p.getPEM(c)),E=v.getIdxbyList(x,0,[1]),F=v.getV(x,E).substring(2);return tt.crypto.Util.hashHex(F,"sha1")},it.getJWK=function(c,p,v,x,E){var F,C,P={},R=tt.crypto.Util.hashHex;if("string"==typeof c)F=it.getKey(c),-1!=c.indexOf("CERTIFICATE")&&(C=pemtohex(c));else{if("object"!=typeof c)throw new Error("unsupported keyinfo type");c instanceof X509?(F=c.getPublicKey(),C=c.hex):F=c}if(F instanceof RSAKey&&F.isPrivate)P.kty="RSA",P.n=hextob64u(F.n.toString(16)),P.e=hextob64u(F.e.toString(16)),P.d=hextob64u(F.d.toString(16)),P.p=hextob64u(F.p.toString(16)),P.q=hextob64u(F.q.toString(16)),P.dp=hextob64u(F.dmp1.toString(16)),P.dq=hextob64u(F.dmq1.toString(16)),P.qi=hextob64u(F.coeff.toString(16));else if(F instanceof RSAKey&&F.isPublic)P.kty="RSA",P.n=hextob64u(F.n.toString(16)),P.e=hextob64u(F.e.toString(16));else if(F instanceof tt.crypto.ECDSA&&F.isPrivate){if("P-256"!==(T=F.getShortNISTPCurveName())&&"P-384"!==T&&"P-521"!==T)throw new Error("unsupported curve name for JWT: "+T);var B=F.getPublicKeyXYHex();P.kty="EC",P.crv=T,P.x=hextob64u(B.x),P.y=hextob64u(B.y),P.d=hextob64u(F.prvKeyHex)}else if(F instanceof tt.crypto.ECDSA&&F.isPublic){var T;if("P-256"!==(T=F.getShortNISTPCurveName())&&"P-384"!==T&&"P-521"!==T)throw new Error("unsupported curve name for JWT: "+T);B=F.getPublicKeyXYHex();P.kty="EC",P.crv=T,P.x=hextob64u(B.x),P.y=hextob64u(B.y)}if(void 0==P.kty)throw new Error("unsupported keyinfo");return F.isPrivate||1==p||(P.kid=tt.jws.JWS.getJWKthumbprint(P)),void 0!=C&&1!=v&&(P.x5c=[hex2b64(C)]),void 0!=C&&1!=x&&(P.x5t=b64tob64u(hex2b64(R(C,"sha1")))),void 0!=C&&1!=E&&(P["x5t#S256"]=b64tob64u(hex2b64(R(C,"sha256")))),P},it.getJWKFromKey=function(c){return it.getJWK(c,!0,!0,!0,!0)},RSAKey.getPosArrayOfChildrenFromHex=function(c){return nt.getChildIdx(c,0)},RSAKey.getHexValueArrayOfChildrenFromHex=function(c){var p,v=nt.getV,x=v(c,(p=RSAKey.getPosArrayOfChildrenFromHex(c))[0]),E=v(c,p[1]),F=v(c,p[2]),C=v(c,p[3]),P=v(c,p[4]),R=v(c,p[5]),B=v(c,p[6]),T=v(c,p[7]),N=v(c,p[8]);return(p=new Array).push(x,E,F,C,P,R,B,T,N),p},RSAKey.prototype.readPrivateKeyFromPEMString=function(c){var p=pemtohex(c),v=RSAKey.getHexValueArrayOfChildrenFromHex(p);this.setPrivateEx(v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8])},RSAKey.prototype.readPKCS5PrvKeyHex=function(c){var p=RSAKey.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},RSAKey.prototype.readPKCS8PrvKeyHex=function(c){var p,v,x,E,F,C,P,R,B=nt,T=B.getVbyListEx;if(!1===B.isASN1HEX(c))throw new Error("not ASN.1 hex string");try{p=T(c,0,[2,0,1],"02"),v=T(c,0,[2,0,2],"02"),x=T(c,0,[2,0,3],"02"),E=T(c,0,[2,0,4],"02"),F=T(c,0,[2,0,5],"02"),C=T(c,0,[2,0,6],"02"),P=T(c,0,[2,0,7],"02"),R=T(c,0,[2,0,8],"02")}catch(N){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(p,v,x,E,F,C,P,R)},RSAKey.prototype.readPKCS5PubKeyHex=function(c){var p=nt,v=p.getV;if(!1===p.isASN1HEX(c))throw new Error("keyHex is not ASN.1 hex string");var x=p.getChildIdx(c,0);if(2!==x.length||"02"!==c.substr(x[0],2)||"02"!==c.substr(x[1],2))throw new Error("wrong hex for PKCS#5 public key");var E=v(c,x[0]),F=v(c,x[1]);this.setPublic(E,F)},RSAKey.prototype.readPKCS8PubKeyHex=function(c){var p=nt;if(!1===p.isASN1HEX(c))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==p.getTLVbyListEx(c,0,[0,0]))throw new Error("not PKCS8 RSA public key");var v=p.getTLVbyListEx(c,0,[1,0]);this.readPKCS5PubKeyHex(v)},RSAKey.prototype.readCertPubKeyHex=function(c,p){var v,x;(v=new X509).readCertHex(c),x=v.getPublicKeyHex(),this.readPKCS8PubKeyHex(x)};function _zeroPaddingOfSignature(c,p){for(var v="",x=p/4-c.length,E=0;E<x;E++)v+="0";return v+c}function pss_mgf1_str(c,p,v){for(var x="",E=0;x.length<p;)x+=hextorstr(v(rstrtohex(c+String.fromCharCode.apply(String,[(4278190080&E)>>24,(16711680&E)>>16,(65280&E)>>8,255&E])))),E+=1;return x}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(c){for(var p in tt.crypto.Util.DIGESTINFOHEAD){var v=tt.crypto.Util.DIGESTINFOHEAD[p],x=v.length;if(c.substring(0,x)==v)return[p,c.substring(x)]}return[]}function X509(c){var p,v=nt,x=v.getChildIdx,E=v.getV,F=(v.dump,v.parse),C=v.getTLV,P=v.getVbyList,R=v.getVbyListEx,B=v.getTLVbyList,T=v.getTLVbyListEx,N=v.getIdxbyList,_=v.getIdxbyListEx,L=v.getVidx,V=v.getInt,U=v.oidname,W=v.hextooidstr,G=pemtohex,J=Error;try{p=tt.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(X){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var c=B(this.hex,0,[0,0]);if("a0"==c.substr(0,2)){var p=B(c,0,[0]),v=V(p,0);if(v<0||2<v)throw new Error("malformed version field");return this.version=v+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return R(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var c=T(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(c)},this.getAlgorithmIdentifierName=function(c){for(var v in p)if(c===p[v])return v;return U(R(c,0,[0],"06"))},this.getIssuer=function(c,p){return this.getX500Name(this.getIssuerHex(),c,p)},this.getIssuerHex=function(){return B(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(c,p){return this.getX500Name(this.getSubjectHex(),c,p)},this.getSubjectHex=function(){return B(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var c=P(this.hex,0,[0,4+this.foffset,0]);return c=c.replace(/(..)/g,"%$1"),c=decodeURIComponent(c)},this.getNotAfter=function(){var c=P(this.hex,0,[0,4+this.foffset,1]);return c=c.replace(/(..)/g,"%$1"),c=decodeURIComponent(c)},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return B(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var c=this.getSPKI();return null==c?null:P(c,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return N(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var c=this.getPublicKeyIdx();return N(this.hex,c,[1,0],"30")},this.getPublicKey=function(){return it.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var c=B(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(c)},this.getSignatureValueHex=function(){return P(this.hex,0,[2],"03",!0)},this.verifySignature=function(c){var p=this.getSignatureAlgorithmField(),v=this.getSignatureValueHex(),x=B(this.hex,0,[0],"30"),E=new tt.crypto.Signature({alg:p});return E.init(c),E.updateHex(x),E.verify(v)},this.parseExt=function(c){var p,F,C;if(void 0===c){if(C=this.hex,3!==this.version)return-1;p=N(C,0,[0,7,0],"30"),F=x(C,p)}else{C=pemtohex(c);var R=N(C,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=E(C,R))return void(this.aExtInfo=new Array);p=N(C,0,[0,3,0,1,0],"30"),F=x(C,p),this.hex=C}this.aExtInfo=new Array;for(var B=0;B<F.length;B++){var T={critical:!1},_=0;3===x(C,F[B]).length&&(T.critical=!0,_=1),T.oid=v.hextooidstr(P(C,F[B],[0],"06"));var V=N(C,F[B],[1+_]);T.vidx=L(C,V),this.aExtInfo.push(T)}},this.getExtInfo=function(c){var p=this.aExtInfo,v=c;if(c.match(/^[0-9.]+$/)||(v=tt.asn1.x509.OID.name2oid(c)),""!==v)for(var x=0;x<p.length;x++)if(p[x].oid===v)return p[x]},this.getCriticalExtV=function(c,p,v){if(void 0!=p)return[p,v];var x=this.getExtInfo(c);return void 0==x?[null,null]:[C(this.hex,x.vidx),x.critical]},this.getExtBasicConstraints=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("basicConstraints");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var x={extname:"basicConstraints"};if(p&&(x.critical=!0),"3000"===c)return x;if("30030101ff"===c)return x.cA=!0,x;if("30060101ff02"===c.substr(0,12)){var F=E(c,10),P=parseInt(F,16);return x.cA=!0,x.pathLen=P,x}throw new Error("hExtV parse error: "+c)},this.getExtNameConstraints=function(c,p){var v=this.getCriticalExtV("nameConstraints",c,p);if(c=v[0],p=v[1],null!=c){var E={extname:"nameConstraints"};p&&(E.critical=!0);for(var F=x(c,0),P=0;P<F.length;P++){for(var R=[],B=x(c,F[P]),T=0;T<B.length;T++){var N=C(c,B[T]),_=this.getGeneralSubtree(N);R.push(_)}var L=c.substr(F[P],2);"a0"==L?E.permit=R:"a1"==L&&(E.exclude=R)}return E}},this.getGeneralSubtree=function(c){var p=x(c,0),v=p.length;if(v<1||2<v)throw new Error("wrong num elements");for(var F=this.getGeneralName(C(c,p[0])),P=1;P<v;P++){var R=c.substr(p[P],2),B=E(c,p[P]),T=parseInt(B,16);"80"==R&&(F.min=T),"81"==R&&(F.max=T)}return F},this.getExtKeyUsage=function(c,p){var v=this.getCriticalExtV("keyUsage",c,p);if(c=v[0],p=v[1],null!=c){var x={extname:"keyUsage"};return p&&(x.critical=!0),x.names=this.getExtKeyUsageString(c).split(","),x}},this.getExtKeyUsageBin=function(c){if(void 0===c){var p=this.getExtInfo("keyUsage");if(void 0===p)return"";c=C(this.hex,p.vidx)}if(8!=c.length&&10!=c.length)throw new Error("malformed key usage value: "+c);var v="000000000000000"+parseInt(c.substr(6),16).toString(2);return 8==c.length&&(v=v.slice(-8)),10==c.length&&(v=v.slice(-16)),""==(v=v.replace(/0+$/,""))&&(v="0"),v},this.getExtKeyUsageString=function(c){for(var p=this.getExtKeyUsageBin(c),v=new Array,x=0;x<p.length;x++)"1"==p.substr(x,1)&&v.push(X509.KEYUSAGE_NAME[x]);return v.join(",")},this.getExtSubjectKeyIdentifier=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("subjectKeyIdentifier");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var x={extname:"subjectKeyIdentifier"};p&&(x.critical=!0);var F=E(c,0);return x.kid={hex:F},x},this.getExtAuthorityKeyIdentifier=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("authorityKeyIdentifier");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var F={extname:"authorityKeyIdentifier"};p&&(F.critical=!0);for(var P=x(c,0),R=0;R<P.length;R++){var B=c.substr(P[R],2);if("80"===B&&(F.kid={hex:E(c,P[R])}),"a1"===B){var T=C(c,P[R]),N=this.getGeneralNames(T);F.issuer=N[0].dn}"82"===B&&(F.sn={hex:E(c,P[R])})}return F},this.getExtExtKeyUsage=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("extKeyUsage");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var F={extname:"extKeyUsage",array:[]};p&&(F.critical=!0);for(var P=x(c,0),R=0;R<P.length;R++)F.array.push(U(E(c,P[R])));return F},this.getExtExtKeyUsageName=function(){var c=this.getExtInfo("extKeyUsage");if(void 0===c)return c;var p=new Array,v=C(this.hex,c.vidx);if(""===v)return p;for(var F=x(v,0),P=0;P<F.length;P++)p.push(U(E(v,F[P])));return p},this.getExtSubjectAltName=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("subjectAltName");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var x={extname:"subjectAltName",array:[]};return p&&(x.critical=!0),x.array=this.getGeneralNames(c),x},this.getExtIssuerAltName=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("issuerAltName");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var x={extname:"issuerAltName",array:[]};return p&&(x.critical=!0),x.array=this.getGeneralNames(c),x},this.getGeneralNames=function(c){for(var p=x(c,0),v=[],E=0;E<p.length;E++){var F=this.getGeneralName(C(c,p[E]));void 0!==F&&v.push(F)}return v},this.getGeneralName=function(c){var p=c.substr(0,2),v=E(c,0),x=hextorstr(v);return"81"==p?{rfc822:x}:"82"==p?{dns:x}:"86"==p?{uri:x}:"87"==p?{ip:hextoip(v)}:"a4"==p?{dn:this.getX500Name(v)}:"a0"==p?{other:this.getOtherName(c)}:void 0},this.getExtSubjectAltName2=function(){var c,p,v,F=this.getExtInfo("subjectAltName");if(void 0===F)return F;for(var P=new Array,R=C(this.hex,F.vidx),B=x(R,0),T=0;T<B.length;T++)v=R.substr(B[T],2),c=E(R,B[T]),"81"===v&&(p=hextoutf8(c),P.push(["MAIL",p])),"82"===v&&(p=hextoutf8(c),P.push(["DNS",p])),"84"===v&&(p=X509.hex2dn(c,0),P.push(["DN",p])),"86"===v&&(p=hextoutf8(c),P.push(["URI",p])),"87"===v&&(p=hextoip(c),P.push(["IP",p]));return P},this.getExtCRLDistributionPoints=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("cRLDistributionPoints");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var E={extname:"cRLDistributionPoints",array:[]};p&&(E.critical=!0);for(var F=x(c,0),P=0;P<F.length;P++){var R=C(c,F[P]);E.array.push(this.getDistributionPoint(R))}return E},this.getDistributionPoint=function(c){for(var p={},v=x(c,0),E=0;E<v.length;E++){var F=c.substr(v[E],2),P=C(c,v[E]);"a0"==F&&(p.dpname=this.getDistributionPointName(P))}return p},this.getDistributionPointName=function(c){for(var p={},v=x(c,0),E=0;E<v.length;E++){var F=c.substr(v[E],2),P=C(c,v[E]);"a0"==F&&(p.full=this.getGeneralNames(P))}return p},this.getExtCRLDistributionPointsURI=function(){var c=this.getExtCRLDistributionPoints();if(void 0==c)return c;for(var p=c.array,v=[],x=0;x<p.length;x++)try{void 0!=p[x].dpname.full[0].uri&&v.push(p[x].dpname.full[0].uri)}catch(E){}return v},this.getExtAIAInfo=function(){var c=this.getExtInfo("authorityInfoAccess");if(void 0===c)return c;for(var p={ocsp:[],caissuer:[]},v=x(this.hex,c.vidx),E=0;E<v.length;E++){var F=P(this.hex,v[E],[0],"06"),C=P(this.hex,v[E],[1],"86");"2b06010505073001"===F&&p.ocsp.push(hextoutf8(C)),"2b06010505073002"===F&&p.caissuer.push(hextoutf8(C))}return p},this.getExtAuthorityInfoAccess=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("authorityInfoAccess");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var E={extname:"authorityInfoAccess",array:[]};p&&(E.critical=!0);for(var F=x(c,0),B=0;B<F.length;B++){var T=R(c,F[B],[0],"06"),N=hextoutf8(P(c,F[B],[1],"86"));if("2b06010505073001"==T)E.array.push({ocsp:N});else{if("2b06010505073002"!=T)throw new Error("unknown method: "+T);E.array.push({caissuer:N})}}return E},this.getExtCertificatePolicies=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("certificatePolicies");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var E={extname:"certificatePolicies",array:[]};p&&(E.critical=!0);for(var F=x(c,0),P=0;P<F.length;P++){var R=C(c,F[P]),B=this.getPolicyInformation(R);E.array.push(B)}return E},this.getPolicyInformation=function(c){var p={},v=P(c,0,[0],"06");p.policyoid=U(v);var E=_(c,0,[1],"30");if(-1!=E){p.array=[];for(var F=x(c,E),R=0;R<F.length;R++){var B=C(c,F[R]),T=this.getPolicyQualifierInfo(B);p.array.push(T)}}return p},this.getOtherName=function(c){var p={},v=x(c,0),E=P(c,v[0],[],"06"),C=P(c,v[1],[]);return p.oid=U(E),p.value=F(C),p},this.getPolicyQualifierInfo=function(c){var p={},v=P(c,0,[0],"06");if("2b06010505070201"===v){var x=R(c,0,[1],"16");p.cps=hextorstr(x)}else if("2b06010505070202"===v){var E=B(c,0,[1],"30");p.unotice=this.getUserNotice(E)}return p},this.getUserNotice=function(c){var p=null;try{return p=v.parse(c),this._asn1ToUnotice(p)}catch(x){return}},this._asn1ToUnotice=function(c){try{for(var p={},v=aryval(c,"seq"),x=0;x<v.length;x++){var E=this._asn1ToNoticeRef(v[x]);void 0!=E&&(p.noticeref=E);var F=this.asn1ToDisplayText(v[x]);void 0!=F&&(p.exptext=F)}return Object.keys(p).length>0?p:void 0}catch(C){return}},this._asn1ToNoticeRef=function(c){try{for(var p={},v=aryval(c,"seq"),x=0;x<v.length;x++){var E=this._asn1ToNoticeNum(v[x]);void 0!=E&&(p.noticenum=E);var F=this.asn1ToDisplayText(v[x]);void 0!=F&&(p.org=F)}return Object.keys(p).length>0?p:void 0}catch(C){return}},this._asn1ToNoticeNum=function(c){try{for(var p=aryval(c,"seq"),v=[],x=0;x<p.length;x++){var E=p[x];v.push(parseInt(aryval(E,"int.hex"),16))}return v}catch(F){return}},this.getDisplayText=function(c){var p={};return p.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[c.substr(0,2)],p.str=hextorstr(E(c,0)),p},this.asn1ToDisplayText=function(c){return void 0!=c.utf8str?{type:"utf8",str:c.utf8str.str}:void 0!=c.ia5str?{type:"ia5",str:c.ia5str.str}:void 0!=c.visstr?{type:"vis",str:c.visstr.str}:void 0!=c.bmpstr?{type:"bmp",str:c.bmpstr.str}:void 0!=c.prnstr?{type:"prn",str:c.prnstr.str}:void 0},this.getExtPolicyMappings=function(c,p){var v=this.getCriticalExtV("policyMappings",c,p);if(c=v[0],p=v[1],null!=c){var x={extname:"policyMappings"};p&&(x.critical=!0);try{for(var E=F(c).seq,C=[],P=0;P<E.length;P++){var R=E[P].seq;C.push([R[0].oid,R[1].oid])}x.array=C}catch(B){throw new J("malformed policyMappings")}return x}},this.getExtPolicyConstraints=function(c,p){var v=this.getCriticalExtV("policyConstraints",c,p);if(c=v[0],p=v[1],null!=c){var x={extname:"policyConstraints"};p&&(x.critical=!0);var E=F(c);try{for(var C=E.seq,P=0;P<C.length;P++){var R=C[P].tag;0==R.explicit&&("80"==R.tag&&(x.reqexp=parseInt(R.hex,16)),"81"==R.tag&&(x.inhibit=parseInt(R.hex,16)))}}catch(B){return new J("malformed policyConstraints value")}return x}},this.getExtInhibitAnyPolicy=function(c,p){var v=this.getCriticalExtV("inhibitAnyPolicy",c,p);if(c=v[0],p=v[1],null!=c){var x={extname:"inhibitAnyPolicy"};p&&(x.critical=!0);var E=V(c,0);return-1==E?new J("wrong value"):(x.skip=E,x)}},this.getExtCRLNumber=function(c,p){var v={extname:"cRLNumber"};if(p&&(v.critical=!0),"02"==c.substr(0,2))return v.num={hex:E(c,0)},v;throw new J("hExtV parse error: "+c)},this.getExtCRLReason=function(c,p){var v={extname:"cRLReason"};if(p&&(v.critical=!0),"0a"==c.substr(0,2))return v.code=parseInt(E(c,0),16),v;throw new Error("hExtV parse error: "+c)},this.getExtOcspNonce=function(c,p){var v={extname:"ocspNonce"};p&&(v.critical=!0);var x=E(c,0);return v.hex=x,v},this.getExtOcspNoCheck=function(c,p){var v={extname:"ocspNoCheck"};return p&&(v.critical=!0),v},this.getExtAdobeTimeStamp=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("adobeTimeStamp");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var E={extname:"adobeTimeStamp"};p&&(E.critical=!0);var F=x(c,0);if(F.length>1){var P=C(c,F[1]),R=this.getGeneralName(P);void 0!=R.uri&&(E.uri=R.uri)}if(F.length>2){var B=C(c,F[2]);"0101ff"==B&&(E.reqauth=!0),"010100"==B&&(E.reqauth=!1)}return E},this.getExtSubjectDirectoryAttributes=function(c,p){if(void 0===c&&void 0===p){var v=this.getExtInfo("subjectDirectoryAttributes");if(void 0===v)return;c=C(this.hex,v.vidx),p=v.critical}var x={extname:"subjectDirectoryAttributes"};p&&(x.critical=!0);try{for(var E=F(c),P=[],R=0;R<E.seq.length;R++){var B=E.seq[R],T=aryval(B,"seq.0.oid"),N=aryval(B,"seq.1.set");if(void 0==T||void 0==N)throw"error";P.push({attr:T,array:N})}return x.array=P,x}catch(_){throw new Error("malformed subjectDirectoryAttributes extension value")}};var e=function(c){var p={};try{var v=c.seq[0].oid,x=tt.asn1.x509.OID.name2oid(v);p.type=tt.asn1.x509.OID.oid2atype(x);var E=c.seq[1];if(void 0!=E.utf8str)p.ds="utf8",p.value=E.utf8str.str;else if(void 0!=E.numstr)p.ds="num",p.value=E.numstr.str;else if(void 0!=E.telstr)p.ds="tel",p.value=E.telstr.str;else if(void 0!=E.prnstr)p.ds="prn",p.value=E.prnstr.str;else if(void 0!=E.ia5str)p.ds="ia5",p.value=E.ia5str.str;else if(void 0!=E.visstr)p.ds="vis",p.value=E.visstr.str;else{if(void 0==E.bmpstr)throw"error";p.ds="bmp",p.value=E.bmpstr.str}return p}catch(F){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},i=function(c){try{return c.set.map((function(c){return e(c)}))}catch(Y){throw new Error("improper ASN.1 parsed RDN: "+Y)}};this.getX500NameRule=function(c){for(var p=null,v=[],x=0;x<c.length;x++)for(var E=c[x],F=0;F<E.length;F++)v.push(E[F]);for(x=0;x<v.length;x++){var C=v[x],P=C.ds,R=C.value,B=C.type;if(":"+P,"prn"!=P&&"utf8"!=P&&"ia5"!=P)return"mixed";if("ia5"==P){if("CN"!=B)return"mixed";if(tt.lang.String.isMail(R))continue;return"mixed"}if("C"==B){if("prn"==P)continue;return"mixed"}if(":"+P,null==p)p=P;else if(p!==P)return"mixed"}return null==p?"prn":p},this.getAttrTypeAndValue=function(c){var p=F(c);return e(p)},this.getRDN=function(c){var p=F(c);return i(p)},this.getX500NameArray=function(c){return function(p){try{return p.seq.map((function(c){return i(c)}))}catch(c){throw new Error("improper ASN.1 parsed X500Name: "+c)}}(F(c))},this.getX500Name=function(c,p,v){var x=this.getX500NameArray(c),E={str:this.dnarraytostr(x)};return E.array=x,1==v&&(E.hex=c),1==p&&(E.canon=this.c14nRDNArray(x)),E},this.readCertPEM=function(c){this.readCertHex(G(c))},this.readCertHex=function(c){this.hex=c,this.getVersion();try{N(this.hex,0,[0,7],"a3"),this.parseExt()}catch(p){}},this.getParam=function(c){var p={};return void 0==c&&(c={}),p.version=this.getVersion(),p.serial={hex:this.getSerialNumberHex()},p.sigalg=this.getSignatureAlgorithmField(),p.issuer=this.getIssuer(c.dncanon,c.dnhex),p.notbefore=this.getNotBefore(),p.notafter=this.getNotAfter(),p.subject=this.getSubject(c.dncanon,c.dnhex),p.sbjpubkey=hextopem(this.getPublicKeyHex(),"PUBLIC KEY"),void 0!=this.aExtInfo&&this.aExtInfo.length>0&&(p.ext=this.getExtParamArray()),p.sighex=this.getSignatureValueHex(),1==c.tbshex&&(p.tbshex=B(this.hex,0,[0])),1==c.nodnarray&&(delete p.issuer.array,delete p.subject.array),p},this.getExtParamArray=function(c){void 0==c&&(-1!=_(this.hex,0,[0,"[3]"])&&(c=T(this.hex,0,[0,"[3]",0],"30")));for(var p=[],v=x(c,0),E=0;E<v.length;E++){var F=C(c,v[E]),P=this.getExtParam(F);null!=P&&p.push(P)}return p},this.getExtParam=function(c){var p=x(c,0).length;if(2!=p&&3!=p)throw new Error("wrong number elements in Extension: "+p+" "+c);var v=W(P(c,0,[0],"06")),E=!1;3==p&&"0101ff"==B(c,0,[1])&&(E=!0);var C=B(c,0,[p-1,0]),R=void 0;if("2.5.29.14"==v?R=this.getExtSubjectKeyIdentifier(C,E):"2.5.29.15"==v?R=this.getExtKeyUsage(C,E):"2.5.29.17"==v?R=this.getExtSubjectAltName(C,E):"2.5.29.18"==v?R=this.getExtIssuerAltName(C,E):"2.5.29.19"==v?R=this.getExtBasicConstraints(C,E):"2.5.29.30"==v?R=this.getExtNameConstraints(C,E):"2.5.29.31"==v?R=this.getExtCRLDistributionPoints(C,E):"2.5.29.32"==v?R=this.getExtCertificatePolicies(C,E):"2.5.29.33"==v?R=this.getExtPolicyMappings(C,E):"2.5.29.35"==v?R=this.getExtAuthorityKeyIdentifier(C,E):"2.5.29.36"==v?R=this.getExtPolicyConstraints(C,E):"2.5.29.37"==v?R=this.getExtExtKeyUsage(C,E):"2.5.29.54"==v?R=this.getExtInhibitAnyPolicy(C,E):"1.3.6.1.5.5.7.1.1"==v?R=this.getExtAuthorityInfoAccess(C,E):"2.5.29.20"==v?R=this.getExtCRLNumber(C,E):"2.5.29.21"==v?R=this.getExtCRLReason(C,E):"2.5.29.9"==v?R=this.getExtSubjectDirectoryAttributes(C,E):"1.3.6.1.5.5.7.48.1.2"==v?R=this.getExtOcspNonce(C,E):"1.3.6.1.5.5.7.48.1.5"==v?R=this.getExtOcspNoCheck(C,E):"1.2.840.113583.1.1.9.1"==v?R=this.getExtAdobeTimeStamp(C,E):void 0!=X509.EXT_PARSER[v]&&(R=X509.EXT_PARSER[v](v,E,C)),void 0!=R)return R;var T={extname:v,extn:C};try{T.extn=F(C)}catch(N){}return E&&(T.critical=!0),T},this.findExt=function(c,p){for(var v=0;v<c.length;v++)if(c[v].extname==p)return c[v];return null},this.updateExtCDPFullURI=function(c,p){var v=this.findExt(c,"cRLDistributionPoints");if(null!=v&&void 0!=v.array)for(var x=v.array,E=0;E<x.length;E++)if(void 0!=x[E].dpname&&void 0!=x[E].dpname.full)for(var F=x[E].dpname.full,C=0;C<F.length;C++){var P=F[E];void 0!=P.uri&&(P.uri=p)}},this.updateExtAIAOCSP=function(c,p){var v=this.findExt(c,"authorityInfoAccess");if(null!=v&&void 0!=v.array)for(var x=v.array,E=0;E<x.length;E++)void 0!=x[E].ocsp&&(x[E].ocsp=p)},this.updateExtAIACAIssuer=function(c,p){var v=this.findExt(c,"authorityInfoAccess");if(null!=v&&void 0!=v.array)for(var x=v.array,E=0;E<x.length;E++)void 0!=x[E].caissuer&&(x[E].caissuer=p)},this.dnarraytostr=function(c){return"/"+c.map((function(c){return function z(c){return c.map((function(c){return function A(c){return c.type+"="+c.value}(c).replace(/\+/,"\\+")})).join("+")}(c).replace(/\//,"\\/")})).join("/")},this.setCanonicalizedDN=function(c){var p;if(void 0!=c.str&&void 0==c.array){var v=new tt.asn1.x509.X500Name({str:c.str}).tohex();p=this.getX500NameArray(v)}else p=c.array;void 0==c.canon&&(c.canon=this.c14nRDNArray(p))},this.c14nRDNArray=function(c){for(var p=[],v=0;v<c.length;v++){for(var x=c[v],E=[],F=0;F<x.length;F++){var C=x[F],P=C.value;P=(P=(P=(P=P.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),E.push(C.type.toLowerCase()+"="+P)}p.push(E.join("+"))}return"/"+p.join("/")},this.getInfo=function(){var c,p,v,A=function(c){for(var p="",v="    ",x="\n",E=c.array,F=0;F<E.length;F++){var C=E[F];if(void 0!=C.dn&&(p+=v+"dn: "+C.dn.str+x),void 0!=C.ip&&(p+=v+"ip: "+C.ip+x),void 0!=C.rfc822&&(p+=v+"rfc822: "+C.rfc822+x),void 0!=C.dns&&(p+=v+"dns: "+C.dns+x),void 0!=C.uri&&(p+=v+"uri: "+C.uri+x),void 0!=C.other)p+=v+"other: "+C.other.oid+"="+JSON.stringify(C.other.value).replace(/\"/g,"")+x}return p=p.replace(/\n$/,"")},H=function(c){for(var p="",v=c.array,x=0;x<v.length;x++){var E=v[x];if(p+="    policy oid: "+E.policyoid+"\n",void 0!==E.array)for(var F=0;F<E.array.length;F++){var C=E.array[F];void 0!==C.cps&&(p+="    cps: "+C.cps+"\n")}}return p},K=function(c){for(var p="",v=c.array,x=0;x<v.length;x++){var E=v[x];try{void 0!==E.dpname.full[0].uri&&(p+="    "+E.dpname.full[0].uri+"\n")}catch(F){}try{void 0!==E.dname.full[0].dn.hex&&(p+="    "+X509.hex2dn(E.dpname.full[0].dn.hex)+"\n")}catch(F){}}return p},I=function(c){for(var p="",v=c.array,x=0;x<v.length;x++){var E=v[x];void 0!==E.caissuer&&(p+="    caissuer: "+E.caissuer+"\n"),void 0!==E.ocsp&&(p+="    ocsp: "+E.ocsp+"\n")}return p};if(c="Basic Fields\n",c+="  serial number: "+this.getSerialNumberHex()+"\n",c+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",c+="  issuer: "+this.getIssuerString()+"\n",c+="  notBefore: "+this.getNotBefore()+"\n",c+="  notAfter: "+this.getNotAfter()+"\n",c+="  subject: "+this.getSubjectString()+"\n",c+="  subject public key info: \n",c+="    key algorithm: "+(p=this.getPublicKey()).type+"\n","RSA"===p.type&&(c+="    n="+hextoposhex(p.n.toString(16)).substr(0,16)+"...\n",c+="    e="+hextoposhex(p.e.toString(16))+"\n"),void 0!==(v=this.aExtInfo)&&null!==v){c+="X509v3 Extensions:\n";for(var x=0;x<v.length;x++){var E=v[x],F=tt.asn1.x509.OID.oid2name(E.oid);""===F&&(F=E.oid);var C="";if(!0===E.critical&&(C="CRITICAL"),c+="  "+F+" "+C+":\n","basicConstraints"===F){var P=this.getExtBasicConstraints();void 0===P.cA?c+="    {}\n":(c+="    cA=true",void 0!==P.pathLen&&(c+=", pathLen="+P.pathLen),c+="\n")}else{var R;if("policyMappings"==F)c+="    "+this.getExtPolicyMappings().array.map((function(c){var p=c;return p[0]+":"+p[1]})).join(", ")+"\n";else if("policyConstraints"==F)c+="    ",void 0!=(R=this.getExtPolicyConstraints()).reqexp&&(c+=" reqexp="+R.reqexp),void 0!=R.inhibit&&(c+=" inhibit="+R.inhibit),c+="\n";else if("inhibitAnyPolicy"==F)c+="    skip="+(R=this.getExtInhibitAnyPolicy()).skip+"\n";else if("keyUsage"==F)c+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"==F)c+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"==F){var B=this.getExtAuthorityKeyIdentifier();void 0!==B.kid&&(c+="    kid="+B.kid.hex+"\n")}else{if("extKeyUsage"==F)c+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n";else if("subjectAltName"==F)c+=A(this.getExtSubjectAltName())+"\n";else if("cRLDistributionPoints"==F)c+=K(this.getExtCRLDistributionPoints());else if("authorityInfoAccess"==F)c+=I(this.getExtAuthorityInfoAccess());else"certificatePolicies"==F&&(c+=H(this.getExtCertificatePolicies()))}}}}return c+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",c+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof c&&(-1!=c.indexOf("-----BEGIN")?this.readCertPEM(c):tt.lang.String.isHex(c)&&this.readCertHex(c))}RSAKey.prototype.sign=function(c,p){var v,x=(v=c,tt.crypto.Util.hashString(v,p));return this.signWithMessageHash(x,p)},RSAKey.prototype.signWithMessageHash=function(c,p){var v=parseBigInt(tt.crypto.Util.getPaddedDigestInfoHex(c,p,this.n.bitLength()),16);return _zeroPaddingOfSignature(this.doPrivate(v).toString(16),this.n.bitLength())},RSAKey.prototype.signPSS=function(c,p,v){var x,E=(x=rstrtohex(c),tt.crypto.Util.hashHex(x,p));return void 0===v&&(v=-1),this.signWithMessageHashPSS(E,p,v)},RSAKey.prototype.signWithMessageHashPSS=function(c,p,v){var x,E=hextorstr(c),F=E.length,C=this.n.bitLength()-1,P=Math.ceil(C/8),o=function(c){return tt.crypto.Util.hashHex(c,p)};if(-1===v||void 0===v)v=F;else if(-2===v)v=P-F-2;else if(v<-2)throw new Error("invalid salt length");if(P<F+v+2)throw new Error("data too long");var R="";v>0&&(R=new Array(v),(new SecureRandom).nextBytes(R),R=String.fromCharCode.apply(String,R));var B=hextorstr(o(rstrtohex("\0\0\0\0\0\0\0\0"+E+R))),T=[];for(x=0;x<P-v-F-2;x+=1)T[x]=0;var N=String.fromCharCode.apply(String,T)+"\x01"+R,_=pss_mgf1_str(B,N.length,o),L=[];for(x=0;x<N.length;x+=1)L[x]=N.charCodeAt(x)^_.charCodeAt(x);var V=65280>>8*P-C&255;for(L[0]&=~V,x=0;x<F;x++)L.push(B.charCodeAt(x));return L.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(L)).toString(16),this.n.bitLength())},RSAKey.prototype.verify=function(c,p){if(null==(p=p.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var v=parseBigInt(p,16),x=this.n.bitLength();if(v.bitLength()>x)return!1;var E=this.doPublic(v).toString(16);if(E.length+3!=x/4)return!1;var F=_rsasign_getAlgNameAndHashFromHexDisgestInfo(E.replace(/^1f+00/,""));if(0==F.length)return!1;var C,P=F[0];return F[1]==(C=c,tt.crypto.Util.hashString(C,P))},RSAKey.prototype.verifyWithMessageHash=function(c,p){if(p.length!=Math.ceil(this.n.bitLength()/4))return!1;var v=parseBigInt(p,16);if(v.bitLength()>this.n.bitLength())return 0;var x=_rsasign_getAlgNameAndHashFromHexDisgestInfo(this.doPublic(v).toString(16).replace(/^1f+00/,""));if(0==x.length)return!1;x[0];return x[1]==c},RSAKey.prototype.verifyPSS=function(c,p,v,x){var E,F=(E=rstrtohex(c),tt.crypto.Util.hashHex(E,v));return void 0===x&&(x=-1),this.verifyWithMessageHashPSS(F,p,v,x)},RSAKey.prototype.verifyWithMessageHashPSS=function(c,p,v,x){if(p.length!=Math.ceil(this.n.bitLength()/4))return!1;var E,F=new BigInteger(p,16),r=function(c){return tt.crypto.Util.hashHex(c,v)},C=hextorstr(c),P=C.length,R=this.n.bitLength()-1,B=Math.ceil(R/8);if(-1===x||void 0===x)x=P;else if(-2===x)x=B-P-2;else if(x<-2)throw new Error("invalid salt length");if(B<P+x+2)throw new Error("data too long");var T=this.doPublic(F).toByteArray();for(E=0;E<T.length;E+=1)T[E]&=255;for(;T.length<B;)T.unshift(0);if(188!==T[B-1])throw new Error("encoded message does not end in 0xbc");var N=(T=String.fromCharCode.apply(String,T)).substr(0,B-P-1),_=T.substr(N.length,P),L=65280>>8*B-R&255;if(0!==(N.charCodeAt(0)&L))throw new Error("bits beyond keysize not zero");var V=pss_mgf1_str(_,N.length,r),U=[];for(E=0;E<N.length;E+=1)U[E]=N.charCodeAt(E)^V.charCodeAt(E);U[0]&=~L;var W=B-P-x-2;for(E=0;E<W;E+=1)if(0!==U[E])throw new Error("leftmost octets not zero");if(1!==U[W])throw new Error("0x01 marker not found");return _===hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+C+String.fromCharCode.apply(String,U.slice(-x)))))},RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.SALT_LEN_RECOVER=-2,X509.EXT_PARSER={},X509.registExtParser=function(c,p){X509.EXT_PARSER[c]=p},X509.hex2dn=function(c,p){void 0===p&&(p=0);var v=new X509;nt.getTLV(c,p);return v.getX500Name(c).str},X509.hex2rdn=function(c,p){if(void 0===p&&(p=0),"31"!==c.substr(p,2))throw new Error("malformed RDN");for(var v=new Array,x=nt.getChildIdx(c,p),E=0;E<x.length;E++)v.push(X509.hex2attrTypeValue(c,x[E]));return(v=v.map((function(c){return c.replace("+","\\+")}))).join("+")},X509.hex2attrTypeValue=function(c,p){var v=nt,x=v.getV;if(void 0===p&&(p=0),"30"!==c.substr(p,2))throw new Error("malformed attribute type and value");var E=v.getChildIdx(c,p);2!==E.length||c.substr(E[0],2);var F=x(c,E[0]),C=tt.asn1.ASN1Util.oidHexToInt(F);return tt.asn1.x509.OID.oid2atype(C)+"="+hextorstr(x(c,E[1]))},X509.getPublicKeyFromCertHex=function(c){var p=new X509;return p.readCertHex(c),p.getPublicKey()},X509.getPublicKeyFromCertPEM=function(c){var p=new X509;return p.readCertPEM(c),p.getPublicKey()},X509.getPublicKeyInfoPropOfCertPEM=function(c){var p,v,x=nt.getVbyList,E={};return E.algparam=null,(p=new X509).readCertPEM(c),v=p.getPublicKeyHex(),E.keyhex=x(v,0,[1],"03").substr(2),E.algoid=x(v,0,[0,0],"06"),"2a8648ce3d0201"===E.algoid&&(E.algparam=x(v,0,[0,1],"06")),E},X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.jws&&tt.jws||(tt.jws={}),tt.jws.JWS=function(){var c=tt.jws.JWS.isSafeJSONString;this.parseJWS=function(p,v){if(void 0===this.parsedJWS||!v&&void 0===this.parsedJWS.sigvalH){var x=p.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==x)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var E=x[1],F=x[2],C=x[3],P=E+"."+F;if(this.parsedJWS={},this.parsedJWS.headB64U=E,this.parsedJWS.payloadB64U=F,this.parsedJWS.sigvalB64U=C,this.parsedJWS.si=P,!v){var R=b64utohex(C),B=parseBigInt(R,16);this.parsedJWS.sigvalH=R,this.parsedJWS.sigvalBI=B}var T=rt(E),N=rt(F);if(this.parsedJWS.headS=T,this.parsedJWS.payloadS=N,!c(T,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+T}}},tt.jws.JWS.sign=function(c,p,v,x,E){var F,C,P,R=tt,B=R.jws.JWS,T=B.readSafeJSONString,N=B.isSafeJSONString,_=R.crypto,L=(_.ECDSA,_.Mac),V=_.Signature,U=JSON;if("string"!=typeof p&&"object"!=typeof p)throw"spHeader must be JSON string or object: "+p;if("object"==typeof p&&(C=p,F=U.stringify(C)),"string"==typeof p){if(!N(F=p))throw"JWS Head is not safe JSON string: "+F;C=T(F)}if(P=v,"object"==typeof v&&(P=U.stringify(v)),""!=c&&null!=c||void 0===C.alg||(c=C.alg),""!=c&&null!=c&&void 0===C.alg&&(C.alg=c,F=U.stringify(C)),c!==C.alg)throw"alg and sHeader.alg doesn't match: "+c+"!="+C.alg;var W=null;if(void 0===B.jwsalg2sigalg[c])throw"unsupported alg name: "+c;W=B.jwsalg2sigalg[c];var G=et(F)+"."+et(P),X="";if("Hmac"==W.substr(0,4)){if(void 0===x)throw"mac key shall be specified for HS* alg";var J=new L({alg:W,prov:"cryptojs",pass:x});J.updateString(G),X=J.doFinal()}else if(-1!=W.indexOf("withECDSA")){(Y=new V({alg:W})).init(x,E),Y.updateString(G);var Z=Y.sign();X=tt.crypto.ECDSA.asn1SigToConcatSig(Z)}else{var Y;if("none"!=W)(Y=new V({alg:W})).init(x,E),Y.updateString(G),X=Y.sign()}return G+"."+hextob64u(X)},tt.jws.JWS.verify=function(c,p,v){var x,E=tt,F=E.jws.JWS,C=F.readSafeJSONString,P=E.crypto,R=P.ECDSA,B=P.Mac,T=P.Signature;if(x=RSAKey,!isBase64URLDot(c))return!1;var N=c.split(".");if(3!==N.length)return!1;var _=N[0]+"."+N[1],L=b64utohex(N[2]),V=C(rt(N[0])),U=null,W=null;if(void 0===V.alg)throw"algorithm not specified in header";if((W=(U=V.alg).substr(0,2),null!=v&&"[object Array]"===Object.prototype.toString.call(v)&&v.length>0)&&-1==(":"+v.join(":")+":").indexOf(":"+U+":"))throw"algorithm '"+U+"' not accepted in the list";if("none"!=U&&null===p)throw"key shall be specified to verify.";if("string"==typeof p&&-1!=p.indexOf("-----BEGIN ")&&(p=it.getKey(p)),("RS"==W||"PS"==W)&&!(p instanceof x))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==W&&!(p instanceof R))throw"key shall be a ECDSA obj for ES* algs";var G=null;if(void 0===F.jwsalg2sigalg[V.alg])throw"unsupported alg name: "+U;if("none"==(G=F.jwsalg2sigalg[U]))throw"not supported";if("Hmac"==G.substr(0,4)){if(void 0===p)throw"hexadecimal key shall be specified for HMAC";var X=new B({alg:G,pass:p});return X.updateString(_),L==X.doFinal()}if(-1!=G.indexOf("withECDSA")){var J,Z=null;try{Z=R.concatSigToASN1Sig(L)}catch(Y){return!1}return(J=new T({alg:G})).init(p),J.updateString(_),J.verify(Z)}return(J=new T({alg:G})).init(p),J.updateString(_),J.verify(L)},tt.jws.JWS.parse=function(c){var p,v,x,E=c.split("."),F={};if(2!=E.length&&3!=E.length)throw"malformed sJWS: wrong number of '.' splitted elements";return p=E[0],v=E[1],3==E.length&&(x=E[2]),F.headerObj=tt.jws.JWS.readSafeJSONString(rt(p)),F.payloadObj=tt.jws.JWS.readSafeJSONString(rt(v)),F.headerPP=JSON.stringify(F.headerObj,null,"  "),null==F.payloadObj?F.payloadPP=rt(v):F.payloadPP=JSON.stringify(F.payloadObj,null,"  "),void 0!==x&&(F.sigHex=b64utohex(x)),F},tt.jws.JWS.verifyJWT=function(c,p,v){var x=tt.jws,E=x.JWS,F=E.readSafeJSONString,C=E.inArray,P=E.includedArray;if(!isBase64URLDot(c))return!1;var R=c.split(".");if(3!=R.length)return!1;var B=R[0],T=R[1],N=(b64utohex(R[2]),F(rt(B))),_=F(rt(T));if(void 0===N.alg)return!1;if(void 0===v.alg)throw"acceptField.alg shall be specified";if(!C(N.alg,v.alg))return!1;if(void 0!==_.iss&&"object"===typeof v.iss&&!C(_.iss,v.iss))return!1;if(void 0!==_.sub&&"object"===typeof v.sub&&!C(_.sub,v.sub))return!1;if(void 0!==_.aud&&"object"===typeof v.aud)if("string"==typeof _.aud){if(!C(_.aud,v.aud))return!1}else if("object"==typeof _.aud&&!P(_.aud,v.aud))return!1;var L=x.IntDate.getNow();return void 0!==v.verifyAt&&"number"===typeof v.verifyAt&&(L=v.verifyAt),void 0!==v.gracePeriod&&"number"===typeof v.gracePeriod||(v.gracePeriod=0),!(void 0!==_.exp&&"number"==typeof _.exp&&_.exp+v.gracePeriod<L)&&(!(void 0!==_.nbf&&"number"==typeof _.nbf&&L<_.nbf-v.gracePeriod)&&(!(void 0!==_.iat&&"number"==typeof _.iat&&L<_.iat-v.gracePeriod)&&((void 0===_.jti||void 0===v.jti||_.jti===v.jti)&&!!E.verify(c,p,v.alg))))},tt.jws.JWS.includedArray=function(c,p){var v=tt.jws.JWS.inArray;if(null===c)return!1;if("object"!==typeof c)return!1;if("number"!==typeof c.length)return!1;for(var x=0;x<c.length;x++)if(!v(c[x],p))return!1;return!0},tt.jws.JWS.inArray=function(c,p){if(null===p)return!1;if("object"!==typeof p)return!1;if("number"!==typeof p.length)return!1;for(var v=0;v<p.length;v++)if(p[v]==c)return!0;return!1},tt.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},tt.jws.JWS.isSafeJSONString=function(c,p,v){var x=null;try{return"object"!=typeof(x=Q(c))||x.constructor===Array?0:(p&&(p[v]=x),1)}catch(E){return 0}},tt.jws.JWS.readSafeJSONString=function(c){var p=null;try{return"object"!=typeof(p=Q(c))||p.constructor===Array?null:p}catch(v){return null}},tt.jws.JWS.getEncodedSignatureValueFromJWS=function(c){var p=c.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==p)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return p[1]},tt.jws.JWS.getJWKthumbprint=function(c){if("RSA"!==c.kty&&"EC"!==c.kty&&"oct"!==c.kty)throw"unsupported algorithm for JWK Thumprint";var p="{";if("RSA"===c.kty){if("string"!=typeof c.n||"string"!=typeof c.e)throw"wrong n and e value for RSA key";p+='"e":"'+c.e+'",',p+='"kty":"'+c.kty+'",',p+='"n":"'+c.n+'"}'}else if("EC"===c.kty){if("string"!=typeof c.crv||"string"!=typeof c.x||"string"!=typeof c.y)throw"wrong crv, x and y value for EC key";p+='"crv":"'+c.crv+'",',p+='"kty":"'+c.kty+'",',p+='"x":"'+c.x+'",',p+='"y":"'+c.y+'"}'}else if("oct"===c.kty){if("string"!=typeof c.k)throw"wrong k value for oct(symmetric) key";p+='"kty":"'+c.kty+'",',p+='"k":"'+c.k+'"}'}var v=rstrtohex(p);return hextob64u(tt.crypto.Util.hashHex(v,"sha256"))},tt.jws.IntDate={},tt.jws.IntDate.get=function(c){var p=tt.jws.IntDate,v=p.getNow,x=p.getZulu;if("now"==c)return v();if("now + 1hour"==c)return v()+3600;if("now + 1day"==c)return v()+86400;if("now + 1month"==c)return v()+2592e3;if("now + 1year"==c)return v()+31536e3;if(c.match(/Z$/))return x(c);if(c.match(/^[0-9]+$/))return parseInt(c);throw"unsupported format: "+c},tt.jws.IntDate.getZulu=function(c){return zulutosec(c)},tt.jws.IntDate.getNow=function(){return~~(new Date/1e3)},tt.jws.IntDate.intDate2UTCString=function(c){return new Date(1e3*c).toUTCString()},tt.jws.IntDate.intDate2Zulu=function(c){var p=new Date(1e3*c);return("0000"+p.getUTCFullYear()).slice(-4)+("00"+(p.getUTCMonth()+1)).slice(-2)+("00"+p.getUTCDate()).slice(-2)+("00"+p.getUTCHours()).slice(-2)+("00"+p.getUTCMinutes()).slice(-2)+("00"+p.getUTCSeconds()).slice(-2)+"Z"},"undefined"!=typeof tt&&tt||(tt={}),"undefined"!=typeof tt.jws&&tt.jws||(tt.jws={}),tt.jws.JWSJS=function(){var c=tt.jws.JWS,p=c.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(c){this.init();var p=c.split(".");if(3!=p.length)throw"malformed input JWS";this.aHeader.push(p[0]),this.sPayload=p[1],this.aSignature.push(p[2])},this.addSignature=function(c,p,v,x){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var E=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var F=tt.jws.JWS.sign(c,p,this.sPayload,v,x).split(".");F[0],F[2];this.aHeader.push(F[0]),this.aSignature.push(F[2])}catch(C){throw this.aHeader.length>E&&this.aHeader.pop(),this.aSignature.length>E&&this.aSignature.pop(),"addSignature failed: "+C}},this.verifyAll=function(c){if(this.aHeader.length!==c.length||this.aSignature.length!==c.length)return!1;for(var p=0;p<c.length;p++){var v=c[p];if(2!==v.length)return!1;if(!1===this.verifyNth(p,v[0],v[1]))return!1}return!0},this.verifyNth=function(p,v,x){if(this.aHeader.length<=p||this.aSignature.length<=p)return!1;var E=this.aHeader[p],F=this.aSignature[p],C=E+"."+this.sPayload+"."+F,P=!1;try{P=c.verify(C,v,x)}catch(R){return!1}return P},this.readJWSJS=function(c){if("string"===typeof c){var v=p(c);if(null==v)throw"argument is not safe JSON object string";this.aHeader=v.headers,this.sPayload=v.payload,this.aSignature=v.signatures}else try{if(!(c.headers.length>0))throw"malformed header";if(this.aHeader=c.headers,"string"!==typeof c.payload)throw"malformed signatures";if(this.sPayload=c.payload,!(c.signatures.length>0))throw"malformed signatures";this.aSignature=c.signatures}catch(x){throw"malformed JWS-JS JSON object: "+x}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}},tt.crypto.ECDSA,tt.crypto.DSA,tt.crypto.Signature,tt.crypto.MessageDigest,tt.crypto.Mac,tt.crypto.Cipher,p.ym=it,p.wV=hextob64u,p.pj=tt,tt.crypto,tt.asn1,tt.jws,tt.lang},619:(c,p,v)=>{"use strict";v.d(p,{Authing:()=>Authing_Authing,TjSSoAuthing:()=>TjSSoAuthing,isMobileEnv:()=>isMobileEnv,loginSuccess:()=>loginSuccess});var x={};v.r(x),v.d(x,{hasBrowserEnv:()=>xt,hasStandardBrowserEnv:()=>St,hasStandardBrowserWebWorkerEnv:()=>wt});const E="xWIqqaOPHQqJ",F="2a06IArpGsVH9qLH8C1U1";window.location.protocol,window.location.host;function bind(c,p){return function wrap(){return c.apply(p,arguments)}}const{toString:C}=Object.prototype,{getPrototypeOf:P}=Object,R=(B=Object.create(null),c=>{const p=C.call(c);return B[p]||(B[p]=p.slice(8,-1).toLowerCase())});var B;const kindOfTest=c=>(c=c.toLowerCase(),p=>R(p)===c),typeOfTest=c=>p=>typeof p===c,{isArray:T}=Array,N=typeOfTest("undefined");const _=kindOfTest("ArrayBuffer");const L=typeOfTest("string"),V=typeOfTest("function"),U=typeOfTest("number"),isObject=c=>null!==c&&"object"===typeof c,isPlainObject=c=>{if("object"!==R(c))return!1;const p=P(c);return(null===p||p===Object.prototype||null===Object.getPrototypeOf(p))&&!(Symbol.toStringTag in c)&&!(Symbol.iterator in c)},W=kindOfTest("Date"),G=kindOfTest("File"),X=kindOfTest("Blob"),J=kindOfTest("FileList"),Z=kindOfTest("URLSearchParams");function forEach(c,p,{allOwnKeys:v=!1}={}){if(null===c||"undefined"===typeof c)return;let x,E;if("object"!==typeof c&&(c=[c]),T(c))for(x=0,E=c.length;x<E;x++)p.call(null,c[x],x,c);else{const E=v?Object.getOwnPropertyNames(c):Object.keys(c),F=E.length;let C;for(x=0;x<F;x++)C=E[x],p.call(null,c[C],C,c)}}function findKey(c,p){p=p.toLowerCase();const v=Object.keys(c);let x,E=v.length;for(;E-- >0;)if(x=v[E],p===x.toLowerCase())return x;return null}const Y="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,isContextDefined=c=>!N(c)&&c!==Y;const Q=(tt="undefined"!==typeof Uint8Array&&P(Uint8Array),c=>tt&&c instanceof tt);var tt;const et=kindOfTest("HTMLFormElement"),rt=(({hasOwnProperty:c})=>(p,v)=>c.call(p,v))(Object.prototype),nt=kindOfTest("RegExp"),reduceDescriptors=(c,p)=>{const v=Object.getOwnPropertyDescriptors(c),x={};forEach(v,((v,E)=>{let F;!1!==(F=p(v,E,c))&&(x[E]=F||v)})),Object.defineProperties(c,x)},it="abcdefghijklmnopqrstuvwxyz",st="0123456789",at={DIGIT:st,ALPHA:it,ALPHA_DIGIT:it+it.toUpperCase()+st};const ot=kindOfTest("AsyncFunction"),ct={isArray:T,isArrayBuffer:_,isBuffer:function isBuffer(c){return null!==c&&!N(c)&&null!==c.constructor&&!N(c.constructor)&&V(c.constructor.isBuffer)&&c.constructor.isBuffer(c)},isFormData:c=>{let p;return c&&("function"===typeof FormData&&c instanceof FormData||V(c.append)&&("formdata"===(p=R(c))||"object"===p&&V(c.toString)&&"[object FormData]"===c.toString()))},isArrayBufferView:function isArrayBufferView(c){let p;return p="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer&&_(c.buffer),p},isString:L,isNumber:U,isBoolean:c=>!0===c||!1===c,isObject:isObject,isPlainObject:isPlainObject,isUndefined:N,isDate:W,isFile:G,isBlob:X,isRegExp:nt,isFunction:V,isStream:c=>isObject(c)&&V(c.pipe),isURLSearchParams:Z,isTypedArray:Q,isFileList:J,forEach:forEach,merge:function merge(){const{caseless:c}=isContextDefined(this)&&this||{},p={},assignValue=(v,x)=>{const E=c&&findKey(p,x)||x;isPlainObject(p[E])&&isPlainObject(v)?p[E]=merge(p[E],v):isPlainObject(v)?p[E]=merge({},v):T(v)?p[E]=v.slice():p[E]=v};for(let v=0,x=arguments.length;v<x;v++)arguments[v]&&forEach(arguments[v],assignValue);return p},extend:(c,p,v,{allOwnKeys:x}={})=>(forEach(p,((p,x)=>{v&&V(p)?c[x]=bind(p,v):c[x]=p}),{allOwnKeys:x}),c),trim:c=>c.trim?c.trim():c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:c=>(65279===c.charCodeAt(0)&&(c=c.slice(1)),c),inherits:(c,p,v,x)=>{c.prototype=Object.create(p.prototype,x),c.prototype.constructor=c,Object.defineProperty(c,"super",{value:p.prototype}),v&&Object.assign(c.prototype,v)},toFlatObject:(c,p,v,x)=>{let E,F,C;const R={};if(p=p||{},null==c)return p;do{for(E=Object.getOwnPropertyNames(c),F=E.length;F-- >0;)C=E[F],x&&!x(C,c,p)||R[C]||(p[C]=c[C],R[C]=!0);c=!1!==v&&P(c)}while(c&&(!v||v(c,p))&&c!==Object.prototype);return p},kindOf:R,kindOfTest:kindOfTest,endsWith:(c,p,v)=>{c=String(c),(void 0===v||v>c.length)&&(v=c.length),v-=p.length;const x=c.indexOf(p,v);return-1!==x&&x===v},toArray:c=>{if(!c)return null;if(T(c))return c;let p=c.length;if(!U(p))return null;const v=new Array(p);for(;p-- >0;)v[p]=c[p];return v},forEachEntry:(c,p)=>{const v=(c&&c[Symbol.iterator]).call(c);let x;for(;(x=v.next())&&!x.done;){const v=x.value;p.call(c,v[0],v[1])}},matchAll:(c,p)=>{let v;const x=[];for(;null!==(v=c.exec(p));)x.push(v);return x},isHTMLForm:et,hasOwnProperty:rt,hasOwnProp:rt,reduceDescriptors:reduceDescriptors,freezeMethods:c=>{reduceDescriptors(c,((p,v)=>{if(V(c)&&-1!==["arguments","caller","callee"].indexOf(v))return!1;const x=c[v];V(x)&&(p.enumerable=!1,"writable"in p?p.writable=!1:p.set||(p.set=()=>{throw Error("Can not rewrite read-only method '"+v+"'")}))}))},toObjectSet:(c,p)=>{const v={},define=c=>{c.forEach((c=>{v[c]=!0}))};return T(c)?define(c):define(String(c).split(p)),v},toCamelCase:c=>c.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function replacer(c,p,v){return p.toUpperCase()+v})),noop:()=>{},toFiniteNumber:(c,p)=>(c=+c,Number.isFinite(c)?c:p),findKey:findKey,global:Y,isContextDefined:isContextDefined,ALPHABET:at,generateString:(c=16,p=at.ALPHA_DIGIT)=>{let v="";const{length:x}=p;for(;c--;)v+=p[Math.random()*x|0];return v},isSpecCompliantForm:function isSpecCompliantForm(c){return!!(c&&V(c.append)&&"FormData"===c[Symbol.toStringTag]&&c[Symbol.iterator])},toJSONObject:c=>{const p=new Array(10),visit=(c,v)=>{if(isObject(c)){if(p.indexOf(c)>=0)return;if(!("toJSON"in c)){p[v]=c;const x=T(c)?[]:{};return forEach(c,((c,p)=>{const E=visit(c,v+1);!N(E)&&(x[p]=E)})),p[v]=void 0,x}}return c};return visit(c,0)},isAsyncFn:ot,isThenable:c=>c&&(isObject(c)||V(c))&&V(c.then)&&V(c.catch)};function AxiosError(c,p,v,x,E){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=c,this.name="AxiosError",p&&(this.code=p),v&&(this.config=v),x&&(this.request=x),E&&(this.response=E)}ct.inherits(AxiosError,Error,{toJSON:function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ct.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const ht=AxiosError.prototype,ut={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((c=>{ut[c]={value:c}})),Object.defineProperties(AxiosError,ut),Object.defineProperty(ht,"isAxiosError",{value:!0}),AxiosError.from=(c,p,v,x,E,F)=>{const C=Object.create(ht);return ct.toFlatObject(c,C,(function filter(c){return c!==Error.prototype}),(c=>"isAxiosError"!==c)),AxiosError.call(C,c.message,p,v,x,E),C.cause=c,C.name=c.name,F&&Object.assign(C,F),C};const lt=AxiosError;function isVisitable(c){return ct.isPlainObject(c)||ct.isArray(c)}function removeBrackets(c){return ct.endsWith(c,"[]")?c.slice(0,-2):c}function renderKey(c,p,v){return c?c.concat(p).map((function each(c,p){return c=removeBrackets(c),!v&&p?"["+c+"]":c})).join(v?".":""):p}const ft=ct.toFlatObject(ct,{},null,(function filter(c){return/^is[A-Z]/.test(c)}));const dt=function toFormData(c,p,v){if(!ct.isObject(c))throw new TypeError("target must be an object");p=p||new FormData;const x=(v=ct.toFlatObject(v,{metaTokens:!0,dots:!1,indexes:!1},!1,(function defined(c,p){return!ct.isUndefined(p[c])}))).metaTokens,E=v.visitor||defaultVisitor,F=v.dots,C=v.indexes,P=(v.Blob||"undefined"!==typeof Blob&&Blob)&&ct.isSpecCompliantForm(p);if(!ct.isFunction(E))throw new TypeError("visitor must be a function");function convertValue(c){if(null===c)return"";if(ct.isDate(c))return c.toISOString();if(!P&&ct.isBlob(c))throw new lt("Blob is not supported. Use a Buffer instead.");return ct.isArrayBuffer(c)||ct.isTypedArray(c)?P&&"function"===typeof Blob?new Blob([c]):Buffer.from(c):c}function defaultVisitor(c,v,E){let P=c;if(c&&!E&&"object"===typeof c)if(ct.endsWith(v,"{}"))v=x?v:v.slice(0,-2),c=JSON.stringify(c);else if(ct.isArray(c)&&function isFlatArray(c){return ct.isArray(c)&&!c.some(isVisitable)}(c)||(ct.isFileList(c)||ct.endsWith(v,"[]"))&&(P=ct.toArray(c)))return v=removeBrackets(v),P.forEach((function each(c,x){!ct.isUndefined(c)&&null!==c&&p.append(!0===C?renderKey([v],x,F):null===C?v:v+"[]",convertValue(c))})),!1;return!!isVisitable(c)||(p.append(renderKey(E,v,F),convertValue(c)),!1)}const R=[],B=Object.assign(ft,{defaultVisitor:defaultVisitor,convertValue:convertValue,isVisitable:isVisitable});if(!ct.isObject(c))throw new TypeError("data must be an object");return function build(c,v){if(!ct.isUndefined(c)){if(-1!==R.indexOf(c))throw Error("Circular reference detected in "+v.join("."));R.push(c),ct.forEach(c,(function each(c,x){!0===(!(ct.isUndefined(c)||null===c)&&E.call(p,c,ct.isString(x)?x.trim():x,v,B))&&build(c,v?v.concat(x):[x])})),R.pop()}}(c),p};function encode(c){const p={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(c).replace(/[!'()~]|%20|%00/g,(function replacer(c){return p[c]}))}function AxiosURLSearchParams(c,p){this._pairs=[],c&&dt(c,this,p)}const pt=AxiosURLSearchParams.prototype;pt.append=function append(c,p){this._pairs.push([c,p])},pt.toString=function toString(c){const p=c?function(p){return c.call(this,p,encode)}:encode;return this._pairs.map((function each(c){return p(c[0])+"="+p(c[1])}),"").join("&")};const gt=AxiosURLSearchParams;function buildURL_encode(c){return encodeURIComponent(c).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(c,p,v){if(!p)return c;const x=v&&v.encode||buildURL_encode,E=v&&v.serialize;let F;if(F=E?E(p,v):ct.isURLSearchParams(p)?p.toString():new gt(p,v).toString(x),F){const p=c.indexOf("#");-1!==p&&(c=c.slice(0,p)),c+=(-1===c.indexOf("?")?"?":"&")+F}return c}const mt=class InterceptorManager{constructor(){this.handlers=[]}use(c,p,v){return this.handlers.push({fulfilled:c,rejected:p,synchronous:!!v&&v.synchronous,runWhen:v?v.runWhen:null}),this.handlers.length-1}eject(c){this.handlers[c]&&(this.handlers[c]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(c){ct.forEach(this.handlers,(function forEachHandler(p){null!==p&&c(p)}))}},vt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yt={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:gt,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},xt="undefined"!==typeof window&&"undefined"!==typeof document,St=(bt="undefined"!==typeof navigator&&navigator.product,xt&&["ReactNative","NativeScript","NS"].indexOf(bt)<0);var bt;const wt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Et={...x,...yt};const Ft=function formDataToJSON(c){function buildPath(c,p,v,x){let E=c[x++];if("__proto__"===E)return!0;const F=Number.isFinite(+E),C=x>=c.length;if(E=!E&&ct.isArray(v)?v.length:E,C)return ct.hasOwnProp(v,E)?v[E]=[v[E],p]:v[E]=p,!F;v[E]&&ct.isObject(v[E])||(v[E]=[]);return buildPath(c,p,v[E],x)&&ct.isArray(v[E])&&(v[E]=function arrayToObject(c){const p={},v=Object.keys(c);let x;const E=v.length;let F;for(x=0;x<E;x++)F=v[x],p[F]=c[F];return p}(v[E])),!F}if(ct.isFormData(c)&&ct.isFunction(c.entries)){const p={};return ct.forEachEntry(c,((c,v)=>{buildPath(function parsePropPath(c){return ct.matchAll(/\w+|\[(\w*)]/g,c).map((c=>"[]"===c[0]?"":c[1]||c[0]))}(c),v,p,0)})),p}return null};const At={transitional:vt,adapter:["xhr","http"],transformRequest:[function transformRequest(c,p){const v=p.getContentType()||"",x=v.indexOf("application/json")>-1,E=ct.isObject(c);E&&ct.isHTMLForm(c)&&(c=new FormData(c));if(ct.isFormData(c))return x?JSON.stringify(Ft(c)):c;if(ct.isArrayBuffer(c)||ct.isBuffer(c)||ct.isStream(c)||ct.isFile(c)||ct.isBlob(c))return c;if(ct.isArrayBufferView(c))return c.buffer;if(ct.isURLSearchParams(c))return p.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),c.toString();let F;if(E){if(v.indexOf("application/x-www-form-urlencoded")>-1)return function toURLEncodedForm(c,p){return dt(c,new Et.classes.URLSearchParams,Object.assign({visitor:function(c,p,v,x){return Et.isNode&&ct.isBuffer(c)?(this.append(p,c.toString("base64")),!1):x.defaultVisitor.apply(this,arguments)}},p))}(c,this.formSerializer).toString();if((F=ct.isFileList(c))||v.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return dt(F?{"files[]":c}:c,p&&new p,this.formSerializer)}}return E||x?(p.setContentType("application/json",!1),function stringifySafely(c,p,v){if(ct.isString(c))try{return(p||JSON.parse)(c),ct.trim(c)}catch(x){if("SyntaxError"!==x.name)throw x}return(v||JSON.stringify)(c)}(c)):c}],transformResponse:[function transformResponse(c){const p=this.transitional||At.transitional,v=p&&p.forcedJSONParsing,x="json"===this.responseType;if(c&&ct.isString(c)&&(v&&!this.responseType||x)){const v=!(p&&p.silentJSONParsing)&&x;try{return JSON.parse(c)}catch(E){if(v){if("SyntaxError"===E.name)throw lt.from(E,lt.ERR_BAD_RESPONSE,this,null,this.response);throw E}}}return c}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Et.classes.FormData,Blob:Et.classes.Blob},validateStatus:function validateStatus(c){return c>=200&&c<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ct.forEach(["delete","get","head","post","put","patch"],(c=>{At.headers[c]={}}));const Ct=At,It=ct.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pt=Symbol("internals");function normalizeHeader(c){return c&&String(c).trim().toLowerCase()}function normalizeValue(c){return!1===c||null==c?c:ct.isArray(c)?c.map(normalizeValue):String(c)}function matchHeaderValue(c,p,v,x,E){return ct.isFunction(x)?x.call(this,p,v):(E&&(p=v),ct.isString(p)?ct.isString(x)?-1!==p.indexOf(x):ct.isRegExp(x)?x.test(p):void 0:void 0)}class AxiosHeaders{constructor(c){c&&this.set(c)}set(c,p,v){const x=this;function setHeader(c,p,v){const E=normalizeHeader(p);if(!E)throw new Error("header name must be a non-empty string");const F=ct.findKey(x,E);(!F||void 0===x[F]||!0===v||void 0===v&&!1!==x[F])&&(x[F||p]=normalizeValue(c))}const setHeaders=(c,p)=>ct.forEach(c,((c,v)=>setHeader(c,v,p)));return ct.isPlainObject(c)||c instanceof this.constructor?setHeaders(c,p):ct.isString(c)&&(c=c.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(c.trim())?setHeaders((c=>{const p={};let v,x,E;return c&&c.split("\n").forEach((function parser(c){E=c.indexOf(":"),v=c.substring(0,E).trim().toLowerCase(),x=c.substring(E+1).trim(),!v||p[v]&&It[v]||("set-cookie"===v?p[v]?p[v].push(x):p[v]=[x]:p[v]=p[v]?p[v]+", "+x:x)})),p})(c),p):null!=c&&setHeader(p,c,v),this}get(c,p){if(c=normalizeHeader(c)){const v=ct.findKey(this,c);if(v){const c=this[v];if(!p)return c;if(!0===p)return function parseTokens(c){const p=Object.create(null),v=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let x;for(;x=v.exec(c);)p[x[1]]=x[2];return p}(c);if(ct.isFunction(p))return p.call(this,c,v);if(ct.isRegExp(p))return p.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(c,p){if(c=normalizeHeader(c)){const v=ct.findKey(this,c);return!(!v||void 0===this[v]||p&&!matchHeaderValue(0,this[v],v,p))}return!1}delete(c,p){const v=this;let x=!1;function deleteHeader(c){if(c=normalizeHeader(c)){const E=ct.findKey(v,c);!E||p&&!matchHeaderValue(0,v[E],E,p)||(delete v[E],x=!0)}}return ct.isArray(c)?c.forEach(deleteHeader):deleteHeader(c),x}clear(c){const p=Object.keys(this);let v=p.length,x=!1;for(;v--;){const E=p[v];c&&!matchHeaderValue(0,this[E],E,c,!0)||(delete this[E],x=!0)}return x}normalize(c){const p=this,v={};return ct.forEach(this,((x,E)=>{const F=ct.findKey(v,E);if(F)return p[F]=normalizeValue(x),void delete p[E];const C=c?function formatHeader(c){return c.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((c,p,v)=>p.toUpperCase()+v))}(E):String(E).trim();C!==E&&delete p[E],p[C]=normalizeValue(x),v[C]=!0})),this}concat(...c){return this.constructor.concat(this,...c)}toJSON(c){const p=Object.create(null);return ct.forEach(this,((v,x)=>{null!=v&&!1!==v&&(p[x]=c&&ct.isArray(v)?v.join(", "):v)})),p}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([c,p])=>c+": "+p)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(c){return c instanceof this?c:new this(c)}static concat(c,...p){const v=new this(c);return p.forEach((c=>v.set(c))),v}static accessor(c){const p=(this[Pt]=this[Pt]={accessors:{}}).accessors,v=this.prototype;function defineAccessor(c){const x=normalizeHeader(c);p[x]||(!function buildAccessors(c,p){const v=ct.toCamelCase(" "+p);["get","set","has"].forEach((x=>{Object.defineProperty(c,x+v,{value:function(c,v,E){return this[x].call(this,p,c,v,E)},configurable:!0})}))}(v,c),p[x]=!0)}return ct.isArray(c)?c.forEach(defineAccessor):defineAccessor(c),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ct.reduceDescriptors(AxiosHeaders.prototype,(({value:c},p)=>{let v=p[0].toUpperCase()+p.slice(1);return{get:()=>c,set(c){this[v]=c}}})),ct.freezeMethods(AxiosHeaders);const Rt=AxiosHeaders;function transformData(c,p){const v=this||Ct,x=p||v,E=Rt.from(x.headers);let F=x.data;return ct.forEach(c,(function transform(c){F=c.call(v,F,E.normalize(),p?p.status:void 0)})),E.normalize(),F}function isCancel(c){return!(!c||!c.__CANCEL__)}function CanceledError(c,p,v){lt.call(this,null==c?"canceled":c,lt.ERR_CANCELED,p,v),this.name="CanceledError"}ct.inherits(CanceledError,lt,{__CANCEL__:!0});const Dt=CanceledError;const Bt=Et.hasStandardBrowserEnv?{write(c,p,v,x,E,F){const C=[c+"="+encodeURIComponent(p)];ct.isNumber(v)&&C.push("expires="+new Date(v).toGMTString()),ct.isString(x)&&C.push("path="+x),ct.isString(E)&&C.push("domain="+E),!0===F&&C.push("secure"),document.cookie=C.join("; ")},read(c){const p=document.cookie.match(new RegExp("(^|;\\s*)("+c+")=([^;]*)"));return p?decodeURIComponent(p[3]):null},remove(c){this.write(c,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function buildFullPath(c,p){return c&&!function isAbsoluteURL(c){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(c)}(p)?function combineURLs(c,p){return p?c.replace(/\/?\/$/,"")+"/"+p.replace(/^\/+/,""):c}(c,p):p}const Tt=Et.hasStandardBrowserEnv?function standardBrowserEnv(){const c=/(msie|trident)/i.test(navigator.userAgent),p=document.createElement("a");let v;function resolveURL(v){let x=v;return c&&(p.setAttribute("href",x),x=p.href),p.setAttribute("href",x),{href:p.href,protocol:p.protocol?p.protocol.replace(/:$/,""):"",host:p.host,search:p.search?p.search.replace(/^\?/,""):"",hash:p.hash?p.hash.replace(/^#/,""):"",hostname:p.hostname,port:p.port,pathname:"/"===p.pathname.charAt(0)?p.pathname:"/"+p.pathname}}return v=resolveURL(window.location.href),function isURLSameOrigin(c){const p=ct.isString(c)?resolveURL(c):c;return p.protocol===v.protocol&&p.host===v.host}}():function isURLSameOrigin(){return!0};const Nt=function speedometer(c,p){c=c||10;const v=new Array(c),x=new Array(c);let E,F=0,C=0;return p=void 0!==p?p:1e3,function push(P){const R=Date.now(),B=x[C];E||(E=R),v[F]=P,x[F]=R;let T=C,N=0;for(;T!==F;)N+=v[T++],T%=c;if(F=(F+1)%c,F===C&&(C=(C+1)%c),R-E<p)return;const _=B&&R-B;return _?Math.round(1e3*N/_):void 0}};function progressEventReducer(c,p){let v=0;const x=Nt(50,250);return E=>{const F=E.loaded,C=E.lengthComputable?E.total:void 0,P=F-v,R=x(P);v=F;const B={loaded:F,total:C,progress:C?F/C:void 0,bytes:P,rate:R||void 0,estimated:R&&C&&F<=C?(C-F)/R:void 0,event:E};B[p?"download":"upload"]=!0,c(B)}}const Ot={http:null,xhr:"undefined"!==typeof XMLHttpRequest&&function(c){return new Promise((function dispatchXhrRequest(p,v){let x=c.data;const E=Rt.from(c.headers).normalize();let F,C,{responseType:P,withXSRFToken:R}=c;function done(){c.cancelToken&&c.cancelToken.unsubscribe(F),c.signal&&c.signal.removeEventListener("abort",F)}if(ct.isFormData(x))if(Et.hasStandardBrowserEnv||Et.hasStandardBrowserWebWorkerEnv)E.setContentType(!1);else if(!1!==(C=E.getContentType())){const[c,...p]=C?C.split(";").map((c=>c.trim())).filter(Boolean):[];E.setContentType([c||"multipart/form-data",...p].join("; "))}let B=new XMLHttpRequest;if(c.auth){const p=c.auth.username||"",v=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";E.set("Authorization","Basic "+btoa(p+":"+v))}const T=buildFullPath(c.baseURL,c.url);function onloadend(){if(!B)return;const x=Rt.from("getAllResponseHeaders"in B&&B.getAllResponseHeaders());!function settle(c,p,v){const x=v.config.validateStatus;v.status&&x&&!x(v.status)?p(new lt("Request failed with status code "+v.status,[lt.ERR_BAD_REQUEST,lt.ERR_BAD_RESPONSE][Math.floor(v.status/100)-4],v.config,v.request,v)):c(v)}((function _resolve(c){p(c),done()}),(function _reject(c){v(c),done()}),{data:P&&"text"!==P&&"json"!==P?B.response:B.responseText,status:B.status,statusText:B.statusText,headers:x,config:c,request:B}),B=null}if(B.open(c.method.toUpperCase(),buildURL(T,c.params,c.paramsSerializer),!0),B.timeout=c.timeout,"onloadend"in B?B.onloadend=onloadend:B.onreadystatechange=function handleLoad(){B&&4===B.readyState&&(0!==B.status||B.responseURL&&0===B.responseURL.indexOf("file:"))&&setTimeout(onloadend)},B.onabort=function handleAbort(){B&&(v(new lt("Request aborted",lt.ECONNABORTED,c,B)),B=null)},B.onerror=function handleError(){v(new lt("Network Error",lt.ERR_NETWORK,c,B)),B=null},B.ontimeout=function handleTimeout(){let p=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const x=c.transitional||vt;c.timeoutErrorMessage&&(p=c.timeoutErrorMessage),v(new lt(p,x.clarifyTimeoutError?lt.ETIMEDOUT:lt.ECONNABORTED,c,B)),B=null},Et.hasStandardBrowserEnv&&(R&&ct.isFunction(R)&&(R=R(c)),R||!1!==R&&Tt(T))){const p=c.xsrfHeaderName&&c.xsrfCookieName&&Bt.read(c.xsrfCookieName);p&&E.set(c.xsrfHeaderName,p)}void 0===x&&E.setContentType(null),"setRequestHeader"in B&&ct.forEach(E.toJSON(),(function setRequestHeader(c,p){B.setRequestHeader(p,c)})),ct.isUndefined(c.withCredentials)||(B.withCredentials=!!c.withCredentials),P&&"json"!==P&&(B.responseType=c.responseType),"function"===typeof c.onDownloadProgress&&B.addEventListener("progress",progressEventReducer(c.onDownloadProgress,!0)),"function"===typeof c.onUploadProgress&&B.upload&&B.upload.addEventListener("progress",progressEventReducer(c.onUploadProgress)),(c.cancelToken||c.signal)&&(F=p=>{B&&(v(!p||p.type?new Dt(null,c,B):p),B.abort(),B=null)},c.cancelToken&&c.cancelToken.subscribe(F),c.signal&&(c.signal.aborted?F():c.signal.addEventListener("abort",F)));const N=function parseProtocol(c){const p=/^([-+\w]{1,25})(:?\/\/|:)/.exec(c);return p&&p[1]||""}(T);N&&-1===Et.protocols.indexOf(N)?v(new lt("Unsupported protocol "+N+":",lt.ERR_BAD_REQUEST,c)):B.send(x||null)}))}};ct.forEach(Ot,((c,p)=>{if(c){try{Object.defineProperty(c,"name",{value:p})}catch(v){}Object.defineProperty(c,"adapterName",{value:p})}}));const renderReason=c=>`- ${c}`,isResolvedHandle=c=>ct.isFunction(c)||null===c||!1===c,adapters_getAdapter=c=>{c=ct.isArray(c)?c:[c];const{length:p}=c;let v,x;const E={};for(let F=0;F<p;F++){let p;if(v=c[F],x=v,!isResolvedHandle(v)&&(x=Ot[(p=String(v)).toLowerCase()],void 0===x))throw new lt(`Unknown adapter '${p}'`);if(x)break;E[p||"#"+F]=x}if(!x){const c=Object.entries(E).map((([c,p])=>`adapter ${c} `+(!1===p?"is not supported by the environment":"is not available in the build")));let v=p?c.length>1?"since :\n"+c.map(renderReason).join("\n"):" "+renderReason(c[0]):"as no adapter specified";throw new lt("There is no suitable adapter to dispatch the request "+v,"ERR_NOT_SUPPORT")}return x};function throwIfCancellationRequested(c){if(c.cancelToken&&c.cancelToken.throwIfRequested(),c.signal&&c.signal.aborted)throw new Dt(null,c)}function dispatchRequest(c){throwIfCancellationRequested(c),c.headers=Rt.from(c.headers),c.data=transformData.call(c,c.transformRequest),-1!==["post","put","patch"].indexOf(c.method)&&c.headers.setContentType("application/x-www-form-urlencoded",!1);return adapters_getAdapter(c.adapter||Ct.adapter)(c).then((function onAdapterResolution(p){return throwIfCancellationRequested(c),p.data=transformData.call(c,c.transformResponse,p),p.headers=Rt.from(p.headers),p}),(function onAdapterRejection(p){return isCancel(p)||(throwIfCancellationRequested(c),p&&p.response&&(p.response.data=transformData.call(c,c.transformResponse,p.response),p.response.headers=Rt.from(p.response.headers))),Promise.reject(p)}))}const headersToObject=c=>c instanceof Rt?{...c}:c;function mergeConfig(c,p){p=p||{};const v={};function getMergedValue(c,p,v){return ct.isPlainObject(c)&&ct.isPlainObject(p)?ct.merge.call({caseless:v},c,p):ct.isPlainObject(p)?ct.merge({},p):ct.isArray(p)?p.slice():p}function mergeDeepProperties(c,p,v){return ct.isUndefined(p)?ct.isUndefined(c)?void 0:getMergedValue(void 0,c,v):getMergedValue(c,p,v)}function valueFromConfig2(c,p){if(!ct.isUndefined(p))return getMergedValue(void 0,p)}function defaultToConfig2(c,p){return ct.isUndefined(p)?ct.isUndefined(c)?void 0:getMergedValue(void 0,c):getMergedValue(void 0,p)}function mergeDirectKeys(v,x,E){return E in p?getMergedValue(v,x):E in c?getMergedValue(void 0,v):void 0}const x={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,withXSRFToken:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,beforeRedirect:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys,headers:(c,p)=>mergeDeepProperties(headersToObject(c),headersToObject(p),!0)};return ct.forEach(Object.keys(Object.assign({},c,p)),(function computeConfigValue(E){const F=x[E]||mergeDeepProperties,C=F(c[E],p[E],E);ct.isUndefined(C)&&F!==mergeDirectKeys||(v[E]=C)})),v}const Ht="1.6.8",jt={};["object","boolean","number","function","string","symbol"].forEach(((c,p)=>{jt[c]=function validator(v){return typeof v===c||"a"+(p<1?"n ":" ")+c}}));const _t={};jt.transitional=function transitional(c,p,v){function formatMessage(c,p){return"[Axios v1.6.8] Transitional option '"+c+"'"+p+(v?". "+v:"")}return(v,x,E)=>{if(!1===c)throw new lt(formatMessage(x," has been removed"+(p?" in "+p:"")),lt.ERR_DEPRECATED);return p&&!_t[x]&&(_t[x]=!0,console.warn(formatMessage(x," has been deprecated since v"+p+" and will be removed in the near future"))),!c||c(v,x,E)}};const kt={assertOptions:function assertOptions(c,p,v){if("object"!==typeof c)throw new lt("options must be an object",lt.ERR_BAD_OPTION_VALUE);const x=Object.keys(c);let E=x.length;for(;E-- >0;){const F=x[E],C=p[F];if(C){const p=c[F],v=void 0===p||C(p,F,c);if(!0!==v)throw new lt("option "+F+" must be "+v,lt.ERR_BAD_OPTION_VALUE)}else if(!0!==v)throw new lt("Unknown option "+F,lt.ERR_BAD_OPTION)}},validators:jt},Lt=kt.validators;class Axios{constructor(c){this.defaults=c,this.interceptors={request:new mt,response:new mt}}async request(c,p){try{return await this._request(c,p)}catch(v){if(v instanceof Error){let c;Error.captureStackTrace?Error.captureStackTrace(c={}):c=new Error;const p=c.stack?c.stack.replace(/^.+\n/,""):"";v.stack?p&&!String(v.stack).endsWith(p.replace(/^.+\n.+\n/,""))&&(v.stack+="\n"+p):v.stack=p}throw v}}_request(c,p){"string"===typeof c?(p=p||{}).url=c:p=c||{},p=mergeConfig(this.defaults,p);const{transitional:v,paramsSerializer:x,headers:E}=p;void 0!==v&&kt.assertOptions(v,{silentJSONParsing:Lt.transitional(Lt.boolean),forcedJSONParsing:Lt.transitional(Lt.boolean),clarifyTimeoutError:Lt.transitional(Lt.boolean)},!1),null!=x&&(ct.isFunction(x)?p.paramsSerializer={serialize:x}:kt.assertOptions(x,{encode:Lt.function,serialize:Lt.function},!0)),p.method=(p.method||this.defaults.method||"get").toLowerCase();let F=E&&ct.merge(E.common,E[p.method]);E&&ct.forEach(["delete","get","head","post","put","patch","common"],(c=>{delete E[c]})),p.headers=Rt.concat(F,E);const C=[];let P=!0;this.interceptors.request.forEach((function unshiftRequestInterceptors(c){"function"===typeof c.runWhen&&!1===c.runWhen(p)||(P=P&&c.synchronous,C.unshift(c.fulfilled,c.rejected))}));const R=[];let B;this.interceptors.response.forEach((function pushResponseInterceptors(c){R.push(c.fulfilled,c.rejected)}));let T,N=0;if(!P){const c=[dispatchRequest.bind(this),void 0];for(c.unshift.apply(c,C),c.push.apply(c,R),T=c.length,B=Promise.resolve(p);N<T;)B=B.then(c[N++],c[N++]);return B}T=C.length;let _=p;for(N=0;N<T;){const c=C[N++],p=C[N++];try{_=c(_)}catch(L){p.call(this,L);break}}try{B=dispatchRequest.call(this,_)}catch(L){return Promise.reject(L)}for(N=0,T=R.length;N<T;)B=B.then(R[N++],R[N++]);return B}getUri(c){return buildURL(buildFullPath((c=mergeConfig(this.defaults,c)).baseURL,c.url),c.params,c.paramsSerializer)}}ct.forEach(["delete","get","head","options"],(function forEachMethodNoData(c){Axios.prototype[c]=function(p,v){return this.request(mergeConfig(v||{},{method:c,url:p,data:(v||{}).data}))}})),ct.forEach(["post","put","patch"],(function forEachMethodWithData(c){function generateHTTPMethod(p){return function httpMethod(v,x,E){return this.request(mergeConfig(E||{},{method:c,headers:p?{"Content-Type":"multipart/form-data"}:{},url:v,data:x}))}}Axios.prototype[c]=generateHTTPMethod(),Axios.prototype[c+"Form"]=generateHTTPMethod(!0)}));const Vt=Axios;class CancelToken{constructor(c){if("function"!==typeof c)throw new TypeError("executor must be a function.");let p;this.promise=new Promise((function promiseExecutor(c){p=c}));const v=this;this.promise.then((c=>{if(!v._listeners)return;let p=v._listeners.length;for(;p-- >0;)v._listeners[p](c);v._listeners=null})),this.promise.then=c=>{let p;const x=new Promise((c=>{v.subscribe(c),p=c})).then(c);return x.cancel=function reject(){v.unsubscribe(p)},x},c((function cancel(c,x,E){v.reason||(v.reason=new Dt(c,x,E),p(v.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(c){this.reason?c(this.reason):this._listeners?this._listeners.push(c):this._listeners=[c]}unsubscribe(c){if(!this._listeners)return;const p=this._listeners.indexOf(c);-1!==p&&this._listeners.splice(p,1)}static source(){let c;return{token:new CancelToken((function executor(p){c=p})),cancel:c}}}const Mt=CancelToken;const Kt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Kt).forEach((([c,p])=>{Kt[p]=c}));const qt=Kt;const Ut=function createInstance(c){const p=new Vt(c),v=bind(Vt.prototype.request,p);return ct.extend(v,Vt.prototype,p,{allOwnKeys:!0}),ct.extend(v,p,null,{allOwnKeys:!0}),v.create=function create(p){return createInstance(mergeConfig(c,p))},v}(Ct);Ut.Axios=Vt,Ut.CanceledError=Dt,Ut.CancelToken=Mt,Ut.isCancel=isCancel,Ut.VERSION=Ht,Ut.toFormData=dt,Ut.AxiosError=lt,Ut.Cancel=Ut.CanceledError,Ut.all=function all(c){return Promise.all(c)},Ut.spread=function spread(c){return function wrap(p){return c.apply(null,p)}},Ut.isAxiosError=function isAxiosError(c){return ct.isObject(c)&&!0===c.isAxiosError},Ut.mergeConfig=mergeConfig,Ut.AxiosHeaders=Rt,Ut.formToJSON=c=>Ft(ct.isHTMLForm(c)?new FormData(c):c),Ut.getAdapter=adapters_getAdapter,Ut.HttpStatusCode=qt,Ut.default=Ut;const Wt=Ut;const zt=Array.isArray;const Gt="object"==typeof global&&global&&global.Object===Object&&global;var Xt="object"==typeof self&&self&&self.Object===Object&&self;const $t=Gt||Xt||Function("return this")();const Jt=$t.Symbol;var Zt=Object.prototype,Yt=Zt.hasOwnProperty,Qt=Zt.toString,te=Jt?Jt.toStringTag:void 0;const ee=function getRawTag(c){var p=Yt.call(c,te),v=c[te];try{c[te]=void 0;var x=!0}catch(F){}var E=Qt.call(c);return x&&(p?c[te]=v:delete c[te]),E};var re=Object.prototype.toString;const ne=function objectToString(c){return re.call(c)};var ie=Jt?Jt.toStringTag:void 0;const se=function baseGetTag(c){return null==c?void 0===c?"[object Undefined]":"[object Null]":ie&&ie in Object(c)?ee(c):ne(c)};const ae=function isObjectLike(c){return null!=c&&"object"==typeof c};const oe=function isSymbol(c){return"symbol"==typeof c||ae(c)&&"[object Symbol]"==se(c)};var ce=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,he=/^\w*$/;const ue=function isKey(c,p){if(zt(c))return!1;var v=typeof c;return!("number"!=v&&"symbol"!=v&&"boolean"!=v&&null!=c&&!oe(c))||(he.test(c)||!ce.test(c)||null!=p&&c in Object(p))};const le=function isObject_isObject(c){var p=typeof c;return null!=c&&("object"==p||"function"==p)};const fe=function isFunction_isFunction(c){if(!le(c))return!1;var p=se(c);return"[object Function]"==p||"[object GeneratorFunction]"==p||"[object AsyncFunction]"==p||"[object Proxy]"==p};const de=$t["__core-js_shared__"];var pe=function(){var c=/[^.]+$/.exec(de&&de.keys&&de.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}();const ge=function isMasked(c){return!!pe&&pe in c};var me=Function.prototype.toString;const ve=function toSource(c){if(null!=c){try{return me.call(c)}catch(p){}try{return c+""}catch(p){}}return""};var ye=/^\[object .+?Constructor\]$/,xe=Function.prototype,Se=Object.prototype,be=xe.toString,we=Se.hasOwnProperty,Ee=RegExp("^"+be.call(we).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Fe=function baseIsNative(c){return!(!le(c)||ge(c))&&(fe(c)?Ee:ye).test(ve(c))};const Ae=function getValue(c,p){return null==c?void 0:c[p]};const Ce=function getNative(c,p){var v=Ae(c,p);return Fe(v)?v:void 0};const Ie=Ce(Object,"create");const Pe=function hashClear(){this.__data__=Ie?Ie(null):{},this.size=0};const Re=function hashDelete(c){var p=this.has(c)&&delete this.__data__[c];return this.size-=p?1:0,p};var De=Object.prototype.hasOwnProperty;const Be=function hashGet(c){var p=this.__data__;if(Ie){var v=p[c];return"__lodash_hash_undefined__"===v?void 0:v}return De.call(p,c)?p[c]:void 0};var Te=Object.prototype.hasOwnProperty;const Ne=function hashHas(c){var p=this.__data__;return Ie?void 0!==p[c]:Te.call(p,c)};const Oe=function hashSet(c,p){var v=this.__data__;return this.size+=this.has(c)?0:1,v[c]=Ie&&void 0===p?"__lodash_hash_undefined__":p,this};function Hash(c){var p=-1,v=null==c?0:c.length;for(this.clear();++p<v;){var x=c[p];this.set(x[0],x[1])}}Hash.prototype.clear=Pe,Hash.prototype.delete=Re,Hash.prototype.get=Be,Hash.prototype.has=Ne,Hash.prototype.set=Oe;const He=Hash;const je=function listCacheClear(){this.__data__=[],this.size=0};const _e=function eq(c,p){return c===p||c!==c&&p!==p};const ke=function assocIndexOf(c,p){for(var v=c.length;v--;)if(_e(c[v][0],p))return v;return-1};var Le=Array.prototype.splice;const Ve=function listCacheDelete(c){var p=this.__data__,v=ke(p,c);return!(v<0)&&(v==p.length-1?p.pop():Le.call(p,v,1),--this.size,!0)};const Me=function listCacheGet(c){var p=this.__data__,v=ke(p,c);return v<0?void 0:p[v][1]};const Ke=function listCacheHas(c){return ke(this.__data__,c)>-1};const qe=function listCacheSet(c,p){var v=this.__data__,x=ke(v,c);return x<0?(++this.size,v.push([c,p])):v[x][1]=p,this};function ListCache(c){var p=-1,v=null==c?0:c.length;for(this.clear();++p<v;){var x=c[p];this.set(x[0],x[1])}}ListCache.prototype.clear=je,ListCache.prototype.delete=Ve,ListCache.prototype.get=Me,ListCache.prototype.has=Ke,ListCache.prototype.set=qe;const Ue=ListCache;const We=Ce($t,"Map");const ze=function mapCacheClear(){this.size=0,this.__data__={hash:new He,map:new(We||Ue),string:new He}};const Ge=function isKeyable(c){var p=typeof c;return"string"==p||"number"==p||"symbol"==p||"boolean"==p?"__proto__"!==c:null===c};const Xe=function getMapData(c,p){var v=c.__data__;return Ge(p)?v["string"==typeof p?"string":"hash"]:v.map};const $e=function mapCacheDelete(c){var p=Xe(this,c).delete(c);return this.size-=p?1:0,p};const Je=function mapCacheGet(c){return Xe(this,c).get(c)};const Ze=function mapCacheHas(c){return Xe(this,c).has(c)};const Ye=function mapCacheSet(c,p){var v=Xe(this,c),x=v.size;return v.set(c,p),this.size+=v.size==x?0:1,this};function MapCache(c){var p=-1,v=null==c?0:c.length;for(this.clear();++p<v;){var x=c[p];this.set(x[0],x[1])}}MapCache.prototype.clear=ze,MapCache.prototype.delete=$e,MapCache.prototype.get=Je,MapCache.prototype.has=Ze,MapCache.prototype.set=Ye;const Qe=MapCache;function memoize(c,p){if("function"!=typeof c||null!=p&&"function"!=typeof p)throw new TypeError("Expected a function");var memoized=function(){var v=arguments,x=p?p.apply(this,v):v[0],E=memoized.cache;if(E.has(x))return E.get(x);var F=c.apply(this,v);return memoized.cache=E.set(x,F)||E,F};return memoized.cache=new(memoize.Cache||Qe),memoized}memoize.Cache=Qe;const tr=memoize;const er=function memoizeCapped(c){var p=tr(c,(function(c){return 500===v.size&&v.clear(),c})),v=p.cache;return p};var rr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nr=/\\(\\)?/g;const ir=er((function(c){var p=[];return 46===c.charCodeAt(0)&&p.push(""),c.replace(rr,(function(c,v,x,E){p.push(x?E.replace(nr,"$1"):v||c)})),p}));const sr=function arrayMap(c,p){for(var v=-1,x=null==c?0:c.length,E=Array(x);++v<x;)E[v]=p(c[v],v,c);return E};var ar=Jt?Jt.prototype:void 0,or=ar?ar.toString:void 0;const cr=function baseToString(c){if("string"==typeof c)return c;if(zt(c))return sr(c,baseToString)+"";if(oe(c))return or?or.call(c):"";var p=c+"";return"0"==p&&1/c==-1/0?"-0":p};const hr=function toString_toString(c){return null==c?"":cr(c)};const ur=function castPath(c,p){return zt(c)?c:ue(c,p)?[c]:ir(hr(c))};const lr=function toKey(c){if("string"==typeof c||oe(c))return c;var p=c+"";return"0"==p&&1/c==-1/0?"-0":p};const fr=function baseGet(c,p){for(var v=0,x=(p=ur(p,c)).length;null!=c&&v<x;)c=c[lr(p[v++])];return v&&v==x?c:void 0};const dr=function get(c,p,v){var x=null==c?void 0:fr(c,p);return void 0===x?v:x};const pr=function genAxiosInstance(){const c=Wt.create();return c.interceptors.request.use((c=>(c.headers.set("fp",localStorage.getItem("fp")||""),c.headers.set("pt",sessionStorage.getItem("pt")||"1"),c.headers.set("ct",localStorage.getItem("ct")||"1"),sessionStorage.getItem("ACCESS_TOKEN")&&c.headers.set("Authorization",`Bearer ${sessionStorage.getItem("ACCESS_TOKEN")}`),c))),c.interceptors.response.use((c=>{const p=c.config;if(c&&c.headers&&c.headers.access_token){const p=c.headers.access_token,v=JSON.parse(decodeURIComponent(p));sessionStorage.setItem("ACCESS_TOKEN",v.access_token),sessionStorage.setItem("USER_INFO",JSON.stringify(v.user_info)),sessionStorage.setItem("USER_NAME",v.user_info.name),sessionStorage.setItem("EXPIRES_IN",v.expires_in),sessionStorage.setItem("REFRESH_TOKEN",v.refresh_token),sessionStorage.setItem("sessionId",v.refresh_token),localStorage.setItem("storeSessionData",JSON.stringify({userInfo:v.user_info,token:v.access_token}))}return 401===dr(c,"data.code")&&(sessionStorage.clear(),window.location.reload()),dr(c,void 0!==p.dataPath?p.dataPath:"data.data",p.placeholderData)})),c}();var gr=v(353),mr=v.n(gr);function saveToken(c){if(!c)return window.sessionStorage.clear(),window.localStorage.clear(),void(window.location.href=window.location.origin+window.location.pathname);sessionStorage.setItem(Br.access_token,c.access_token),sessionStorage.setItem(Br.refresh_token,c.refresh_token),sessionStorage.setItem(Br.expires_in,String(c.expires_in));const p=mr()().add(c.expires_in,"s").unix();sessionStorage.setItem(Br.token_expires_time,p),sessionStorage.setItem(Br.user_info,JSON.stringify(c.user_info)),sessionStorage.setItem(Br.user_name,c.user_info.name),localStorage.setItem("storeSessionData",JSON.stringify({userInfo:c.user_info,token:c.access_token})),sessionStorage.setItem("pt",c.pt||"")}const vr="function"===typeof Buffer,yr=("function"===typeof TextDecoder&&new TextDecoder,"function"===typeof TextEncoder?new TextEncoder:void 0),xr=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Sr=(c=>{let p={};return c.forEach(((c,v)=>p[c]=v)),p})(xr),br=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,wr=String.fromCharCode.bind(String),Er=("function"===typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),c=>c.replace(/=/g,"").replace(/[+\/]/g,(c=>"+"==c?"-":"_"))),_tidyB64=c=>c.replace(/[^A-Za-z0-9\+\/]/g,""),btoaPolyfill=c=>{let p,v,x,E,F="";const C=c.length%3;for(let P=0;P<c.length;){if((v=c.charCodeAt(P++))>255||(x=c.charCodeAt(P++))>255||(E=c.charCodeAt(P++))>255)throw new TypeError("invalid character found");p=v<<16|x<<8|E,F+=xr[p>>18&63]+xr[p>>12&63]+xr[p>>6&63]+xr[63&p]}return C?F.slice(0,C-3)+"===".substring(C):F},Fr="function"===typeof btoa?c=>btoa(c):vr?c=>Buffer.from(c,"binary").toString("base64"):btoaPolyfill,Ar=vr?c=>Buffer.from(c).toString("base64"):c=>{let p=[];for(let v=0,x=c.length;v<x;v+=4096)p.push(wr.apply(null,c.subarray(v,v+4096)));return Fr(p.join(""))},cb_utob=c=>{if(c.length<2)return(p=c.charCodeAt(0))<128?c:p<2048?wr(192|p>>>6)+wr(128|63&p):wr(224|p>>>12&15)+wr(128|p>>>6&63)+wr(128|63&p);var p=65536+1024*(c.charCodeAt(0)-55296)+(c.charCodeAt(1)-56320);return wr(240|p>>>18&7)+wr(128|p>>>12&63)+wr(128|p>>>6&63)+wr(128|63&p)},Cr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=c=>c.replace(Cr,cb_utob),Ir=vr?c=>Buffer.from(c,"utf8").toString("base64"):yr?c=>Ar(yr.encode(c)):c=>Fr(utob(c)),base64_encode=(c,p=!1)=>p?Er(Ir(c)):Ir(c),atobPolyfill=c=>{if(c=c.replace(/\s+/g,""),!br.test(c))throw new TypeError("malformed base64.");c+="==".slice(2-(3&c.length));let p,v,x,E="";for(let F=0;F<c.length;)p=Sr[c.charAt(F++)]<<18|Sr[c.charAt(F++)]<<12|(v=Sr[c.charAt(F++)])<<6|(x=Sr[c.charAt(F++)]),E+=64===v?wr(p>>16&255):64===x?wr(p>>16&255,p>>8&255):wr(p>>16&255,p>>8&255,255&p);return E},Pr=base64_encode;var Rr=v(355);const Dr="fp",Br={access_token:"ACCESS_TOKEN",refresh_token:"REFRESH_TOKEN",expires_in:"EXPIRES_IN",token_expires_time:"TOKEN_EXPIRES_TIME",user_info:"USER_INFO",user_name:"USER_NAME",sessionId:"sessionId"};var __assign=function(){return __assign=Object.assign||function __assign(c){for(var p,v=1,x=arguments.length;v<x;v++)for(var E in p=arguments[v])Object.prototype.hasOwnProperty.call(p,E)&&(c[E]=p[E]);return c},__assign.apply(this,arguments)};function __awaiter(c,p,v,x){return new(v||(v=Promise))((function(E,F){function fulfilled(c){try{step(x.next(c))}catch(p){F(p)}}function rejected(c){try{step(x.throw(c))}catch(p){F(p)}}function step(c){c.done?E(c.value):function adopt(c){return c instanceof v?c:new v((function(p){p(c)}))}(c.value).then(fulfilled,rejected)}step((x=x.apply(c,p||[])).next())}))}function __generator(c,p){var v,x,E,F,C={label:0,sent:function(){if(1&E[0])throw E[1];return E[1]},trys:[],ops:[]};return F={next:verb(0),throw:verb(1),return:verb(2)},"function"===typeof Symbol&&(F[Symbol.iterator]=function(){return this}),F;function verb(P){return function(R){return function step(P){if(v)throw new TypeError("Generator is already executing.");for(;F&&(F=0,P[0]&&(C=0)),C;)try{if(v=1,x&&(E=2&P[0]?x.return:P[0]?x.throw||((E=x.return)&&E.call(x),0):x.next)&&!(E=E.call(x,P[1])).done)return E;switch(x=0,E&&(P=[2&P[0],E.value]),P[0]){case 0:case 1:E=P;break;case 4:return C.label++,{value:P[1],done:!1};case 5:C.label++,x=P[1],P=[0];continue;case 7:P=C.ops.pop(),C.trys.pop();continue;default:if(!(E=(E=C.trys).length>0&&E[E.length-1])&&(6===P[0]||2===P[0])){C=0;continue}if(3===P[0]&&(!E||P[1]>E[0]&&P[1]<E[3])){C.label=P[1];break}if(6===P[0]&&C.label<E[1]){C.label=E[1],E=P;break}if(E&&C.label<E[2]){C.label=E[2],C.ops.push(P);break}E[2]&&C.ops.pop(),C.trys.pop();continue}P=p.call(c,C)}catch(R){P=[6,R],x=0}finally{v=E=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}([P,R])}}}Object.create;function __spreadArray(c,p,v){if(v||2===arguments.length)for(var x,E=0,F=p.length;E<F;E++)!x&&E in p||(x||(x=Array.prototype.slice.call(p,0,E)),x[E]=p[E]);return c.concat(x||Array.prototype.slice.call(p))}Object.create;"function"===typeof SuppressedError&&SuppressedError;var Tr="3.4.2";function wait(c,p){return new Promise((function(v){return setTimeout(v,c,p)}))}function isPromise(c){return!!c&&"function"===typeof c.then}function awaitIfAsync(c,p){try{var v=c();isPromise(v)?v.then((function(c){return p(!0,c)}),(function(c){return p(!1,c)})):p(!0,v)}catch(x){p(!1,x)}}function mapWithBreaks(c,p,v){return void 0===v&&(v=16),__awaiter(this,void 0,void 0,(function(){var x,E,F,C;return __generator(this,(function(P){switch(P.label){case 0:x=Array(c.length),E=Date.now(),F=0,P.label=1;case 1:return F<c.length?(x[F]=p(c[F],F),(C=Date.now())>=E+v?(E=C,[4,wait(0)]):[3,3]):[3,4];case 2:P.sent(),P.label=3;case 3:return++F,[3,1];case 4:return[2,x]}}))}))}function suppressUnhandledRejectionWarning(c){c.then(void 0,(function(){}))}function x64Add(c,p){c=[c[0]>>>16,65535&c[0],c[1]>>>16,65535&c[1]],p=[p[0]>>>16,65535&p[0],p[1]>>>16,65535&p[1]];var v=[0,0,0,0];return v[3]+=c[3]+p[3],v[2]+=v[3]>>>16,v[3]&=65535,v[2]+=c[2]+p[2],v[1]+=v[2]>>>16,v[2]&=65535,v[1]+=c[1]+p[1],v[0]+=v[1]>>>16,v[1]&=65535,v[0]+=c[0]+p[0],v[0]&=65535,[v[0]<<16|v[1],v[2]<<16|v[3]]}function x64Multiply(c,p){c=[c[0]>>>16,65535&c[0],c[1]>>>16,65535&c[1]],p=[p[0]>>>16,65535&p[0],p[1]>>>16,65535&p[1]];var v=[0,0,0,0];return v[3]+=c[3]*p[3],v[2]+=v[3]>>>16,v[3]&=65535,v[2]+=c[2]*p[3],v[1]+=v[2]>>>16,v[2]&=65535,v[2]+=c[3]*p[2],v[1]+=v[2]>>>16,v[2]&=65535,v[1]+=c[1]*p[3],v[0]+=v[1]>>>16,v[1]&=65535,v[1]+=c[2]*p[2],v[0]+=v[1]>>>16,v[1]&=65535,v[1]+=c[3]*p[1],v[0]+=v[1]>>>16,v[1]&=65535,v[0]+=c[0]*p[3]+c[1]*p[2]+c[2]*p[1]+c[3]*p[0],v[0]&=65535,[v[0]<<16|v[1],v[2]<<16|v[3]]}function x64Rotl(c,p){return 32===(p%=64)?[c[1],c[0]]:p<32?[c[0]<<p|c[1]>>>32-p,c[1]<<p|c[0]>>>32-p]:(p-=32,[c[1]<<p|c[0]>>>32-p,c[0]<<p|c[1]>>>32-p])}function x64LeftShift(c,p){return 0===(p%=64)?c:p<32?[c[0]<<p|c[1]>>>32-p,c[1]<<p]:[c[1]<<p-32,0]}function x64Xor(c,p){return[c[0]^p[0],c[1]^p[1]]}function x64Fmix(c){return c=x64Xor(c,[0,c[0]>>>1]),c=x64Xor(c=x64Multiply(c,[4283543511,3981806797]),[0,c[0]>>>1]),c=x64Xor(c=x64Multiply(c,[3301882366,444984403]),[0,c[0]>>>1])}function x64hash128(c,p){p=p||0;var v,x=(c=c||"").length%16,E=c.length-x,F=[0,p],C=[0,p],P=[0,0],R=[0,0],B=[2277735313,289559509],T=[1291169091,658871167];for(v=0;v<E;v+=16)P=[255&c.charCodeAt(v+4)|(255&c.charCodeAt(v+5))<<8|(255&c.charCodeAt(v+6))<<16|(255&c.charCodeAt(v+7))<<24,255&c.charCodeAt(v)|(255&c.charCodeAt(v+1))<<8|(255&c.charCodeAt(v+2))<<16|(255&c.charCodeAt(v+3))<<24],R=[255&c.charCodeAt(v+12)|(255&c.charCodeAt(v+13))<<8|(255&c.charCodeAt(v+14))<<16|(255&c.charCodeAt(v+15))<<24,255&c.charCodeAt(v+8)|(255&c.charCodeAt(v+9))<<8|(255&c.charCodeAt(v+10))<<16|(255&c.charCodeAt(v+11))<<24],P=x64Rotl(P=x64Multiply(P,B),31),F=x64Add(F=x64Rotl(F=x64Xor(F,P=x64Multiply(P,T)),27),C),F=x64Add(x64Multiply(F,[0,5]),[0,1390208809]),R=x64Rotl(R=x64Multiply(R,T),33),C=x64Add(C=x64Rotl(C=x64Xor(C,R=x64Multiply(R,B)),31),F),C=x64Add(x64Multiply(C,[0,5]),[0,944331445]);switch(P=[0,0],R=[0,0],x){case 15:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+14)],48));case 14:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+13)],40));case 13:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+12)],32));case 12:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+11)],24));case 11:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+10)],16));case 10:R=x64Xor(R,x64LeftShift([0,c.charCodeAt(v+9)],8));case 9:R=x64Multiply(R=x64Xor(R,[0,c.charCodeAt(v+8)]),T),C=x64Xor(C,R=x64Multiply(R=x64Rotl(R,33),B));case 8:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+7)],56));case 7:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+6)],48));case 6:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+5)],40));case 5:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+4)],32));case 4:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+3)],24));case 3:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+2)],16));case 2:P=x64Xor(P,x64LeftShift([0,c.charCodeAt(v+1)],8));case 1:P=x64Multiply(P=x64Xor(P,[0,c.charCodeAt(v)]),B),F=x64Xor(F,P=x64Multiply(P=x64Rotl(P,31),T))}return F=x64Add(F=x64Xor(F,[0,c.length]),C=x64Xor(C,[0,c.length])),C=x64Add(C,F),F=x64Add(F=x64Fmix(F),C=x64Fmix(C)),C=x64Add(C,F),("00000000"+(F[0]>>>0).toString(16)).slice(-8)+("00000000"+(F[1]>>>0).toString(16)).slice(-8)+("00000000"+(C[0]>>>0).toString(16)).slice(-8)+("00000000"+(C[1]>>>0).toString(16)).slice(-8)}function toInt(c){return parseInt(c)}function toFloat(c){return parseFloat(c)}function replaceNaN(c,p){return"number"===typeof c&&isNaN(c)?p:c}function countTruthy(c){return c.reduce((function(c,p){return c+(p?1:0)}),0)}function round(c,p){if(void 0===p&&(p=1),Math.abs(p)>=1)return Math.round(c/p)*p;var v=1/p;return Math.round(c*v)/v}function ensureErrorWithMessage(c){return c&&"object"===typeof c&&"message"in c?c:{message:c}}function isFinalResultLoaded(c){return"function"!==typeof c}function loadSources(c,p,v){var x=Object.keys(c).filter((function(c){return function excludes(c,p){return!function includes(c,p){for(var v=0,x=c.length;v<x;++v)if(c[v]===p)return!0;return!1}(c,p)}(v,c)})),E=mapWithBreaks(x,(function(v){return function loadSource(c,p){var v=new Promise((function(v){var x=Date.now();awaitIfAsync(c.bind(null,p),(function(){for(var c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];var E=Date.now()-x;if(!c[0])return v((function(){return{error:ensureErrorWithMessage(c[1]),duration:E}}));var F=c[1];if(isFinalResultLoaded(F))return v((function(){return{value:F,duration:E}}));v((function(){return new Promise((function(c){var p=Date.now();awaitIfAsync(F,(function(){for(var v=[],x=0;x<arguments.length;x++)v[x]=arguments[x];var F=E+Date.now()-p;if(!v[0])return c({error:ensureErrorWithMessage(v[1]),duration:F});c({value:v[1],duration:F})}))}))}))}))}));return suppressUnhandledRejectionWarning(v),function getComponent(){return v.then((function(c){return c()}))}}(c[v],p)}));return suppressUnhandledRejectionWarning(E),function getComponents(){return __awaiter(this,void 0,void 0,(function(){var c,p,v,F;return __generator(this,(function(C){switch(C.label){case 0:return[4,E];case 1:return[4,mapWithBreaks(C.sent(),(function(c){var p=c();return suppressUnhandledRejectionWarning(p),p}))];case 2:return c=C.sent(),[4,Promise.all(c)];case 3:for(p=C.sent(),v={},F=0;F<x.length;++F)v[x[F]]=p[F];return[2,v]}}))}))}}function isTrident(){var c=window,p=navigator;return countTruthy(["MSCSSMatrix"in c,"msSetImmediate"in c,"msIndexedDB"in c,"msMaxTouchPoints"in p,"msPointerEnabled"in p])>=4}function isChromium(){var c=window,p=navigator;return countTruthy(["webkitPersistentStorage"in p,"webkitTemporaryStorage"in p,0===p.vendor.indexOf("Google"),"webkitResolveLocalFileSystemURL"in c,"BatteryManager"in c,"webkitMediaStream"in c,"webkitSpeechGrammar"in c])>=5}function isWebKit(){var c=window,p=navigator;return countTruthy(["ApplePayError"in c,"CSSPrimitiveValue"in c,"Counter"in c,0===p.vendor.indexOf("Apple"),"getStorageUpdates"in p,"WebKitMediaKeys"in c])>=4}function isDesktopSafari(){var c=window;return countTruthy(["safari"in c,!("DeviceMotionEvent"in c),!("ongestureend"in c),!("standalone"in navigator)])>=3}function exitFullscreen(){var c=document;return(c.exitFullscreen||c.msExitFullscreen||c.mozCancelFullScreen||c.webkitExitFullscreen).call(c)}function isAndroid(){var c=isChromium(),p=function isGecko(){var c,p,v=window;return countTruthy(["buildID"in navigator,"MozAppearance"in(null!==(p=null===(c=document.documentElement)||void 0===c?void 0:c.style)&&void 0!==p?p:{}),"onmozfullscreenchange"in v,"mozInnerScreenX"in v,"CSSMozDocumentRule"in v,"CanvasCaptureMediaStream"in v])>=4}();if(!c&&!p)return!1;var v=window;return countTruthy(["onorientationchange"in v,"orientation"in v,c&&!("SharedWorker"in v),p&&/android/i.test(navigator.appVersion)])>=2}function makeInnerError(c){var p=new Error(c);return p.name=c,p}function withIframe(c,p,v){var x,E,F;return void 0===v&&(v=50),__awaiter(this,void 0,void 0,(function(){var C,P;return __generator(this,(function(R){switch(R.label){case 0:C=document,R.label=1;case 1:return C.body?[3,3]:[4,wait(v)];case 2:return R.sent(),[3,1];case 3:P=C.createElement("iframe"),R.label=4;case 4:return R.trys.push([4,,10,11]),[4,new Promise((function(c,v){var x=!1,resolve=function(){x=!0,c()};P.onload=resolve,P.onerror=function(c){x=!0,v(c)};var E=P.style;E.setProperty("display","block","important"),E.position="absolute",E.top="0",E.left="0",E.visibility="hidden",p&&"srcdoc"in P?P.srcdoc=p:P.src="about:blank",C.body.appendChild(P);var checkReadyState=function(){var c,p;x||("complete"===(null===(p=null===(c=P.contentWindow)||void 0===c?void 0:c.document)||void 0===p?void 0:p.readyState)?resolve():setTimeout(checkReadyState,10))};checkReadyState()}))];case 5:R.sent(),R.label=6;case 6:return(null===(E=null===(x=P.contentWindow)||void 0===x?void 0:x.document)||void 0===E?void 0:E.body)?[3,8]:[4,wait(v)];case 7:return R.sent(),[3,6];case 8:return[4,c(P,P.contentWindow)];case 9:return[2,R.sent()];case 10:return null===(F=P.parentNode)||void 0===F||F.removeChild(P),[7];case 11:return[2]}}))}))}function selectorToElement(c){for(var p=function parseSimpleCssSelector(c){for(var p,v,x="Unexpected syntax '".concat(c,"'"),E=/^\s*([a-z-]*)(.*)$/i.exec(c),F=E[1]||void 0,C={},P=/([.:#][\w-]+|\[.+?\])/gi,addAttribute=function(c,p){C[c]=C[c]||[],C[c].push(p)};;){var R=P.exec(E[2]);if(!R)break;var B=R[0];switch(B[0]){case".":addAttribute("class",B.slice(1));break;case"#":addAttribute("id",B.slice(1));break;case"[":var T=/^\[([\w-]+)([~|^$*]?=("(.*?)"|([\w-]+)))?(\s+[is])?\]$/.exec(B);if(!T)throw new Error(x);addAttribute(T[1],null!==(v=null!==(p=T[4])&&void 0!==p?p:T[5])&&void 0!==v?v:"");break;default:throw new Error(x)}}return[F,C]}(c),v=p[0],x=p[1],E=document.createElement(null!==v&&void 0!==v?v:"div"),F=0,C=Object.keys(x);F<C.length;F++){var P=C[F],R=x[P].join(" ");"style"===P?addStyleString(E.style,R):E.setAttribute(P,R)}return E}function addStyleString(c,p){for(var v=0,x=p.split(";");v<x.length;v++){var E=x[v],F=/^\s*([\w-]+)\s*:\s*(.+?)(\s*!([\w-]+))?\s*$/.exec(E);if(F){var C=F[1],P=F[2],R=F[4];c.setProperty(C,P,R||"")}}}var Nr=["monospace","sans-serif","serif"],Or=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF"];function canvasToString(c){return c.toDataURL()}var Hr,jr,_r=2500;function getScreenFrame(){var c=this;return function watchScreenFrame(){if(void 0===jr){var checkScreenFrame=function(){var c=getCurrentScreenFrame();isFrameSizeNull(c)?jr=setTimeout(checkScreenFrame,_r):(Hr=c,jr=void 0)};checkScreenFrame()}}(),function(){return __awaiter(c,void 0,void 0,(function(){var c;return __generator(this,(function(p){switch(p.label){case 0:return isFrameSizeNull(c=getCurrentScreenFrame())?Hr?[2,__spreadArray([],Hr,!0)]:function getFullscreenElement(){var c=document;return c.fullscreenElement||c.msFullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement||null}()?[4,exitFullscreen()]:[3,2]:[3,2];case 1:p.sent(),c=getCurrentScreenFrame(),p.label=2;case 2:return isFrameSizeNull(c)||(Hr=c),[2,c]}}))}))}}function getCurrentScreenFrame(){var c=screen;return[replaceNaN(toFloat(c.availTop),null),replaceNaN(toFloat(c.width)-toFloat(c.availWidth)-replaceNaN(toFloat(c.availLeft),0),null),replaceNaN(toFloat(c.height)-toFloat(c.availHeight)-replaceNaN(toFloat(c.availTop),0),null),replaceNaN(toFloat(c.availLeft),null)]}function isFrameSizeNull(c){for(var p=0;p<4;++p)if(c[p])return!1;return!0}function getBlockedSelectors(c){var p;return __awaiter(this,void 0,void 0,(function(){var v,x,E,F,C,P,R;return __generator(this,(function(B){switch(B.label){case 0:for(v=document,x=v.createElement("div"),E=new Array(c.length),F={},forceShow(x),R=0;R<c.length;++R)"DIALOG"===(C=selectorToElement(c[R])).tagName&&C.show(),forceShow(P=v.createElement("div")),P.appendChild(C),x.appendChild(P),E[R]=C;B.label=1;case 1:return v.body?[3,3]:[4,wait(50)];case 2:return B.sent(),[3,1];case 3:v.body.appendChild(x);try{for(R=0;R<c.length;++R)E[R].offsetParent||(F[c[R]]=!0)}finally{null===(p=x.parentNode)||void 0===p||p.removeChild(x)}return[2,F]}}))}))}function forceShow(c){c.style.setProperty("display","block","important")}function doesMatch$4(c){return matchMedia("(inverted-colors: ".concat(c,")")).matches}function doesMatch$3(c){return matchMedia("(forced-colors: ".concat(c,")")).matches}function doesMatch$2(c){return matchMedia("(prefers-contrast: ".concat(c,")")).matches}function doesMatch$1(c){return matchMedia("(prefers-reduced-motion: ".concat(c,")")).matches}function doesMatch(c){return matchMedia("(dynamic-range: ".concat(c,")")).matches}var kr=Math,fallbackFn=function(){return 0};var Lr={default:[],apple:[{font:"-apple-system-body"}],serif:[{fontFamily:"serif"}],sans:[{fontFamily:"sans-serif"}],mono:[{fontFamily:"monospace"}],min:[{fontSize:"1px"}],system:[{fontFamily:"system-ui"}]};var Vr={fonts:function getFonts(){return withIframe((function(c,p){var v=p.document,x=v.body;x.style.fontSize="48px";var E=v.createElement("div"),F={},C={},createSpan=function(c){var p=v.createElement("span"),x=p.style;return x.position="absolute",x.top="0",x.left="0",x.fontFamily=c,p.textContent="mmMwWLliI0O&1",E.appendChild(p),p},P=Nr.map(createSpan),R=function(){for(var c={},_loop_1=function(p){c[p]=Nr.map((function(c){return function(c,p){return createSpan("'".concat(c,"',").concat(p))}(p,c)}))},p=0,v=Or;p<v.length;p++){_loop_1(v[p])}return c}();x.appendChild(E);for(var B=0;B<Nr.length;B++)F[Nr[B]]=P[B].offsetWidth,C[Nr[B]]=P[B].offsetHeight;return Or.filter((function(c){return p=R[c],Nr.some((function(c,v){return p[v].offsetWidth!==F[c]||p[v].offsetHeight!==C[c]}));var p}))}))},domBlockers:function getDomBlockers(c){var p=(void 0===c?{}:c).debug;return __awaiter(this,void 0,void 0,(function(){var c,v,x,E,F;return __generator(this,(function(C){switch(C.label){case 0:return function isApplicable(){return isWebKit()||isAndroid()}()?(c=function getFilters(){var c=atob;return{abpIndo:["#Iklan-Melayang","#Kolom-Iklan-728","#SidebarIklan-wrapper",'[title="ALIENBOLA" i]',c("I0JveC1CYW5uZXItYWRz")],abpvn:[".quangcao","#mobileCatfish",c("LmNsb3NlLWFkcw=="),'[id^="bn_bottom_fixed_"]',"#pmadv"],adBlockFinland:[".mainostila",c("LnNwb25zb3JpdA=="),".ylamainos",c("YVtocmVmKj0iL2NsaWNrdGhyZ2guYXNwPyJd"),c("YVtocmVmXj0iaHR0cHM6Ly9hcHAucmVhZHBlYWsuY29tL2FkcyJd")],adBlockPersian:["#navbar_notice_50",".kadr",'TABLE[width="140px"]',"#divAgahi",c("YVtocmVmXj0iaHR0cDovL2cxLnYuZndtcm0ubmV0L2FkLyJd")],adBlockWarningRemoval:["#adblock-honeypot",".adblocker-root",".wp_adblock_detect",c("LmhlYWRlci1ibG9ja2VkLWFk"),c("I2FkX2Jsb2NrZXI=")],adGuardAnnoyances:[".hs-sosyal","#cookieconsentdiv",'div[class^="app_gdpr"]',".as-oil",'[data-cypress="soft-push-notification-modal"]'],adGuardBase:[".BetterJsPopOverlay",c("I2FkXzMwMFgyNTA="),c("I2Jhbm5lcmZsb2F0MjI="),c("I2NhbXBhaWduLWJhbm5lcg=="),c("I0FkLUNvbnRlbnQ=")],adGuardChinese:[c("LlppX2FkX2FfSA=="),c("YVtocmVmKj0iLmh0aGJldDM0LmNvbSJd"),"#widget-quan",c("YVtocmVmKj0iLzg0OTkyMDIwLnh5eiJd"),c("YVtocmVmKj0iLjE5NTZobC5jb20vIl0=")],adGuardFrench:["#pavePub",c("LmFkLWRlc2t0b3AtcmVjdGFuZ2xl"),".mobile_adhesion",".widgetadv",c("LmFkc19iYW4=")],adGuardGerman:['aside[data-portal-id="leaderboard"]'],adGuardJapanese:["#kauli_yad_1",c("YVtocmVmXj0iaHR0cDovL2FkMi50cmFmZmljZ2F0ZS5uZXQvIl0="),c("Ll9wb3BJbl9pbmZpbml0ZV9hZA=="),c("LmFkZ29vZ2xl"),c("Ll9faXNib29zdFJldHVybkFk")],adGuardMobile:[c("YW1wLWF1dG8tYWRz"),c("LmFtcF9hZA=="),'amp-embed[type="24smi"]',"#mgid_iframe1",c("I2FkX2ludmlld19hcmVh")],adGuardRussian:[c("YVtocmVmXj0iaHR0cHM6Ly9hZC5sZXRtZWFkcy5jb20vIl0="),c("LnJlY2xhbWE="),'div[id^="smi2adblock"]',c("ZGl2W2lkXj0iQWRGb3hfYmFubmVyXyJd"),"#psyduckpockeball"],adGuardSocial:[c("YVtocmVmXj0iLy93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9Il0="),c("YVtocmVmXj0iLy90ZWxlZ3JhbS5tZS9zaGFyZS91cmw/Il0="),".etsy-tweet","#inlineShare",".popup-social"],adGuardSpanishPortuguese:["#barraPublicidade","#Publicidade","#publiEspecial","#queTooltip",".cnt-publi"],adGuardTrackingProtection:["#qoo-counter",c("YVtocmVmXj0iaHR0cDovL2NsaWNrLmhvdGxvZy5ydS8iXQ=="),c("YVtocmVmXj0iaHR0cDovL2hpdGNvdW50ZXIucnUvdG9wL3N0YXQucGhwIl0="),c("YVtocmVmXj0iaHR0cDovL3RvcC5tYWlsLnJ1L2p1bXAiXQ=="),"#top100counter"],adGuardTurkish:["#backkapat",c("I3Jla2xhbWk="),c("YVtocmVmXj0iaHR0cDovL2Fkc2Vydi5vbnRlay5jb20udHIvIl0="),c("YVtocmVmXj0iaHR0cDovL2l6bGVuemkuY29tL2NhbXBhaWduLyJd"),c("YVtocmVmXj0iaHR0cDovL3d3dy5pbnN0YWxsYWRzLm5ldC8iXQ==")],bulgarian:[c("dGQjZnJlZW5ldF90YWJsZV9hZHM="),"#ea_intext_div",".lapni-pop-over","#xenium_hot_offers"],easyList:[".yb-floorad",c("LndpZGdldF9wb19hZHNfd2lkZ2V0"),c("LnRyYWZmaWNqdW5reS1hZA=="),".textad_headline",c("LnNwb25zb3JlZC10ZXh0LWxpbmtz")],easyListChina:[c("LmFwcGd1aWRlLXdyYXBbb25jbGljayo9ImJjZWJvcy5jb20iXQ=="),c("LmZyb250cGFnZUFkdk0="),"#taotaole","#aafoot.top_box",".cfa_popup"],easyListCookie:[".ezmob-footer",".cc-CookieWarning","[data-cookie-number]",c("LmF3LWNvb2tpZS1iYW5uZXI="),".sygnal24-gdpr-modal-wrap"],easyListCzechSlovak:["#onlajny-stickers",c("I3Jla2xhbW5pLWJveA=="),c("LnJla2xhbWEtbWVnYWJvYXJk"),".sklik",c("W2lkXj0ic2tsaWtSZWtsYW1hIl0=")],easyListDutch:[c("I2FkdmVydGVudGll"),c("I3ZpcEFkbWFya3RCYW5uZXJCbG9jaw=="),".adstekst",c("YVtocmVmXj0iaHR0cHM6Ly94bHR1YmUubmwvY2xpY2svIl0="),"#semilo-lrectangle"],easyListGermany:["#SSpotIMPopSlider",c("LnNwb25zb3JsaW5rZ3J1ZW4="),c("I3dlcmJ1bmdza3k="),c("I3Jla2xhbWUtcmVjaHRzLW1pdHRl"),c("YVtocmVmXj0iaHR0cHM6Ly9iZDc0Mi5jb20vIl0=")],easyListItaly:[c("LmJveF9hZHZfYW5udW5jaQ=="),".sb-box-pubbliredazionale",c("YVtocmVmXj0iaHR0cDovL2FmZmlsaWF6aW9uaWFkcy5zbmFpLml0LyJd"),c("YVtocmVmXj0iaHR0cHM6Ly9hZHNlcnZlci5odG1sLml0LyJd"),c("YVtocmVmXj0iaHR0cHM6Ly9hZmZpbGlhemlvbmlhZHMuc25haS5pdC8iXQ==")],easyListLithuania:[c("LnJla2xhbW9zX3RhcnBhcw=="),c("LnJla2xhbW9zX251b3JvZG9z"),c("aW1nW2FsdD0iUmVrbGFtaW5pcyBza3lkZWxpcyJd"),c("aW1nW2FsdD0iRGVkaWt1b3RpLmx0IHNlcnZlcmlhaSJd"),c("aW1nW2FsdD0iSG9zdGluZ2FzIFNlcnZlcmlhaS5sdCJd")],estonian:[c("QVtocmVmKj0iaHR0cDovL3BheTRyZXN1bHRzMjQuZXUiXQ==")],fanboyAnnoyances:["#ac-lre-player",".navigate-to-top","#subscribe_popup",".newsletter_holder","#back-top"],fanboyAntiFacebook:[".util-bar-module-firefly-visible"],fanboyEnhancedTrackers:[".open.pushModal","#issuem-leaky-paywall-articles-zero-remaining-nag","#sovrn_container",'div[class$="-hide"][zoompage-fontsize][style="display: block;"]',".BlockNag__Card"],fanboySocial:["#FollowUs","#meteored_share","#social_follow",".article-sharer",".community__social-desc"],frellwitSwedish:[c("YVtocmVmKj0iY2FzaW5vcHJvLnNlIl1bdGFyZ2V0PSJfYmxhbmsiXQ=="),c("YVtocmVmKj0iZG9rdG9yLXNlLm9uZWxpbmsubWUiXQ=="),"article.category-samarbete",c("ZGl2LmhvbGlkQWRz"),"ul.adsmodern"],greekAdBlock:[c("QVtocmVmKj0iYWRtYW4ub3RlbmV0LmdyL2NsaWNrPyJd"),c("QVtocmVmKj0iaHR0cDovL2F4aWFiYW5uZXJzLmV4b2R1cy5nci8iXQ=="),c("QVtocmVmKj0iaHR0cDovL2ludGVyYWN0aXZlLmZvcnRobmV0LmdyL2NsaWNrPyJd"),"DIV.agores300","TABLE.advright"],hungarian:["#cemp_doboz",".optimonk-iframe-container",c("LmFkX19tYWlu"),c("W2NsYXNzKj0iR29vZ2xlQWRzIl0="),"#hirdetesek_box"],iDontCareAboutCookies:['.alert-info[data-block-track*="CookieNotice"]',".ModuleTemplateCookieIndicator",".o--cookies--container","#cookies-policy-sticky","#stickyCookieBar"],icelandicAbp:[c("QVtocmVmXj0iL2ZyYW1ld29yay9yZXNvdXJjZXMvZm9ybXMvYWRzLmFzcHgiXQ==")],latvian:[c("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMjBweDsgaGVpZ2h0OiA0MHB4OyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7Il0="),c("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiA4OHB4OyBoZWlnaHQ6IDMxcHg7IG92ZXJmbG93OiBoaWRkZW47IHBvc2l0aW9uOiByZWxhdGl2ZTsiXQ==")],listKr:[c("YVtocmVmKj0iLy9hZC5wbGFuYnBsdXMuY28ua3IvIl0="),c("I2xpdmVyZUFkV3JhcHBlcg=="),c("YVtocmVmKj0iLy9hZHYuaW1hZHJlcC5jby5rci8iXQ=="),c("aW5zLmZhc3R2aWV3LWFk"),".revenue_unit_item.dable"],listeAr:[c("LmdlbWluaUxCMUFk"),".right-and-left-sponsers",c("YVtocmVmKj0iLmFmbGFtLmluZm8iXQ=="),c("YVtocmVmKj0iYm9vcmFxLm9yZyJd"),c("YVtocmVmKj0iZHViaXp6bGUuY29tL2FyLz91dG1fc291cmNlPSJd")],listeFr:[c("YVtocmVmXj0iaHR0cDovL3Byb21vLnZhZG9yLmNvbS8iXQ=="),c("I2FkY29udGFpbmVyX3JlY2hlcmNoZQ=="),c("YVtocmVmKj0id2Vib3JhbWEuZnIvZmNnaS1iaW4vIl0="),".site-pub-interstitiel",'div[id^="crt-"][data-criteo-id]'],officialPolish:["#ceneo-placeholder-ceneo-12",c("W2hyZWZePSJodHRwczovL2FmZi5zZW5kaHViLnBsLyJd"),c("YVtocmVmXj0iaHR0cDovL2Fkdm1hbmFnZXIudGVjaGZ1bi5wbC9yZWRpcmVjdC8iXQ=="),c("YVtocmVmXj0iaHR0cDovL3d3dy50cml6ZXIucGwvP3V0bV9zb3VyY2UiXQ=="),c("ZGl2I3NrYXBpZWNfYWQ=")],ro:[c("YVtocmVmXj0iLy9hZmZ0cmsuYWx0ZXgucm8vQ291bnRlci9DbGljayJd"),c("YVtocmVmXj0iaHR0cHM6Ly9ibGFja2ZyaWRheXNhbGVzLnJvL3Ryay9zaG9wLyJd"),c("YVtocmVmXj0iaHR0cHM6Ly9ldmVudC4ycGVyZm9ybWFudC5jb20vZXZlbnRzL2NsaWNrIl0="),c("YVtocmVmXj0iaHR0cHM6Ly9sLnByb2ZpdHNoYXJlLnJvLyJd"),'a[href^="/url/"]'],ruAd:[c("YVtocmVmKj0iLy9mZWJyYXJlLnJ1LyJd"),c("YVtocmVmKj0iLy91dGltZy5ydS8iXQ=="),c("YVtocmVmKj0iOi8vY2hpa2lkaWtpLnJ1Il0="),"#pgeldiz",".yandex-rtb-block"],thaiAds:["a[href*=macau-uta-popup]",c("I2Fkcy1nb29nbGUtbWlkZGxlX3JlY3RhbmdsZS1ncm91cA=="),c("LmFkczMwMHM="),".bumq",".img-kosana"],webAnnoyancesUltralist:["#mod-social-share-2","#social-tools",c("LmN0cGwtZnVsbGJhbm5lcg=="),".zergnet-recommend",".yt.btn-link.btn-md.btn"]}}(),v=Object.keys(c),[4,getBlockedSelectors((F=[]).concat.apply(F,v.map((function(p){return c[p]}))))]):[2,void 0];case 1:return x=C.sent(),p&&function printDebug(c,p){for(var v="DOM blockers debug:\n```",x=0,E=Object.keys(c);x<E.length;x++){var F=E[x];v+="\n".concat(F,":");for(var C=0,P=c[F];C<P.length;C++){var R=P[C];v+="\n  ".concat(p[R]?"\ud83d\udeab":"\u27a1\ufe0f"," ").concat(R)}}console.log("".concat(v,"\n```"))}(c,x),(E=v.filter((function(p){var v=c[p];return countTruthy(v.map((function(c){return x[c]})))>.6*v.length}))).sort(),[2,E]}}))}))},fontPreferences:function getFontPreferences(){return function withNaturalFonts(c,p){void 0===p&&(p=4e3);return withIframe((function(v,x){var E=x.document,F=E.body,C=F.style;C.width="".concat(p,"px"),C.webkitTextSizeAdjust=C.textSizeAdjust="none",isChromium()?F.style.zoom="".concat(1/x.devicePixelRatio):isWebKit()&&(F.style.zoom="reset");var P=E.createElement("div");return P.textContent=__spreadArray([],Array(p/20|0),!0).map((function(){return"word"})).join(" "),F.appendChild(P),c(E,F)}),'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">')}((function(c,p){for(var v={},x={},E=0,F=Object.keys(Lr);E<F.length;E++){var C=F[E],P=Lr[C],R=P[0],B=void 0===R?{}:R,T=P[1],N=void 0===T?"mmMwWLliI0fiflO&1":T,_=c.createElement("span");_.textContent=N,_.style.whiteSpace="nowrap";for(var L=0,V=Object.keys(B);L<V.length;L++){var U=V[L],W=B[U];void 0!==W&&(_.style[U]=W)}v[C]=_,p.appendChild(c.createElement("br")),p.appendChild(_)}for(var G=0,X=Object.keys(Lr);G<X.length;G++){x[C=X[G]]=v[C].getBoundingClientRect().width}return x}))},audio:function getAudioFingerprint(){var c=window,p=c.OfflineAudioContext||c.webkitOfflineAudioContext;if(!p)return-2;if(function doesCurrentBrowserSuspendAudioContext(){return isWebKit()&&!isDesktopSafari()&&!function isWebKit606OrNewer(){var c=window;return countTruthy(["DOMRectList"in c,"RTCPeerConnectionIceEvent"in c,"SVGGeometryElement"in c,"ontransitioncancel"in c])>=3}()}())return-1;var v=new p(1,5e3,44100),x=v.createOscillator();x.type="triangle",x.frequency.value=1e4;var E=v.createDynamicsCompressor();E.threshold.value=-50,E.knee.value=40,E.ratio.value=12,E.attack.value=0,E.release.value=.25,x.connect(E),E.connect(v.destination),x.start(0);var F=function startRenderingAudio(c){var p=3,v=500,x=500,E=5e3,finalize=function(){},F=new Promise((function(F,C){var P=!1,R=0,B=0;c.oncomplete=function(c){return F(c.renderedBuffer)};var startRunningTimeout=function(){setTimeout((function(){return C(makeInnerError("timeout"))}),Math.min(x,B+E-Date.now()))},tryRender=function(){try{var x=c.startRendering();switch(isPromise(x)&&suppressUnhandledRejectionWarning(x),c.state){case"running":B=Date.now(),P&&startRunningTimeout();break;case"suspended":document.hidden||R++,P&&R>=p?C(makeInnerError("suspended")):setTimeout(tryRender,v)}}catch(E){C(E)}};tryRender(),finalize=function(){P||(P=!0,B>0&&startRunningTimeout())}}));return[F,finalize]}(v),C=F[0],P=F[1],R=C.then((function(c){return function getHash(c){for(var p=0,v=0;v<c.length;++v)p+=Math.abs(c[v]);return p}(c.getChannelData(0).subarray(4500))}),(function(c){if("timeout"===c.name||"suspended"===c.name)return-3;throw c}));return suppressUnhandledRejectionWarning(R),function(){return P(),R}},screenFrame:function getRoundedScreenFrame(){var c=this,p=getScreenFrame();return function(){return __awaiter(c,void 0,void 0,(function(){var c,v;return __generator(this,(function(x){switch(x.label){case 0:return[4,p()];case 1:return c=x.sent(),[2,[(v=function(c){return null===c?null:round(c,10)})(c[0]),v(c[1]),v(c[2]),v(c[3])]]}}))}))}},osCpu:function getOsCpu(){return navigator.oscpu},languages:function getLanguages(){var c=navigator,p=[],v=c.language||c.userLanguage||c.browserLanguage||c.systemLanguage;if(void 0!==v&&p.push([v]),Array.isArray(c.languages))isChromium()&&function isChromium86OrNewer(){var c=window;return countTruthy([!("MediaSettingsRange"in c),"RTCEncodedAudioFrame"in c,""+c.Intl==="[object Intl]",""+c.Reflect==="[object Reflect]"])>=3}()||p.push(c.languages);else if("string"===typeof c.languages){var x=c.languages;x&&p.push(x.split(","))}return p},colorDepth:function getColorDepth(){return window.screen.colorDepth},deviceMemory:function getDeviceMemory(){return replaceNaN(toFloat(navigator.deviceMemory),void 0)},screenResolution:function getScreenResolution(){var c=screen,parseDimension=function(c){return replaceNaN(toInt(c),null)},p=[parseDimension(c.width),parseDimension(c.height)];return p.sort().reverse(),p},hardwareConcurrency:function getHardwareConcurrency(){return replaceNaN(toInt(navigator.hardwareConcurrency),void 0)},timezone:function getTimezone(){var c,p=null===(c=window.Intl)||void 0===c?void 0:c.DateTimeFormat;if(p){var v=(new p).resolvedOptions().timeZone;if(v)return v}var x=-function getTimezoneOffset(){var c=(new Date).getFullYear();return Math.max(toFloat(new Date(c,0,1).getTimezoneOffset()),toFloat(new Date(c,6,1).getTimezoneOffset()))}();return"UTC".concat(x>=0?"+":"").concat(Math.abs(x))},sessionStorage:function getSessionStorage(){try{return!!window.sessionStorage}catch(c){return!0}},localStorage:function getLocalStorage(){try{return!!window.localStorage}catch(c){return!0}},indexedDB:function getIndexedDB(){if(!isTrident()&&!function isEdgeHTML(){var c=window,p=navigator;return countTruthy(["msWriteProfilerMark"in c,"MSStream"in c,"msLaunchUri"in p,"msSaveBlob"in p])>=3&&!isTrident()}())try{return!!window.indexedDB}catch(c){return!0}},openDatabase:function getOpenDatabase(){return!!window.openDatabase},cpuClass:function getCpuClass(){return navigator.cpuClass},platform:function getPlatform(){var c=navigator.platform;return"MacIntel"===c&&isWebKit()&&!isDesktopSafari()?function isIPad(){if("iPad"===navigator.platform)return!0;var c=screen,p=c.width/c.height;return countTruthy(["MediaSource"in window,!!Element.prototype.webkitRequestFullscreen,p>.65&&p<1.53])>=2}()?"iPad":"iPhone":c},plugins:function getPlugins(){var c=navigator.plugins;if(c){for(var p=[],v=0;v<c.length;++v){var x=c[v];if(x){for(var E=[],F=0;F<x.length;++F){var C=x[F];E.push({type:C.type,suffixes:C.suffixes})}p.push({name:x.name,description:x.description,mimeTypes:E})}}return p}},canvas:function getCanvasFingerprint(){var c,p,v=!1,x=function makeCanvasContext(){var c=document.createElement("canvas");return c.width=1,c.height=1,[c,c.getContext("2d")]}(),E=x[0],F=x[1];if(function isSupported(c,p){return!(!p||!c.toDataURL)}(E,F)){v=function doesSupportWinding(c){return c.rect(0,0,10,10),c.rect(2,2,6,6),!c.isPointInPath(5,5,"evenodd")}(F),function renderTextImage(c,p){c.width=240,c.height=60,p.textBaseline="alphabetic",p.fillStyle="#f60",p.fillRect(100,1,62,20),p.fillStyle="#069",p.font='11pt "Times New Roman"';var v="Cwm fjordbank gly ".concat(String.fromCharCode(55357,56835));p.fillText(v,2,15),p.fillStyle="rgba(102, 204, 0, 0.2)",p.font="18pt Arial",p.fillText(v,4,45)}(E,F);var C=canvasToString(E);C!==canvasToString(E)?c=p="unstable":(p=C,function renderGeometryImage(c,p){c.width=122,c.height=110,p.globalCompositeOperation="multiply";for(var v=0,x=[["#f2f",40,40],["#2ff",80,40],["#ff2",60,80]];v<x.length;v++){var E=x[v],F=E[0],C=E[1],P=E[2];p.fillStyle=F,p.beginPath(),p.arc(C,P,40,0,2*Math.PI,!0),p.closePath(),p.fill()}p.fillStyle="#f9c",p.arc(60,60,60,0,2*Math.PI,!0),p.arc(60,60,20,0,2*Math.PI,!0),p.fill("evenodd")}(E,F),c=canvasToString(E))}else c=p="";return{winding:v,geometry:c,text:p}},touchSupport:function getTouchSupport(){var c,p=navigator,v=0;void 0!==p.maxTouchPoints?v=toInt(p.maxTouchPoints):void 0!==p.msMaxTouchPoints&&(v=p.msMaxTouchPoints);try{document.createEvent("TouchEvent"),c=!0}catch(x){c=!1}return{maxTouchPoints:v,touchEvent:c,touchStart:"ontouchstart"in window}},vendor:function getVendor(){return navigator.vendor||""},vendorFlavors:function getVendorFlavors(){for(var c=[],p=0,v=["chrome","safari","__crWeb","__gCrWeb","yandex","__yb","__ybro","__firefox__","__edgeTrackingPreventionStatistics","webkit","oprt","samsungAr","ucweb","UCShellJava","puffinDevice"];p<v.length;p++){var x=v[p],E=window[x];E&&"object"===typeof E&&c.push(x)}return c.sort()},cookiesEnabled:function areCookiesEnabled(){var c=document;try{c.cookie="cookietest=1; SameSite=Strict;";var p=-1!==c.cookie.indexOf("cookietest=");return c.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",p}catch(v){return!1}},colorGamut:function getColorGamut(){for(var c=0,p=["rec2020","p3","srgb"];c<p.length;c++){var v=p[c];if(matchMedia("(color-gamut: ".concat(v,")")).matches)return v}},invertedColors:function areColorsInverted(){return!!doesMatch$4("inverted")||!doesMatch$4("none")&&void 0},forcedColors:function areColorsForced(){return!!doesMatch$3("active")||!doesMatch$3("none")&&void 0},monochrome:function getMonochromeDepth(){if(matchMedia("(min-monochrome: 0)").matches){for(var c=0;c<=100;++c)if(matchMedia("(max-monochrome: ".concat(c,")")).matches)return c;throw new Error("Too high value")}},contrast:function getContrastPreference(){return doesMatch$2("no-preference")?0:doesMatch$2("high")||doesMatch$2("more")?1:doesMatch$2("low")||doesMatch$2("less")?-1:doesMatch$2("forced")?10:void 0},reducedMotion:function isMotionReduced(){return!!doesMatch$1("reduce")||!doesMatch$1("no-preference")&&void 0},hdr:function isHDR(){return!!doesMatch("high")||!doesMatch("standard")&&void 0},math:function getMathFingerprint(){var c,p=kr.acos||fallbackFn,v=kr.acosh||fallbackFn,x=kr.asin||fallbackFn,E=kr.asinh||fallbackFn,F=kr.atanh||fallbackFn,C=kr.atan||fallbackFn,P=kr.sin||fallbackFn,R=kr.sinh||fallbackFn,B=kr.cos||fallbackFn,T=kr.cosh||fallbackFn,N=kr.tan||fallbackFn,_=kr.tanh||fallbackFn,L=kr.exp||fallbackFn,V=kr.expm1||fallbackFn,U=kr.log1p||fallbackFn;return{acos:p(.12312423423423424),acosh:v(1e308),acoshPf:(c=1e154,kr.log(c+kr.sqrt(c*c-1))),asin:x(.12312423423423424),asinh:E(1),asinhPf:function(c){return kr.log(c+kr.sqrt(c*c+1))}(1),atanh:F(.5),atanhPf:function(c){return kr.log((1+c)/(1-c))/2}(.5),atan:C(.5),sin:P(-1e300),sinh:R(1),sinhPf:function(c){return kr.exp(c)-1/kr.exp(c)/2}(1),cos:B(10.000000000123),cosh:T(1),coshPf:function(c){return(kr.exp(c)+1/kr.exp(c))/2}(1),tan:N(-1e300),tanh:_(1),tanhPf:function(c){return(kr.exp(2*c)-1)/(kr.exp(2*c)+1)}(1),exp:L(1),expm1:V(1),expm1Pf:function(c){return kr.exp(c)-1}(1),log1p:U(10),log1pPf:function(c){return kr.log(1+c)}(10),powPI:function(c){return kr.pow(kr.PI,c)}(-100)}},videoCard:function getVideoCard(){var c,p=document.createElement("canvas"),v=null!==(c=p.getContext("webgl"))&&void 0!==c?c:p.getContext("experimental-webgl");if(v&&"getExtension"in v){var x=v.getExtension("WEBGL_debug_renderer_info");if(x)return{vendor:(v.getParameter(x.UNMASKED_VENDOR_WEBGL)||"").toString(),renderer:(v.getParameter(x.UNMASKED_RENDERER_WEBGL)||"").toString()}}},pdfViewerEnabled:function isPdfViewerEnabled(){return navigator.pdfViewerEnabled},architecture:function getArchitecture(){var c=new Float32Array(1),p=new Uint8Array(c.buffer);return c[0]=1/0,c[0]=c[0]-c[0],p[3]}};var Mr="$ if upgrade to Pro: https://fpjs.dev/pro";function getConfidence(c){var p=function getOpenConfidenceScore(c){if(isAndroid())return.4;if(isWebKit())return isDesktopSafari()?.5:.3;var p=c.platform.value||"";if(/^Win/.test(p))return.6;if(/^Mac/.test(p))return.5;return.7}(c),v=function deriveProConfidenceScore(c){return round(.99+.01*c,1e-4)}(p);return{score:p,comment:Mr.replace(/\$/g,"".concat(v))}}function componentsToDebugString(c){return JSON.stringify(c,(function(c,p){return p instanceof Error?function errorToObject(c){var p;return __assign({name:c.name,message:c.message,stack:null===(p=c.stack)||void 0===p?void 0:p.split("\n")},c)}(p):p}),2)}function hashComponents(c){return x64hash128(function componentsToCanonicalString(c){for(var p="",v=0,x=Object.keys(c).sort();v<x.length;v++){var E=x[v],F=c[E],C=F.error?"error":JSON.stringify(F.value);p+="".concat(p?"|":"").concat(E.replace(/([:|\\])/g,"\\$1"),":").concat(C)}return p}(c))}function prepareForSources(c){return void 0===c&&(c=50),function requestIdleCallbackIfAvailable(c,p){void 0===p&&(p=1/0);var v=window.requestIdleCallback;return v?new Promise((function(c){return v.call(window,(function(){return c()}),{timeout:p})})):wait(Math.min(c,p))}(c,2*c)}function makeAgent(c,p){var v=Date.now();return{get:function(x){return __awaiter(this,void 0,void 0,(function(){var E,F,C;return __generator(this,(function(P){switch(P.label){case 0:return E=Date.now(),[4,c()];case 1:return F=P.sent(),C=function makeLazyGetResult(c){var p,v=getConfidence(c);return{get visitorId(){return void 0===p&&(p=hashComponents(this.components)),p},set visitorId(c){p=c},confidence:v,components:c,version:Tr}}(F),(p||(null===x||void 0===x?void 0:x.debug))&&console.log("Copy the text below to get the debug data:\n\n```\nversion: ".concat(C.version,"\nuserAgent: ").concat(navigator.userAgent,"\ntimeBetweenLoadAndGet: ").concat(E-v,"\nvisitorId: ").concat(C.visitorId,"\ncomponents: ").concat(componentsToDebugString(F),"\n```")),[2,C]}}))}))}}}var Kr={load:function load(c){var p=void 0===c?{}:c,v=p.delayFallback,x=p.debug,E=p.monitoring,F=void 0===E||E;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(c){switch(c.label){case 0:return F&&function monitor(){if(!(window.__fpjs_d_m||Math.random()>=.001))try{var c=new XMLHttpRequest;c.open("get","https://m1.openfpcdn.io/fingerprintjs/v".concat(Tr,"/npm-monitoring"),!0),c.send()}catch(p){console.error(p)}}(),[4,prepareForSources(v)];case 1:return c.sent(),[2,makeAgent(function loadBuiltinSources(c){return loadSources(Vr,c,[])}({debug:x}),x)]}}))}))},hashComponents:hashComponents,componentsToDebugString:componentsToDebugString};const qr=new class BridgeAction{getBirdgeObj(){if(!window.flutter_inappwebview)throw new Error("\u8bf7\u5728app\u73af\u5883\u4e0b\u4f7f\u7528");return window.flutter_inappwebview}isMobileEnv(){return!!window.flutter_inappwebview}getBridgeToken(){return new Promise((c=>{this.getBirdgeObj()?.callHandler("getLoginInfo").then((p=>{c(p)}))}))}async setBridgeInfoToSession(){try{const c=await this.getBridgeToken();let p;if(c&&c.userInfo){const v=c.userInfo;p={companyName:v.company?.name??"",defaultCompId:v.company?.id??"",employeeId:v.employeeId,employeeName:v.employeeName,id:v.id,loginName:v.loginName,mobile:v.mobile,name:v.name},sessionStorage.setItem("ACCESS_TOKEN",c.accessToken),sessionStorage.setItem("pt",c.pt),p&&sessionStorage.setItem("USER_INFO",JSON.stringify(p))}return c&&c.fp&&localStorage.setItem("fp",c.fp),c&&c.ct&&sessionStorage.setItem("ct",c.ct),Promise.resolve({...p,client_id:c.client_id,client_secret:c.client_secret})}catch(c){return Promise.reject(c)}}async loginSuccess(c){return await(this.getBirdgeObj()?.callHandler("loginSuccess",c))}};async function initFp(){if(qr.isMobileEnv())return qr.setBridgeInfoToSession();const c=localStorage.getItem(Dr);if(c)return c;{const c=Kr.load(),p=await c,v=await p.get(),{deviceMemory:x,...E}=v.components,F=Kr.hashComponents(E);return localStorage.setItem("fp",F),F}}const Ur=new URL(document.location).searchParams;class Authing_Authing{constructor(c){Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:c});const{domain:p,redirectUri:v,...x}=c;this.params={domain:p||window.location.origin,redirectUri:v||sessionStorage.getItem("redirectUri")||location.origin+location.pathname,...x},initFp()}getToken(){return sessionStorage.getItem("ACCESS_TOKEN")}setToken(c){sessionStorage.setItem("ACCESS_TOKEN",c)}get token(){return this.getToken()}set token(c){this.setToken(c)}async initPUBK(){if(this.params.PUBK)return this.params.PUBK;if(window.PUBK)return this.params.PUBK=window.PUBK,window.PUBK;const c=await pr.get(`${this.params.domain}/component-shared-center/env.json`,{dataPath:"data"});try{this.params.PUBK=c.PUBK}catch(p){}}getUserInfoFromSession(){return JSON.parse(sessionStorage.getItem(Br.user_info)||"{}")}async loginWithRedirect(){if(this.saveLocalSearchParams(),Ur.get("code"))return!1;this.params.loginWithRedirectHandle?await this.params.loginWithRedirectHandle({...this.params}):(sessionStorage.setItem("auth","lj"),window.location.href=`${this.params.domain}/auth/oauth/authorize?response_type=code&client_id=${E}&redirect_uri=${this.params.redirectUri}`)}async logoutWithRedirect(){const c=JSON.parse(sessionStorage.getItem(Br.user_info)||"{}").id,p=localStorage.getItem("fp"),v=sessionStorage.getItem("pt")||1;try{window.sessionStorage.setItem("noclose","noclose"),async function delToken(){sessionStorage.removeItem(Br.access_token),sessionStorage.removeItem(Br.refresh_token),sessionStorage.removeItem(Br.expires_in),sessionStorage.removeItem(Br.token_expires_time),sessionStorage.removeItem(Br.user_info),sessionStorage.removeItem(Br.user_name),sessionStorage.removeItem("selectedKeys"),sessionStorage.removeItem("openKeys"),localStorage.removeItem("dict_code")}(),await pr.get(`${this.params.domain}/auth/logout?ct=1&userId${c}&fp=${p}&pt=${v}`),this.loginWithRedirect()}catch(x){window.location.href=`${this.params.domain}/auth/logout?ct=1&userId${c}&fp=${p}&pt=${v}`}}static getLoginState(){return!(!sessionStorage.getItem(Br.access_token)||!sessionStorage.getItem(Br.user_info))}static isRedirectCallback(){return!!Ur.get("code")}async getBasicSecret(){return await this.initPUBK(),await async function getPUBK(c=""){const p=c,v=Rr.ym.getKey(p);let x=`Basic ${Pr(`${E}:${F}`)}`;const C=(new Date).getTime();return x=(0,Rr.wV)(Rr.pj.crypto.Cipher.encrypt(`${x}\n${C}`,v,void 0)),x}(this.params.PUBK)}async defaultResolveCodeHandle(c){try{const p=await async function accestokenByCode(c,p,v){try{const x=await pr(`${v?.domain}/auth/oauth/token`,{placeholderData:{},data:{ct:sessionStorage.getItem("ct")||1,grant_type:"authorization_code",code:c,redirect_uri:v?.redirectUri,fp:localStorage.getItem(Dr),v:1},dataPath:"data",headers:{"Content-Type":"multipart/form-data",Authorization:p},method:"post"});if(200!==x.code)return sessionStorage.clear(),Promise.reject(x);const E=x?.data;return saveToken(E),E?.user_info}catch(x){return sessionStorage.clear(),Promise.reject(x)}}(c,this.params.basicSecret,{...this.params}),v=sessionStorage.getItem("lastSearch")||"",x=new URL(this.params.redirectUri.endsWith("/")?`${this.params.redirectUri}${v}`:`${this.params.redirectUri}/${v}`);return x.searchParams.delete("code"),window.history.replaceState({},"",x),window.location.reload(),p}catch(p){this.loginWithRedirect()}}saveLocalSearchParams(){sessionStorage.setItem("lastSearch",window.location.search||"")}async handleRedirectCallback(){await initFp();const c=await this.getBasicSecret();if(this.params.basicSecret=c,Authing_Authing.getLoginState())return this.getUserInfoFromSession();if(Ur.get("code")){const c=Ur.get("code");return await this.initPUBK(),this.params.resolveCodeHandle?this.params.resolveCodeHandle(c,{...this.params}):this.defaultResolveCodeHandle(c||"")}return await this.loginWithRedirect()}}function TjSSoAuthing({domain:c="",redirectUri:p=""}={}){return new Authing_Authing({manual:!0,domain:c||location.origin,redirectUri:p||location.origin,resolveCodeHandle:async(c,p)=>{try{const v=await pr({url:"/auth/oauth/oidcToken",method:"post",headers:{accept:"application/json","content-type":"application/x-www-form-urlencoded",pt:sessionStorage.getItem("pt")||1,Authorization:p.basicSecret},dataPath:"data.data",data:{ct:sessionStorage.getItem("ct")||1,code:c,fp:localStorage.getItem("fp"),v:1}});v?(qr.isMobileEnv()&&qr.loginSuccess(v),saveToken(v)):saveToken(null)}catch(v){saveToken(null)}},loginWithRedirectHandle:async()=>{const p=qr.isMobileEnv();sessionStorage.setItem("auth","cu");fetch(`${c}/auth/getOidcUrl${p?"":"?ct=1"}`,{method:"get"}).then((c=>c.json().then((c=>{window.location.href=c.data}))))}})}function loginSuccess(c={}){qr.isMobileEnv()&&qr.loginSuccess(c)}function isMobileEnv(){return qr.isMobileEnv()}}},p={};function __webpack_require__(v){var x=p[v];if(void 0!==x)return x.exports;var E=p[v]={exports:{}};return c[v].call(E.exports,E,E.exports,__webpack_require__),E.exports}__webpack_require__.n=c=>{var p=c&&c.__esModule?()=>c.default:()=>c;return __webpack_require__.d(p,{a:p}),p},__webpack_require__.d=(c,p)=>{for(var v in p)__webpack_require__.o(p,v)&&!__webpack_require__.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:p[v]})},__webpack_require__.o=(c,p)=>Object.prototype.hasOwnProperty.call(c,p),__webpack_require__.r=c=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var v={};return(()=>{"use strict";__webpack_require__.r(v);var c=__webpack_require__(619);!function start(){const p=(0,c.isMobileEnv)();if(p)window.addEventListener("flutterInAppWebViewPlatformReady",(()=>{const v=(0,c.TjSSoAuthing)({domain:"localhost"===window.location.hostname?"http://dev-pm.crccit.com:31006":window.location.origin,redirectUri:window.location.origin});v.handleRedirectCallback().then((()=>{c.Authing.getLoginState()&&p&&(0,c.loginSuccess)({access_token:sessionStorage.getItem("ACCESS_TOKEN"),expires_in:sessionStorage.getItem("EXPIRES_IN"),fp:sessionStorage.getItem("fp"),pt:sessionStorage.getItem("pt"),refresh_token:sessionStorage.getItem("REFRESH_TOKEN"),user_info:sessionStorage.getItem("USER_INFO")})}))}));else{const p=(0,c.TjSSoAuthing)({domain:"localhost"===window.location.hostname?"http://dev-pm.crccit.com:31006":window.location.origin,redirectUri:window.location.origin}),afterRedirectCallback=()=>{c.Authing.getLoginState()&&(window.history.replaceState(null,"",`${window.location.origin}/portal`),window.location.reload())};p.handleRedirectCallback().then((()=>{afterRedirectCallback()}))}}()})(),v})()));
//# sourceMappingURL=sso.umd.js.map